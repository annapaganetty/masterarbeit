{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "---\n",
        "title: Einleitung\n",
        "format:\n",
        "  masterarbeit-doc-typst: default\n",
        "\n",
        "---\n",
        "\n",
        "\n",
        "<!-- Kapitel 1 -->\n",
        "\n",
        "# Zusammenfassung {.unnumbered}\n",
        "\n",
        "```{=typst}\n",
        "#align(center, text(size: 14pt, weight: 600,\"Zusammenfassung\"))\n",
        "#v(60pt, weak: true)\n",
        "```\n",
        "\n",
        "Die Berechnung von Plattentragwerken mittels der Finite-Elemente-Methode (FEM) gehört zu den grundlegenden Anwendungen in der Ingenieurspraxis. Trotz ihrer weitreichenden Nutzung sind die entsprechenden Verfahren in der Ingenieursliteratur oft unzureichend erläutert. \n",
        "\n",
        "Ziel dieser Arbeit ist die, sonst primär in englischer Sprache verfassten theoretischen Grundlagen der FEM in deutscher Sprache aufzuarbeiten. Teil dessen ist die Herleitung mechanischer Zusammenhänge sowie die Erläuterung mathematischer Verfahren zu Konstruktion sogenannter $C^1$-stetiger Basisfunktionen. Die Differentialgleichung der Kirchhoff-Platte stellt hierbei die Basis für die numerischen Berechnungen dar. \n",
        "\n",
        "Ausgehend von diesen Grundlagen wird, neben der Darstellung des Bogner-Fox-Schmitt-Elements, ein besonderes Augenmerk auf das _Discrete Kirchhoff Quadrilateral_ Element (DKQ) gelegt, welches erstmals 1982 von Batoz und Tahar veröffentlicht wurde.   \n",
        "\n",
        "Die programmtechnische Umsetzung erfolgt in der Programmierumgebung JULIA und wird an ausgewählten Beispielen getestet. Die Ergebnisse der entwickelten Methoden stimmen mit denen eines kommerziellen Programmes überein, was die Genauigkeit und Anwendbarkeit der vorgeschlagenen Ansätze unterstreicht.\n",
        "\n",
        "{{< pagebreak >}}\n",
        "\n",
        "# Abstract {.unnumbered}\n",
        "\n",
        "```{=typst}\n",
        "#align(center, text(size: 14pt, weight: 600,\"Abstract\"))\n",
        "#v(60pt, weak: true)\n",
        "```\n",
        "\n",
        "The calculation of plate structures using the Finite Element Method (FEM) is one of the fundamental applications in engineering practice. Despite its widespread use, the corresponding procedures are often inadequately explained in engineering literature.\n",
        "\n",
        "The aim of this work is to compile the theoretical foundations of FEM, which are primarily written in English, in the German language. This includes deriving mechanical relationships as well as explaining mathematical procedures for constructing so-called $C^1$-continuous basis functions. The differential equation of the Kirchhoff plate serves as the basis for the numerical calculations.\n",
        "\n",
        "Building on these foundations, in addition to presenting the Bogner-Fox-Schmitt element, special attention is given to the Discrete Kirchhoff Quadrilateral (DKQ) element, which was first published in 1982 by Batoz and Tahar.\n",
        "\n",
        "The programming implementation is carried out in the Julia programming environment and is tested on selected examples. The results of the developed methods align with those of a commercial program, underscoring the accuracy and applicability of the proposed approaches.\n",
        "\n",
        "\n",
        "{{< pagebreak >}}\n",
        "\n",
        "\n",
        "<!-- Kapitel 1 -->\n",
        "\n",
        "```{=typst}\n",
        "#set page(numbering: \"1\",\n",
        "  header: locate(loc => {\n",
        "  let i = counter(page).at(loc).first()\n",
        "  if i == 5 { return }\n",
        "    align(right, emph(text(size: 12pt)[Kapitel 1: Einleitung]))}))\n",
        "#counter(page).update(1)\n",
        "#v(29pt, weak: true)\n",
        "```\n",
        "\n",
        "# Einleitung\n",
        "\n",
        "## Motivation {#sec-motivation}\n",
        "\n",
        "Wird die Finite Elemente Methode (FEM), ohne ausreichende Kenntnisse über die Berechnungsmethode, als \"Black-Box\"- Methode, angewandt, sind häufig Fehler die Konsequenz (s. @werkle_anwendung_1996). R.D. Cook, D.S. Malkus und M.E. Plesha warnen bereits in dem Jahr 1988 davor, dass den Ergebnissen der FE-Berechnung nur dann getraut werden kann, wenn der Anwender über konkretes Wissen, bezüglich des internen Berechnungsablaufs des Programms, verfügt und Kenntnis über die physikalischen Grundlagen hat.\n",
        "\n",
        "_\"Their results cannot be trusted if users have no knowledge of their internal workings and little understanding of the physical theories on which they are based.\"_ - Cook et al.\n",
        "\n",
        "Die Finite Elemente Methode hat sich als eine der leistungsfähigsten und vielseitigsten Techniken zur Analyse komplexer ingenieurtechnischer Probleme etabliert. Trotz der weit verbreiteten Anwendung der FEM in der Ingenieurpraxis ist die Literatur zu den spezifischen Verfahren und Methoden zur Anwendung der Kirchhoff-Plattentheorie oft unzureichend. Ein Mangel an klaren und umfassenden Erklärungen zu den notwendigen mathematischen und mechanischen Grundlagen kann die Entwicklung effizienter und präziser FEM-Modelle behindern. Blindes Vertrauen und mangelnde Kenntnisse über die komplexen Berechnungsvorgänge im Hintergrund eines FEM-Programms stellen eine weitere Fehlerquelle dar.\n",
        "\n",
        "![Offshore Bohrplatform Sleipner A](00-pics/sleipner-A-platform.png){#fig-sleipner-A fig-env=\"figure*\" width=45%}\n",
        "\n",
        "Der Schadensfall an der Bohrplattform Sleipner A (@fig-sleipner-A) zeigt, dass auch Fehler mit schwerwiegenden Folgen gemacht werden können. Direkt nach dem Unfall ernannte der Besitzer der Plattform, die Firma Statoil, eine Ermittlungsgruppe. Es zeigte sich, dass bei der fehlerhaften Umsetzung der Finite Elemente Berechnung in einen Bewehrungsplan die Ursache für den Untergang lag.^[https://www-users.cse.umn.edu/~arnold/disasters/sleipner.html]\n",
        "\n",
        "Für das Verständnis der FE-Methode ist es essenziell die Grundideen zu verinnerlichen. Die wesentlichen zwei Aspekte der Methode sind die Approximation einer Lösung durch Kombination von vordefinierten Funktionen und die stückweise Definition der Funktionen auf sogenannten Elementen. Die Kirchhoff-Plattentheorie stellt dabei, neben der Reissner-Mindlin Theorie, eine fundamentale Grundlage dar, um das Verhalten von dünnen Platten zu analysieren. Ziel der vorliegenden Masterarbeit, ist die systematische Aufarbeitung der theoretischen Grundlagen zur Formulierung von Finite Elemente Methoden für Kirchhoff-Platten und die Implementierung in der Programmiersprache JULIA. \n",
        "\n",
        "Nicht zuletzt wird durch die Implementierung in JULIA ein modernes und leistungsfähiges Werkzeug genutzt, sondern auch die Möglichkeit geschaffen, die Ergebnisse offen zugänglich zu machen und zur Weiterentwicklung der FEM-Methoden beizutragen.\n",
        "\n",
        "\n",
        "## Problemstellung {#sec-problemstellung}\n",
        "\n",
        "Die Analyse von Plattentragwerken ist eine zentrale Aufgabe im Bauingenieurwesen, da sie in einer Vielzahl von Konstruktionen eine wesentliche Rolle spielen. Die Ingenieursliteratur zur Implementierung der FEM für Kirchhoff-Platten beschränkt sich oft auf rechteckige Elemente und ist auch hier teilweise lückenhaft. Für die Berechnung komplexer Strukturen ist die Formulierung für allgemeine Vierecke jedoch von wesentlicher Bedeutung.\n",
        "\n",
        "Die Verträglichkeit der Rotation von benachbarten Elemente stellt bei der Finite Elemente Analyse eine besondere Herausforderung dar. Ist die Verträglichkeit bei benachbarten Rechteckelementen am gemeinsamen Knoten gegeben, sodass bei der Darstellung der Rotationen keine Unstetigkeiten vorhanden sind, so wird bei dem Elementansatz von einer sogenannten $C^1$-Kontinuität gesprochen. Diese Kontinuität erfüllt der kubische Ansatz des Bogner-Fox-Schmitt Elements. Für die Berechnung allgemeiner Vierecke ist dieser Ansatz jedoch unbrauchbar, da der zusätzliche Freiheitsgrad $\\theta_{\\xi\\eta}$ störend wirkt. \n",
        "\n",
        "Ziel dieser Arbeit ist die Herleitung einer ausgewählten Formulierung für allgemeine Vierecke, sowie die Implementierung in der Programmierumgebung JULIA. An ausgewählten Anwendungsbeispielen wird die Umsetzung verifiziert und dadurch eine offene und nachvollziehbare Lösung für die Anwendung der Kirchhoff-Plattentheorie geschaffen.\n",
        "\n",
        "Zudem ist das grundlegende Verständnis der Finite Elemente Methode und etablierter Elementansätze von großer Wichtigkeit. Die Erläuterung numerischer Methoden für die Kirchhoffsche Plattentheorie ist, vor allem in der deutschsprachigen Literatur, bisher sehr lückenhaft. Daher stellt die Aufarbeitung theoretischer Grundlagen, die zur Formulierung der FEM für Kirchhoff-Platten notwendig sind, ein weiteres Ziel dar. Dies beinhaltet sowohl mechanischen Zusammenhänge, als auch mathematische Verfahren.\n",
        "\n",
        "\n",
        "## Gliederung der Arbeit {#sec-gliederung}\n",
        "\n",
        "Die Grundlagen der Finite Elemente Methode sind in @sec-Grundlagen-FEM dargestellt. Dabei wird zunächst in @sec-einfuehrungsbeispiel anhand eines Einführungsbeispiels der Ablauf der FEM beschrieben. Anschließend werden diverse Elementansätze für finite Elemente erläutert und deren Kontinuität dargestellt. Weiterhin werden die zwei wesentlichen Schritte der Finite Elemente Analyse _Approximation_ und _numerische Lösung_ in @sec-approximation-funktionen und @sec-numerische-loesung erläutert.\n",
        "\n",
        "Die zur Analyse notwendigen Differentialgleichungen einer Kirchhoff Platte werden in @sec-mech-math-grundlagen hergeleitet.\n",
        "\n",
        "Für die Analyse von Plattentragwerken wird dann in @sec-fem-plattentragwerke zunächst die allgemeine schwache Form des Problems hergeleitet, um danach die globale Steifigkeitsmatrix sowohl für das Bogner-Fox-Schmitt Rechteckelement als auch für das allgemeine DKQ Element zu berechnen.\n",
        "\n",
        "Die programmtechnische Umsetzung in der noch sehr neuen Programmierumgebung JULIA erfolgt in @sec-Umsetzung-Julia. Die Anwendung auf Beispiele zur Testung, wird im Anschluss in @sec-anwendungsbeispiele dokumentiert.\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "{{< pagebreak >}}\n",
        "\n",
        "\n",
        "<!-- Kapitel 2 -->\n",
        "\n",
        "```{=typst}\n",
        "#set page(header: align(right, emph(text(size: 12pt)[Kapitel 2: Grundidee der Finite Elemente Methode])))\n",
        "```\n",
        "\n",
        "# Grundidee der Finite Elemente Methode {#sec-Grundlagen-FEM}\n",
        "\n",
        "Die Finite Elemente Methode ist seit vielen Jahren ein fester Bestandteil bei der Berechnung komplexer Strukturen im Bauingenieurwesen. Dabei wird ein physikalisches Problem als idealisiertes, möglichst realitätsnahes, mathematisches Modell dargestellt und durch numerische Berechnungsverfahren näherungsweise gelöst. Nicht nur in der Baubranche findet dieses Verfahren seine Anwendung, auch in der Luft- und Raumfahrtechnik, Automobil-, Elektronik- und Schifffahrtsindustrie gewinnt die FEM immer weiter an Bedeutung. \n",
        "\n",
        "Nachdem in @sec-einfuehrungsbeispiel, anhand eines Einführungsbeispiels, der Ablauf der Finite Elemente Analyse demonstriert wird, gibt @sec-einfuehrung-FEM einen allgemeineren Überblick über die FEM. Für die numerische Lösung zweidimensionaler Problem ist die Konstruktion von Basisfunktionen notwendig. Das mathematische Vorgehen, sowie die Forderungen nach bestimmten Kontinuitätsbedingungen werden in @sec-basis-funktionen vorgestellt. Dem Ablaufschema entsprechend wird des Weiteren das Vorgehen der Approximation von Funktionen in @sec-approximation-funktionen erläutert. Abschließend wird in @sec-numerische-loesung das lineare Gleichungssystem, welches den zentralen Punkt der FEM bildet, hergeleitet.\n",
        "\n",
        "## Einführungsbeispiel: Biegebalken {#sec-einfuehrungsbeispiel}\n",
        "\n",
        "Um die grundlegenden Ideen der Finite Elemente Methode zu verstehen, wurde für das Einführungsbeispiel ein eindimensionales Problem gewählt. Im weiteren Verlauf der Arbeit wird diese Vorgehensweise auf zweidimensionale Aufgabenstellungen übertragen. Das nachfolgende Beispiel ist ein Biegebalken, welcher an beiden Seiten gelenkig gelagert ist (siehe @fig-Einfuehrungsbeispiel). Um die physikalische Problemstellung in ein mathematisches Modell zu übertragen, werden einleitend die kinematischen Gleichungen und die Gleichgewichtsbeziehungen des Euler-Bernoulli-Balkens hergeleitet. Ziel ist es, das Randwertproblem in Form einer Differentialgleichung mit Randbedingungen zu formulieren. Es wird häufig von der _starken Form_ des Problems gesprochen, welche die Grundlage für die Finite Elemente Analyse bildet.\n",
        "\n",
        "![Einführungsbeispiel: Biegebalken](00-pics/Balken-Beispiel.png){#fig-Einfuehrungsbeispiel  width=70%}\n",
        "\n",
        "### Kinematische Gleichungen\n",
        "\n",
        "Die nachfolgend beschriebenen Zusammenhänge beruhen auf den beiden Bernoulli-Hypothesen. Die erste Hypothese besagt, dass der Querschnitt des Balkens im unverformten und im verformten Zustand eben ist und sich nicht verwölbt (_Ebenbleiben des Querschnitts_). Zudem wird davon ausgegangen, dass die Querschnittsfläche im verformten Zustand senkrecht zur neutralen Achse bleibt (_Senkrechtbleiben des Querschnitts_).\n",
        "\n",
        "Die Durchbiegung des verformten Balkens wird durch $w(x)$ beschrieben. Die Ableitung $w'(x)$ gibt die Neigung der neutralen Achse an und entspricht somit dem Verdrehwinkel der Achse an der Stelle $x$. Es ergibt sich, entsprechend der Annahmen nach Bernoulli, der Zusammenhang \n",
        "$$\n",
        "\\theta = -w'(x) \\quad.\n",
        "$${#eq-verdrehwinkel}\n",
        "\n",
        "Die horizontale Verschiebung des Punktes P, in Abhängigkeit der Balkenhöhenkoordinate $y$ und der Ableitung der Verformung, wird durch\n",
        "$$\n",
        "u(x, y) = −y · w′(x) \n",
        "$${#eq-horizontale-verschiebung-balken}\n",
        "\n",
        "beschrieben. \n",
        "\n",
        "![verformter Balken](00-pics/Verformter-Balken.png){width=40%}\n",
        "\n",
        "Durch die weitere Annahme von linear-elastischem Materialverhalten, ausgedrückt durch das Hooksche Gesetz, ergibt sich in Abhängigkeit von dem Elastizitätsmodul $E$, der Durchbiegung $w(x)$ und dem Flächenträgheitsmoment \n",
        "$$\n",
        "I_z =\\int_A y^2 dA \n",
        "$${#eq-flaechentraegheitsmoment-balken}\n",
        "\n",
        "das Schnittmoment \n",
        "$$\n",
        "M_z = -E I \\cdot w''(x) \\quad.\n",
        "$${#eq-schnittmoment-balken}\n",
        "\n",
        "### Gleichgewichtsbeziehungen\n",
        "\n",
        "Bei der Betrachtung des Gleichgewichts an einem Element der Größe $\\Delta x$, dargestellt in @fig-schnittgroeßen-balken, ergeben sich die Gleichgewichtsbedingungen\n",
        "$$\n",
        "\\begin{align}\n",
        "&\\sum V: \\quad V(x+\\Delta x)-V(x)+q_z \\cdot \\Delta x &=0 \\\\\n",
        "&\\sum M: \\quad M(x+\\Delta x)-M(x)-q_z \\cdot \\frac{\\Delta x^2}{2} - V(x+\\Delta x) \\cdot \\Delta x &=0.\n",
        "\\end{align}\n",
        "$${#eq-gleichgewichtsbeziehungen-balken}\n",
        "\n",
        "Nach Division der Beziehungen mit $\\Delta x$ und Berechnung des Grenzwertes mittels $\\lim_{\\Delta x \\to 0}$, folgen durch Anwendung des Differentialquotienten die Zusammenhänge\n",
        "$$\n",
        "\\begin{align}\n",
        "V'(x) &= -q_z(x), \\qquad\n",
        "M'(x) &= V(x) \\qquad \\text{und} \\qquad\n",
        "M''(x) &= -q_z(x) \n",
        "\\end{align}\n",
        "$$ {#eq-zusammenhaenge-aus-GG}\n",
        "\n",
        "![Schnittgrößen am Bernoulli Balken](00-pics/Schnittgroessen-balken.png){#fig-schnittgroeßen-balken width=60%}\n",
        "\n",
        "### Starke Form zur schwachen Form {#sec-Balken-stark-schwache-Form}\n",
        "Aus den @eq-schnittmoment-balken und @eq-zusammenhaenge-aus-GG lässt sich für das Stabelement der Länge $L$ die _starke Form_ des Problems wie folgt formulieren:\n",
        "\n",
        "::: {.block fill=\"luma(230)\" inset=\"8pt\" radius=\"4pt\"}\n",
        "\n",
        "*Randwertproblem D (Balken)* \n",
        "\\\n",
        "\\\n",
        "Gesucht ist die Funktion $w:[0,L] \\to \\mathbb{R}$ welche die Differentialgleichung \n",
        "\\\n",
        "$$\n",
        "E I \\cdot w^{iv}(x)= -q_z(x) \n",
        "$${#eq-randwertproblem-balken}\n",
        "und die Randbedingungen\n",
        "\\\n",
        "$$\n",
        "\\begin{align}\n",
        "&w(0) = w_0 \\quad \\quad &oder \\quad \\quad &V_0= -E I \\cdot w'''(0) = A_z \\\\\n",
        "&w(L)= w_1 \\quad \\quad &oder \\quad \\quad &V_1= -E I \\cdot w'''(L) = B_z \\\\\n",
        "&w'(0) = \\varphi_0 \\quad \\quad &oder \\quad \\quad &M_0= -E I \\cdot w''(0) = 0 \\\\\n",
        "&w'(L)= \\varphi_1 \\quad \\quad &oder \\quad \\quad &M_1= -E I \\cdot w''(L) = 0\n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        "erfüllt.\n",
        "\n",
        ":::\n",
        "\n",
        "Um die Idee der FEM umzusetzen, ist es notwendig das Problem in der sogenannten _schwache Form_ zu formulieren. Hierzu muss die Differentialgleichung aus @eq-randwertproblem-balken mit der Testfunktion $\\delta w :[0,L] \\to \\mathbb{R}$ multipliziert werden und das Ergebnis dann auf beiden Seiten integriert werden, sodass daraus   \n",
        "$$\n",
        "EI \\cdot \\int^L_0 w^{iv}(x) \\cdot \\delta w(x) dx = \\int^L_0 -q_z(x) \\cdot \\delta w(x) dx. \n",
        "$$ {#eq-basis-fe-loesung}\n",
        "\n",
        "folgt. Nach zweifacher partieller Integration der linken Seite von @eq-basis-fe-loesung ergibt sich das Variationsproblem, bzw. die schwache Form, für den Biegebalken.\n",
        "\n",
        "::: {.block fill=\"luma(230)\" inset=\"8pt\" radius=\"4pt\"}\n",
        "\n",
        "*Variationsproblem V (Biegebalken)* \n",
        "\\\n",
        "\\\n",
        "Gesucht ist die Funktion $w:[0,L] \\to \\mathbb{R}$, sodass \n",
        "$$\n",
        "\\begin{align}\n",
        "EI \\cdot \\int^L_0 w''(x) \\cdot \\delta w''(x) dx  =\\\\\n",
        "-q_{z} \\cdot \\int^L_0 \\delta w(x) dx +V_1 \\cdot \\delta w(L)-V_0 \\cdot \\delta w(0)-M_1 \\cdot \\delta w'(L)+M_0 \\cdot \\delta w'(0) \n",
        "\\end{align}\n",
        "$$ {#eq-variationsproblem-balken}\n",
        "\n",
        "für (fast) jede beliebige Testfunktionen $\\delta w$.\n",
        "\n",
        ":::\n",
        "\n",
        "\n",
        "Das Variationsproblem lässt sich mit Hilfe von Funktionalen in eine generelle Form bringen, welche auch für andere physikalische Probleme die Basis darstellt. Die linke Seite der @eq-variationsproblem-balken wird als Bilinearform $a:V \\times V \\to \\mathbb{R}$ und die rechte Seite als Linearform $b:V \\to \\mathbb{R}$ definiert, wobei $V$ die Menge von Funktionen darstellt. Auf die Eigenschaften der verwendeten Funktionale wird im Zuge der Anwendung der FEM im zweidimensionalen Raum noch näher eingegangen.\n",
        "\n",
        "::: {.block fill=\"luma(230)\" inset=\"8pt\" radius=\"4pt\"}\n",
        "\n",
        "*Abstraktes Variationsproblem (Balken)* \n",
        "\\\n",
        "\\\n",
        "Gesucht ist die Funktion $w \\in V$, sodass \n",
        "$$\n",
        "a(w, \\delta w)= b(\\delta w)  \\quad \\forall \\quad \\delta w \\in V\n",
        "$${#eq-abstraktes-variationsproblem-balken}\n",
        "\n",
        ":::\n",
        "\n",
        "Weiter kann das abstrakte Variationsproblem des Balkens auf den endlich großen Vektorraum $V_h$, welcher ein Unterraum von $V$ ist, reduziert werden. $V_h$ bezeichnet die Menge aller möglichen Linearkombinationen von $\\varphi_1, \\varphi_2,...,\\varphi_N$ wobei $\\varphi_i \\text{mit} i = 1...N$ die Basisfunktionen sind und $N$ die Dimension des Raums $V_h$. Die Näherungslösung von $w_h$ wird durch \n",
        "$$\n",
        "w_h(x) = \\varphi_1(x) \\cdot \\hat{w}_1 +  \\varphi_2(x) \\cdot \\hat{w}_2 + ... + \\varphi_N(x) \\cdot \\hat{w}_N = \\sum_{i=1}^N \\varphi_i(x) \\cdot \\hat{w}_i\n",
        "$${#eq-linearkombination}\n",
        "\n",
        "mit \n",
        "$$\n",
        "\\begin{align}\n",
        "&V_h = Lin(\\varphi_1,\\varphi_2,...,\\varphi_N) = \\{ \\sum_{i=1}^N \\varphi_i \\cdot \\hat{w}_i \\vert \\hat{w}_i \\in \\mathbb{R} \\}, \\\\\n",
        "&V_h \\subset V\n",
        "\\end{align}\n",
        "$${#eq-subspace}\n",
        "\n",
        "ausgedrückt. \n",
        "\n",
        "Das sich daraus ergebende Problem wird _abstraktes, diskretes Variationsproblem_ bezeichnet. Das ursprüngliche, _abstrakte Variationsproblem_, bei dem eine Funktion $w \\in V$ gesucht wird, wird, durch das Suchen der reellen Zahlen $\\hat{w}_i$, ersetzt.\n",
        "\n",
        "::: {.block fill=\"luma(230)\" inset=\"8pt\" radius=\"4pt\"}\n",
        "\n",
        "*Abstraktes, diskretes Variationsproblem (Balken)* \n",
        "\\\n",
        "\\\n",
        "Gesucht ist eine Funktion $w_h \\in V_h$, sodass \n",
        "$$\n",
        "a(w_h, \\delta w_h)= b(\\delta w_h) \\quad \\forall \\quad \\delta w_h \\in V_h\n",
        "$${#eq-abstraktes-diskretes-variationsproblem-balken}\n",
        "\n",
        ":::\n",
        "\n",
        "Zur numerischen Lösung des abstrakten, diskreten Variationsproblems werden \n",
        "\n",
        "$$\n",
        "\\delta w_h = \\sum_{i=1}^N \\varphi_i \\cdot \\delta \\hat{w}_i \n",
        "\\quad \\quad \\text{und} \\quad \\quad\n",
        "w_h = \\sum_{j=1}^N \\varphi_j \\cdot \\hat{w}_j \n",
        "$$\n",
        "\n",
        "in @eq-abstraktes-diskretes-variationsproblem-balken eingesetzt. Es ergibt sich das Gleichungssystem \n",
        "$$\n",
        "\\sum_{j=1}^N a(\\varphi_j, \\varphi_i) \\cdot \\hat{w}_j  = b(\\varphi_i), \\quad \\text{mit} \\quad j = 1,...,N,\n",
        "$${#eq-weißnochnicht02}\n",
        "\n",
        "wobei $N$ die Anzahl der Gleichungen angibt. Das lineare Gleichungssystem wird weitgehend in der Literatur durch \n",
        "$$\n",
        "\\mathbf{K} \\boldsymbol{\\hat{w}} = \\boldsymbol{r}.\n",
        "$${#eq-gleichungssystem-balken}\n",
        "\n",
        "mit\n",
        "$$\n",
        "\\begin{align}\n",
        "&\\mathbf{K} &&= K_{ij} &&= a(\\varphi_j, \\varphi_i) \\\\\n",
        "&\\boldsymbol{r} &&= r_i    &&= b(\\varphi_i)\n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        "beschrieben. Hierbei wird $\\mathbf{K}$ als Gesamtsteifigkeitsmatrix bezeichnet und $\\boldsymbol{r}$ als Lastvektor. Der Verschiebungsvektor __$\\hat{w}$__ ist unbekannt und wird durch die Lösung des Gleichungssystems approximiert.\n",
        "\n",
        "{{< pagebreak >}}\n",
        "### Assemblierung der Steifigkeitsmatrix: Biegebalken {#sec-ke-biegelbalken}\n",
        "\n",
        "Bei der Finite Elemente Analyse eines Euler-Bernoulli-Balken wird dessen Definitionsbereich $\\Omega = [0,l]$ in mehrere Elemente $\\Omega_e \\text{mit} e = 1,...,N_e$ unterteilt. Diese Elemente werden durch Knoten $x_n \\text{mit} n = 1,...,N_n$ verbunden, wie in @fig-balkenelemente dargestellt, so dass im einfachsten Fall $\\Omega_e = [x_e,x_{e+1}]$ gilt.\n",
        "\n",
        "![Balkenelement](00-pics/Balkenelemente.png){#fig-balkenelemente width=75%}\n",
        "\n",
        "Als Basisfunktionen werden bei diesem Beispiel die Hermite-Polynomen genutzt. Um $C^1$-Kontinuität zwischen den Elementen $\\Omega_e$ zu erreichen, müssen, bei der Kombination der Basisfunktionen, sowohl die Verschiebung $w$, als auch die Ableitung der Verschiebung $w'$ an den Knoten übereinstimmen. Die Freiheitsgrade, dargestellt in @fig-balkenelemente, eines Euler-Bernoulli-Balkenelements ergeben sich somit zu \n",
        "$$\n",
        "\\hat{w}_e =\n",
        "\\left[ \\begin{array}{center} \n",
        "w_1 \\\\\n",
        "\\theta_1 \\\\\n",
        "w_2 \\\\\n",
        "\\theta_2 \\\\\n",
        "\\end{array}\\right],\n",
        "$${#eq-verschiebungsvektor}\n",
        "\n",
        "mit Berücksichtigung der Vereinbarung aus @eq-verdrehwinkel. Die Hermite-Polynome bezogen auf das eindimensionale Referenzelement, mit dem Intervall $Î := [-1,1]$, sind in @fig-Hermite-Funktionen dargestellt. \n",
        "\n",
        "Für einen Euler-Bernoulli-Balken bedingt die Funktion $H_1$ den Verschiebungsfreiheitsgrad an dem Knoten 1 ($\\xi = -1$) und die Funktion $H_2$ den Verdrehungsfreiheitsgrad an demselben Knoten. Die Funktionen $H_3$ und $H_4$ steuern zu den jeweiligen Freiheitsgraden an Knoten 2 ($\\xi = 1$) bei. Es gelten demnach die Bedingungen \n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "H_1(-1) &= 1, \\quad &H_1(1) = 0, \\quad &H_1'(-1) = 0, \\quad &H_1'(1) = 0 \\\\\n",
        "H_2(-1) &= 0, \\quad &H_2(1) = 1, \\quad &H_2'(-1) = 0, \\quad &H_2'(1) = 0 \\\\\n",
        "H_3(-1) &= 0, \\quad &H_3(1) = 0, \\quad &H_3'(-1) = 1, \\quad &H_3'(1) = 0 \\\\\n",
        "H_4(-1) &= 0, \\quad &H_4(1) = 0, \\quad &H_4'(-1) = 0, \\quad &H_4'(1) = 1, \\\\\n",
        "\\end{align}\n",
        "$$ {#eq-Bedingungen-Hermite}\n",
        "\n",
        "![Hermite Funktionen](00-pics/Hermite-Polynome.png){#fig-Hermite-Funktionen width=60%}\n",
        "\n",
        "Die kubischen Polynome \n",
        "$$\n",
        "\\begin{align}\n",
        "&H_1(\\xi) &= \\frac{1}{4} (2-3\\xi+\\xi^3) \\qquad\n",
        "&&H_2(\\xi) &= \\frac{1}{4} (1-\\xi-\\xi^2+\\xi^3) \\\\\n",
        "&H_3(\\xi) &= \\frac{1}{4} (2+3\\xi-\\xi^3) \\qquad\n",
        "&&H_4(\\xi) &= \\frac{1}{4} (-1-\\xi+\\xi^2+\\xi^3) \\\\\n",
        "\\end{align}\n",
        "$$ {#eq-Hermite-Funktionen}\n",
        "\n",
        "erfüllen die Randbedingungen auf dem eindimensionalen Referenzelement. Bezogen auf das physikalische Element der Länge $l_e$ ergeben sich die Basisfunktionen zu\n",
        "$$ \n",
        "\\begin{align}\n",
        "&H_1(x) = 1 - 3 \\cdot \\frac{x^2}{l_e^2} + 2 \\cdot \\frac{x^3}{l_e^3} \\qquad\n",
        "&&H_2(x) = x - 2 \\cdot \\frac{x^2}{l_e} + \\frac{x^3}{l_e^2} \\\\\n",
        "&H_3(x) = 3 \\cdot \\frac{x^2}{l_e^2} - 2\\cdot \\frac{x^3}{l_e^3} \\qquad\n",
        "&&H_4(x) = - \\frac{x^2}{l_e} + \\frac{x^3}{l_e^2}. \n",
        "\\end{align}\n",
        "$${#eq-hermite-Elementlaenge}\n",
        "\n",
        "Für ein Element mit den Knoten $x_j$ und $x_{j+1}$ gelten die Eigenschaften des _Kronecker-Deltas_ für die Formfunktionen $H_i$, beschrieben durch\n",
        "$$\n",
        "\\varphi_i(x_j) = \\delta_{ij} =\n",
        "\\begin{cases} \n",
        "1\\quad & \\text{für $\\quad i = j$}  \\\\\n",
        "0\\quad & \\text{für $\\quad i \\neq j$}\n",
        "\\end{cases}\n",
        "$${#eq-konecker-delta-01}\n",
        "\n",
        "und\n",
        "$$\n",
        "\\varphi_i'(x_j) = \\delta_{ij} =\n",
        "\\begin{cases} \n",
        "1\\quad & \\text{für $\\quad i = j$}  \\\\\n",
        "0\\quad & \\text{für $\\quad i \\neq j$}.\n",
        "\\end{cases}\n",
        "$${#eq-konecker-delta-02}\n",
        "\n",
        "Die Länge des physikalischen Elements $\\Omega_e$ ergibt sich aus der Differenz zweier Knotenkoordinaten\n",
        "$$\n",
        "l_e = x_{j+1} - x_j.\n",
        "$$\n",
        "\n",
        "Für die Berechnung der Steifigkeitsmatrix $\\mathbf{K}$ wird der Umrechnungsfaktor \n",
        "$$\n",
        "F_e^{-1}(x) = -1+2 \\cdot \\frac{x-x_e}{l_e} \\quad \\quad \\quad \\text{mit der Ableitung} \\quad \\quad \\quad F_e^{-1}'(x) = \\frac{2}{l_e}\n",
        "$${#eq-umrechnungsfaktor}\n",
        "\n",
        "benötigt, durch den die $\\xi$-Koordinate des Referenzelements in Abhängigkeit von der $x$-Koordinate des physikalischen Elements formuliert wird. Beispielhaft wird die Formfunktion $\\varphi_3$ auf dem Element $\\Omega_2$ zwischen den Knoten $x_2$ und $x_3$ betrachtet (s. @fig-Basisfunktionen). Diese Funktion entspricht der Funktion $H_1$ der Hermite-Polynome.\n",
        "Mithilfe des Umrechnungsfaktors wird\n",
        "$$\n",
        "\\begin{flalign*}\n",
        "\\varphi_3(x) = H_1(F_2^{-1}) \\qquad \\forall \\qquad x \\in \\Omega_2\n",
        "\\end{flalign*}\n",
        "$$\n",
        "\n",
        "definiert. Analog dazu können $\\varphi_1$ zwischen den Knoten $x_1$ und $x_2$ (Element $\\Omega_1$), $\\varphi_5$ zwischen den Knoten $x_3$ und $x_4$ (Element $\\Omega_3$), und alle weiteren _ungeraden_ Formfunktionen betrachtet werden. Auf dem Element $\\Omega_2$ werden zudem die Formfunktion\n",
        "$$\n",
        "\\begin{flalign*}\n",
        "\\varphi_4(x) = \\alpha \\cdot H_2(F_2^{-1}) \\qquad \\forall \\qquad x \\in \\Omega_2\n",
        "\\end{flalign*}\n",
        "$$\n",
        "\n",
        "und dessen Ableitung \n",
        "$$\n",
        "\\varphi_4'(x) = \\alpha \\cdot H_2(F_2^{-1}) \\cdot F_2^{-1}'(x) \\qquad \\forall \\qquad x \\in \\Omega_2\n",
        "$$\n",
        "\n",
        "definiert. Durch das Einsetzen von @eq-umrechnungsfaktor in die Ableitung und die in @eq-konecker-delta-02 beschriebenen Eigenschaften der Formfunktionen, ergibt sich in allgemeiner Form \n",
        "$$\n",
        "\\alpha = \\frac{l_e}{2}.\n",
        "$$\n",
        "\n",
        "Die Elementsteifigkeitsmatrix und der Elementlastvektor ergeben sich, mittels Anwendung der Kettenregel zur Berechnung der Ableitung der Formfunktionen $H_i$, zu\n",
        "$$\n",
        "\\begin{align}\n",
        "\\mathbf{K_{ij}^e}   &= E I \\cdot \\int_\\Omega_e \\varphi_i '' \\cdot \\varphi_j '' dx\n",
        "                    &&= a_i^e \\cdot a_j^e \\cdot \\frac{16EI}{l_e^4}  &&\\int_{x_e}^{x_{e+1}} H_i (F_e^{-1}(x))'' \\cdot H_j (F_e^{-1}(x))'' dx \\\\\n",
        "\\mathbf{r^e}    &= q_z \\cdot \\int_{\\Omega_e} \\varphi_i(x) dx \n",
        "                &&= a_i^e \\cdot q_z \\cdot &&\\int_{x_e}^{x_{e+1}} H_i(F_e^{-1}(x)) dx \\\\\n",
        "\\\\\n",
        "\\\\\n",
        "&\\text{mit} \\qquad \n",
        "&&a_i^e = \n",
        "\\begin{cases}\n",
        "1 & \\text{für $\\quad i = $2,4,6,...} \\\\\n",
        "\\frac{l_e}{2} & \\text{für $\\quad i = $1,3,5,... ,} \n",
        "\\end{cases}\n",
        "\\end{align}\n",
        "$${#eq-K-und-r-balken}\n",
        "\n",
        "Sowohl die finale Elementsteifigkeitsmatrix, als auch der finale Elementlastvektor, bezogen auf das Referenzelement, ergeben sich durch die Vereinbarung aus @eq-umrechnungsfaktor mit $\\xi = F_e^{-1}(x)$ und Substitution des Differenzialoperators\n",
        "$$\n",
        "\\frac{d\\xi}{d x} = F_e^{-1}'(x) = \\frac{2}{l_e} \\qquad\\to\\qquad dx = \\frac{l_e}{2} d\\xi \n",
        "$$\n",
        "zu \n",
        "$$\n",
        "\\begin{align}\n",
        "\\mathbf{K_{ij}^e} &= a_i^e \\cdot a_j^e \\cdot \\frac{8 E I}{l_e^3} \\cdot \\int_{-1}^1 H_i ''(\\xi) \\cdot H_j '' (\\xi) d \\xi \\\\\n",
        "\\text{und} \n",
        "\\mathbf{r^e} &= q_z \\cdot \\frac{l e}{2} \\cdot a_i \\int_{-1}^1 N_i(\\xi) d\\xi .\n",
        "\\end{align}\n",
        "$${#eq-lastvektor-final-balken}\n",
        "\n",
        "![Elementweise Basisfunktionen $\\varphi_i$](00-pics/Hermite-Polynome-Balken.png){#fig-Basisfunktionen width=95%}\n",
        "\n",
        "Für ein Element der Länge $l_e$ und konstanter Steifigkeit $EI$ ergibt sich die Elementsteifigkeitsmatrix zu\n",
        "$$\n",
        "\\mathbf{K_{i j}^e} = \n",
        "\\frac{E I}{l_e^3}\\cdot\n",
        "\\left[ \\begin{array}{center} \n",
        "12    & 6l_e   & -12   & 6l_e   \\\\\n",
        "6l_e  & 4l_e^2 & -6l_e & 2l_e^2 \\\\\n",
        "-12   & -6l_e  & 12    & -6l_e  \\\\\n",
        "6l_e  & 2l_e^2 & -6l_e & 4l_e^2 \\\\\n",
        "\\end{array}\\right].\n",
        "$${#eq-Kij-balken}\n",
        "\n",
        "Bei einem Balkenelement, konstant belastet durch die Streckenlast $q_z$, wird der Lastvektor eines Elements durch \n",
        "$$\n",
        "\\mathbf{r^e}\n",
        " = \n",
        "\\frac{q_z l_e}{2}\\cdot\n",
        "\\left[ \\begin{array}{center} \n",
        "1 \\\\\n",
        "\\frac{l_e}{6} \\\\\n",
        "1 \\\\\n",
        "-\\frac{l_e}{6} \\\\\n",
        "\\end{array}\\right].\n",
        "$${#eq-re-balken}\n",
        "\n",
        "beschrieben.\n",
        "\n",
        "Die Lösung des Gleichungssystems @eq-gleichungssystem-balken gibt die Durchbiegung und die Verdrehung des Balkens an jedem Knoten an. Für einen Einfeldträger mit gelenkigen Auflagern an beiden Seiten und den folgenden Parametern\n",
        "\n",
        "::: {.block stroke=\"0.5pt + black\" inset=\"8pt\"}\n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "&\\qquad\\qquad\\qquad\\qquad L= 20 &&\\quad \\text{m} &&\\qquad\\qquad\\qquad\\qquad\\qquad E = 35.000 \\cdot 10^6 &\\quad \\text{N/m}^2\\qquad\\qquad\\qquad\\qquad \\\\\n",
        "&\\qquad\\qquad\\qquad\\qquad b = 0.3 &&\\quad \\text{m} &&\\qquad\\qquad\\qquad\\qquad\\qquad I_y = 5.4 \\cdot 10^{-3} &\\quad \\text{m}^4\\qquad\\qquad\\qquad\\qquad \\\\\n",
        "&\\qquad\\qquad\\qquad\\qquad h = 0.6 &&\\quad \\text{m} &&\\qquad\\qquad\\qquad\\qquad\\qquad q_z = -10 \\cdot 10^3 &\\quad \\text{N/m}\\qquad\\qquad\\qquad\\qquad \\\\\n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        ":::\n",
        "\n",
        "ist in @fig-Durchbiegung-Balken die Durchbiegung mittels Finite Elemente Analyse (FEA) für $N_e = 2,4,8,16,32$ Elemente dargestellt. Zum Vergleich ist die exakte Lösung der Durchbiegung des Einfeldträgers \n",
        "$$\n",
        "\\begin{align}\n",
        "&w(x) = \\frac{1+\\xi \\overline{\\xi}}{24EI} \\xi \\overline{\\xi} q_z L^4 \\\\\n",
        "\\end{align}\n",
        "$${#eq-Durchbiegung-exakt-balken}\n",
        "\n",
        "mit den Konstanten\n",
        "$$\n",
        "\\begin{align}\n",
        "&\\xi = \\frac{x}{L}, \\qquad\n",
        "&&\\overline{\\xi} = \\frac{L-x}{L}\n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        "und konstanter Streckenlast in demselben Diagramm zu sehen.\n",
        "\n",
        "![Beispiel _Biegebalken_: Exakte Lösung und FEA-Lösung](00-pics/Balken-Durchbiegung.png){#fig-Durchbiegung-Balken width=80%}\n",
        "\n",
        "\n",
        "{{< pagebreak >}} \n",
        "## Einführung in die Finite Elemente Methode (FEM) {#sec-einfuehrung-FEM}\n",
        "\n",
        "In der Baubranche findet die FEM vor allem bei zwei- und dreidimensionalen Problemen Anwendung. Ein Beispiel für ein zweidimensionales Problem sind Plattentragwerke, welche durch dreieckige und viereckige Elemente abgebildet werden können. Die Lösung der Probleme ist in jedem Fall nur eine Näherung, dessen Güte abhängig von den gewählten Verschiebungsansätzen ist. Die Verschiebungsansätze der Finiten Elemente beruhen auf der Annahme von Verschiebungsverläufen des Elements, den sogenannten Formfunktionen. Bei dem bilinearen Verschiebungsansatz ist der Verlauf beispielsweise geradlinig zwischen je zwei Knotenpunkten des Elements. Einen Überblick über weitere Elementansätze von quadratischen Elementen gibt @tbl-elementansaetze. Es sei darauf hingewiesen, dass die Aufreihung nicht vollständig ist.\n",
        "\n",
        "\n",
        "|__Elementansatz__|__Polynome__ |__Elementknoten__|__Stetigkeit__ |\n",
        "|:-------------|:--------------|:------:|:----:|\n",
        "| linear      |$\\left[\\begin{array}{center}1&\\xi&\\eta\\end{array}\\right]$ | $4$ |$C^0$ |\n",
        "| quadratisch |$\\left[\\begin{array}{center}1&\\xi&\\eta&\\xi^2&\\xi\\eta&\\eta^2\\end{array}\\right]$ | $4$ |$C^0$ |\n",
        "|__LAGRANGE__     |         |             |           |\n",
        "| bilinear    |$\\left[\\begin{array}{center}1 & \\xi & \\eta & \\xi\\eta \\end{array}\\right]$ | $4$ | $C^0$|\n",
        "| quadratisch vollständig |$\\left[\\begin{array}{center}1&\\xi&\\eta&\\xi^2&\\xi\\eta&\\eta^2&\\xi^2\\eta&\\xi\\eta^2&\\xi^2\\eta^2\\end{array}\\right]$ |$9$ |$C^0$ |\n",
        "| quadratisch unvollständig (Serendipity) |$\\left[\\begin{array}{center}1&\\xi&\\eta&\\xi^2&\\xi\\eta&\\eta^2&\\xi^2\\eta&\\xi\\eta^2\\end{array}\\right]$ | $8$ |$C^0$|\n",
        "| __HERMITE__     |         |             |           |\n",
        "| kubisch vollständig |$\\left[\\begin{array}{center}1&\\xi&\\eta&\\xi^2&\\xi\\eta&\\eta^2&\\xi^3&\\xi^2\\eta&\\xi\\eta^2&\\eta^3&\\xi^3\\eta&\\xi\\eta^3\\end{array}\\right]$ |$4$ |$C^1$ |\n",
        "| kubisch unvollständig   |$\\left[\\begin{array}{center}1&\\xi&\\eta&\\xi^2&\\xi\\eta&\\eta^2&\\xi^3&\\xi^2\\eta&\\xi\\eta^2&\\eta^3&\\xi^3\\eta&\\xi\\eta^3\\end{array}\\right]$ |$4$          |semi-$C^1$ |\n",
        "\n",
        ": Elementansätze in der FEM {#tbl-elementansaetze}\n",
        "\n",
        "Bereits in den frühen 1940er Jahren lässt sich die erste Anwendung der Finite Elemente Analyse verzeichnen. 1941 nutzte A. Hrennikof zum ersten Mal zur Lösung eines 2D-Scheibenproblems ein Stabmodell, welches der heutigen FE-Methode ähnelt. Wenig später hat R. Courand ein Paper publiziert (1943), in dem Differentialgleichungen, durch den Ansatz von Testfunktionen auf dreieckigen Teilbereichen, gelöst werden. In den 1950er Jahren wurden die ersten Einsätze der Finite Elemente Methode in der Luft- und Raumfahrtindustrie verzeichnet. M.J. Turner et al. hat 1959 in dem Journal of the Aeronautical Sciences eine der frühesten Veröffentlichungen zu der Grundidee der FEM gemacht. Der Co-Autor R. W. Clough publizierte ein weiteres Paper, welches zum ersten Mal die Formulierung _Finite Elemente_ nutzte. Neben den beiden genannten Autoren, sind weitere bedeutende Wissenschaftler, die zu der Entwicklung der FEM erheblich beigetragen haben, Ted Belytschko, Olgierd C. Zienkiewicz  u.v.a.\n",
        "\n",
        "Um einen ersten Überblick über die Finite Elemente Methode zu schaffen ist in @fig-Ablauf-FEM der formale Ablauf dargestellt, wie die FEM heutzutage bei der Lösung von Problemen eingebracht wird. In den meisten Fällen liegt das zu berechnende Bauteil als CAD-Modell vor. Aus diesem Modell soll im Vorgang des Preprozessing ein FE-Modell erstellt werden. Teil dessen ist die Generierung eines Netzes mit Finiten Elementen, der Zuweisung von Elementdaten und Materialinformationen, das Aufbringen von Lasten, sowie die Festlegung von Randbedingungen. Ein dadurch erstelltes lineares Gleichungssystem wird im Zuge der FEM gelöst. Die Ergebnisauswertung erfolgt im Postprozessor durch die Darstellung von Verformungen, Spannungen und Schnittgrößen.\n",
        "\n",
        "![formaler Ablauf FEM](00-pics/Ablauf-FEM.png){#fig-Ablauf-FEM width=40%} \n",
        "\n",
        "Der Ablauf der computergestützten numerischen Berechnung wurde bereits in @sec-einfuehrungsbeispiel anhand des Biegebalkens erläutert und wird in allgemeiner Form in dem Ablaufschema @fig-Ablauf-FEM-Berechnung visualisiert. Die Basisidee der Finite Elemente Methode ist die Lösung eines Problems möglichst genau zu approximieren. Die Approximation der gesuchten Lösungsfunktion $w_h = \\sum \\varphi_i \\hat{w}_i$ erfolgt durch die Kombination von bereits bekannten Funktionen, welche elementweise definiert werden (Schritt 4, @fig-Ablauf-FEM-Berechnung). Hierfür muss das lineare Gleichungssystem, hergeleitet aus der schwachen Form des Problems $a(w,\\delta w) = b(\\delta w)$, gelöst werden. Die zweite Idee, auf der die FEM beruht, ist die Unterteilung des Gebiets in sogenannte Elemente, auf denen die Formfunktionen $\\varphi_i$ definiert werden. Diese Basisfunktionen werden in @sec-FE-Lagrange bis @sec-FE-Hermite-konform für unterschiedliche Elementtypen hergeleitet.\n",
        "\n",
        "Die, auf dem physikalischen Problem basierenden, Grundgleichungen und Randbedingungen beschreiben die starke Form (Schritt 1, @fig-Ablauf-FEM-Berechnung), die in den meisten Fällen eine partielle Differentialgleichungen ist. Zwischen der Approximierten Lösung und der exakten Lösung entsteht der sogenannte Diskretisierungsfehler, d.h. der Unterschied zwischen dem Designmodell und dem Analysemodell. Dieser Fehler kann durch die Feinheit des Finite Elemente Netzes größtenteils eingedämmt werden, wohingegen Fehler bei der Modellbildung und Ergebnisinterpretation alleine bei der Anwendung der Finite-Element-Methode geschehen. Auf diese Aspekte wird hier nicht weiterführend eingegangen, sondern auf den Artikel von @werkle_anwendung_1996 verwiesen.\n",
        "\n",
        "![Ablauf der Finite Elemente Berechnung](00-pics/Ablauf-FEM-Berechnung.png){#fig-Ablauf-FEM-Berechnung width=95%} \n",
        "\n",
        "\n",
        "\n",
        "## Basis Funktionen der finiten Elemente {#sec-basis-funktionen} \n",
        "\n",
        "Für die Lösung von Variationsproblemen wird das gegebene Gebiet $\\Omega$ in endlich viele Teilgebiete zerlegt. In dieser Arbeit werden quadratische Elemente im zweidimensionalen, ebenen, Fall betrachtet. Der Begriff _Element_ hat hier zwei Bedeutungen: auf der einen Seite werden die geometrischen Teilgebiete als _Element_ bezeichnet, während mit _Finiten Elementen_ hingegen Funktionen gemeint sind^[@BraeFini1992, Seite 57, Fußnote].\n",
        "Nach Braess gibt es drei Merkmale, die bei der Definition eines Finite Elemente Raums am wichtigsten sind.\n",
        "\n",
        "1. Geometrie der Teilgebiete: Dreiecks- bzw. Viereckelemente^[In dieser Arbeit werden ausschließlich Viereckelemente behandelt]\n",
        "\n",
        "2. Im zweidimensionalen Raum werden Funktionen mit zwei Variablen definiert, welche als _Polynome vom Grad_ $\\le t$ bezeichnet werden, wenn der höchste Exponent der Variablen $\\le t$ ist. Vollständige Polynome sind Finite Elemente, in denen alle Polynome vom Grad $\\le t$ enthalten sind. \n",
        "\n",
        "3. Stetigkeits- und Differenzierbarkeitseigenschaften: Es wird von $C^k$-Elementen gesprochen, wenn die $k-\\text{te}$ Ableitung der Basisfunktionen stetig ist.\n",
        "\n",
        "Bei der Konstruktion der Basisfunktionen sind, je nach Anforderung, für die FEM vorrangig $C^{-1}$-, $C^{0}$- und $C^{1}$-Funktionen von Bedeutung. Eine Funktion wird $C^n$-Funktion genannt, wenn die Ableitung vom Grad $j$ mit $0 \\le j \\le n$ stetig in allen Punkten ist. Beispiele dieser sind in @fig-c-funktionen dargestellt.\n",
        "\n",
        "\n",
        "|Kontinuität | Knicke | Sprünge | Kommentar             |\n",
        "|:----------:|:------:|:-------:|:---------------------|\n",
        "| $C^{-1}$   | Ja     | Ja      | stückweise stetig     |\n",
        "| $C^{0}$    | Ja     | Nein    | stückweise stetig differenzierbar|\n",
        "| $C^{1}$    | Nein   | Nein    | stetig differenzierbar|\n",
        "\n",
        ":Kontinuitätseigenschaften {#tbl-kontinuität}\n",
        "\n",
        "Die Ableitung einer $C^0$-Funktion ist stetig, außer in den Punkten an denen die Funktion einen _Knick_ hat. Dementsprechend ist die Ableitung der $C^0$-Funktion eine $C^{-1}$-Funktion, welche an den _Knicken_ der $C^0$-Funktion einen _Sprung_ aufweist. Generell ist die Ableitungen eine $C^n$ Funktion eine $C^{n-1}$ Funktion.\n",
        "\n",
        "![Beispiel von  $C^{-1}$-, $C^{0}$- und $C^{1}$-Funktionen](00-pics/Kontinuitaer.png){#fig-c-funktionen width=60%}\n",
        "\n",
        "Die Formfunktionen unterschiedlicher finite Elemente Ansätze werden für die Lösung des Problems elementweise definiert. In @fig-kombi-basis-bilinear und @fig-kombi-basis-konf-hermite sind die Formfunktionen des bilinearen Elements und des konformen Hermite-Elements auf einer $8m \\times 8m$ Platte mit 9 Elementen dargestellt. Bei dem bilinearen Ansatz ist erkennbar, dass es sich um $C^{0}$-Funktionen handelt, da _Knicke_ an den Elementkanten vorhanden sind. \n",
        "\n",
        "![bilineare Basisfunktionen angewandt auf $8m \\times 8m$ Platte mit 9 Elementen](00-pics/Basisfunktionen_Bilinear.png){#fig-kombi-basis-bilinear width=100%}\n",
        "\n",
        "![konforme Hermite Basisfunktionen angewandt auf $8m \\times 8m$ Platte mit 9 Elementen](00-pics/Basisfunktionen_Hermite.png){#fig-kombi-basis-konf-hermite width=100%}\n",
        "\n",
        "Nachfolgend wird die Konstruktion der Basisfunktionen des bilineare Lagrange Element, das konforme und nicht konforme Hermite Rechteckelement und das Serendipityelement erläutert. Die Definition der Formfunktionen erfolgt auf dem Referenzelement, dargestellt jeweils für die verschiedenen Elementansätze in @fig-bilineares-element, @fig-BFS-element und @fig-ref-serendipity. Das Referenzelement wird in dem $\\xi-\\eta-$ Koordinatensystem definiert mit den Eckknoten $(-1,-1), (1,-1), (1,1) \\text{und} (-1,1)$.\n",
        "\n",
        "{{< pagebreak >}}\n",
        "### Lagrange Elemente (Bilineares Rechteckelement){#sec-FE-Lagrange}\n",
        "\n",
        "Das bilineare Element ist das simpelste unter den Viereckelementen. \n",
        "Es basiert auf einer Polynomfunktion 2. Grades mit den Polynomen \n",
        "\n",
        "$$\n",
        "1,x,y,xy,\n",
        "$$ {#eq-polynome-lagrange}\n",
        "\n",
        "wobei der bilineare Term $xy$ aus der dritten Reihe des Pascalschen Dreiecks enthalten ist. Sei das betrachtete Element, ein Rechteck dessen Kanten parallel zu den Koordinatenachsen verlaufen, so ist das Monom $xy$ an jeder Kante des Elementes linear, da entweder $x$ oder $y$ konstant sind. Die vier unbekannten Parameter können jeweils durch die vier Werte an den Ecken des Rechtecks eindeutig bestimmt werden. Das Ergebnis sind die Funktionen \n",
        "$$\n",
        "\\begin{align}\n",
        "N_1^e(x,y) &= \\frac{1}{A^e} (x-x_2^e)(y-y_4^e), \n",
        "&\\qquad \\qquad N_2^e(x,y) &= -\\frac{1}{A^e} (x-x_1^e)(y-y_4^e), \\\\\n",
        "N_3^e(x,y) &= \\frac{1}{A^e} (x-x_1^e)(y-y_1^e), \n",
        "&\\qquad \\qquad N_4^e(x,y) &= -\\frac{1}{A^e} (x-x_2^e)(y-y_1^e) \\\\\n",
        "\\end{align}\n",
        "$$ {#eq-black-scholes}\n",
        "\n",
        "für ein rechteckiges Element, wobei $A^e$ die Fläche des Elements bezeichnet. @fig-Lagrange-Formfunktionen veranschaulicht, dass bei dem beschriebenen Verschiebungsansatz der Verlauf geradlinig zwischen je zwei Knotenpunkten des Elements ist.\n",
        "\n",
        "![Bilineares Element](00-pics/BilinearesElement.png){#fig-bilineares-element width=40%}\n",
        "\n",
        "Für das Referenzelement $T_{ref} = [-1,1]^2$ mit den Referenzkoordinaten $\\xi$ und $\\eta$, wie in @fig-bilineares-element definiert, ergeben sich die Formfunktionen \n",
        "$$\n",
        "\\begin{align}\n",
        "N_1(\\xi,\\eta) &= \\frac{1}{4} (\\xi\\eta - \\xi - \\eta + 1) \n",
        "&\\qquad\\qquad N_2(\\xi,\\eta) &= \\frac{1}{4} (-\\xi\\eta+ \\xi - \\eta + 1) \\\\\n",
        "N_3(\\xi,\\eta) &= \\frac{1}{4} (\\xi\\eta + \\xi + \\eta + 1) \n",
        "&\\qquad\\qquad N_4(\\xi,\\eta) &= \\frac{1}{4} (-\\xi\\eta- \\xi + \\eta + 1). \\\\\n",
        "\\end{align}\n",
        "$$ {#eq-formfunktionen-bilinear}\n",
        "\n",
        "Für allgemeine Vierecke ist der oben beschriebene bilineare Ansatz untauglich. Zudem kommt der Ansatz der Forderung nach $C^1$-Stetigkeit nicht nach. Für die Parametrisierung in @sec-Parametrisierung sind die in @eq-formfunktionen-bilinear beschriebenen Formfunktionen von wesentlicher Bedeutung.\n",
        "\n",
        "![bilineare Formfunktionen auf dem Referenzelement](00-pics/Lagrange-Formfunktionen.png){#fig-Lagrange-Formfunktionen width=65%}\n",
        "\n",
        "### konformes Hermite Rechteckelement (Bogner-Fox-Schmitt) {#sec-FE-BFS}\n",
        "\n",
        "Das konforme Hermite-Rechteckelement, oder auch Bogner-Fox-Schmit-Element (BFS) genannt, bezeichnet ein Vierknotenelement mit je vier Freiheitsgraden \n",
        "$$\n",
        "w_i, \\theta_{\\xi i}, \\theta_{\\eta i} \\quad und \\quad \\theta_{\\xi \\eta i}\n",
        "$$\n",
        "\n",
        "in den Eckknoten. Die Nummerierung der Knoten mit $i = 1,2,3,4$ ist in @fig-BFS-element dargestellt. Die Freiheitsgrade $\\theta_{\\xi i}$ und $\\theta_{\\eta i}$ entsprechen der Ableitung von $w_i$ nach $\\xi$ bzw. $\\eta$ an dem Knoten $i$. Durch den zusätzlichen Freiheitsgrad $\\theta_{\\xi \\eta i}$, also die Ableitung zweiten Grades von $w_i$ nach $\\xi$ und $\\eta$, wird die geforderte $C^1$-Kontinuität des Elementes erreicht. Die Ansatzfunktion der Verschiebung $w(x,y)$ wird durch eine vollständige Polynomfunktion mit den Polynomen\n",
        "$$\n",
        "1,x,y,x^2,xy,y^2,x^3,x^2y,xy^2,y^3,x^3y,x^2y^2,xy^3,x^3y^2,x^2y^3,x^3y^3\n",
        "$$\n",
        "\n",
        "beschrieben. Die Parameter der Ansatzfunktion sind jeweils durch die Funktionswerte samt deren Ableitungen, ausgedrückt durch die Freiheitsgrade, an den 4 Ecken des Rechtecks eindeutig bestimmt. Die sich ergebenen Ansatzfunktionen können ebenso als Tensorprodukts der, in @sec-ke-biegelbalken beschriebenen, Hermite Polynome beschrieben werden.\n",
        "\n",
        "![Bogner-Fox-Schmit Element](00-pics/BFS-Element.png){#fig-BFS-element width=40%}\n",
        " \n",
        "\n",
        "In @fig-Bogner-Fox-Schmitt-Formfunktionen sind die Formfunktionen \n",
        "$$\n",
        "N_{i,j}(\\xi,\\eta) = H_i(\\xi) H_j(\\eta), \\quad i,j = 1,2,3,4\n",
        "$${#eq-BFS-Formfunktionen}\n",
        "\n",
        "dargestellt. Für die ausformulierten Basisfunktionen wird auf @defelement verwiesen. Für reine Rechtecke ist der Bogner-Fox-Schmit Ansatz sehr sinnvoll, nicht aber für allgemeine Vierecke, da dort der zusätzliche Freiheitsgrad $\\theta_{\\xi \\eta i}$ an den vier Knoten störend wirkt.\n",
        "\n",
        "![Bogner-Fox-Schmitt Formfunktionen auf dem Referenzelement](00-pics/Bogner-Fox-Schmitt-Element.png){#fig-Bogner-Fox-Schmitt-Formfunktionen width=75%}\n",
        "\n",
        "<!--\n",
        " ### nichtkonformes Hermite Rechteckelement {#sec-FE-Hermite-nichtkonform}\n",
        "\n",
        "Das nichtkonforme Hermite Element hat je Knoten einen Verschiebungs- und zwei Verdrehungsfreiheitsgrade\n",
        "$$\n",
        "w_i, \\theta_{\\xi i} \\quad und \\quad \\theta_{\\eta i}.\n",
        "$$\n",
        " \n",
        "\n",
        "Die Basis für die Ansatzfunktionen der Verschiebung $w(x,y)$ bildet eine unvollständige Polynomfunktion dritten Grades mit den den Polynomen\n",
        "$$\n",
        "1,x,y,x^2,xy,y^2,x^3,x^2y,xy^2,y^3,x^3y,xy^3 \\quad.\n",
        "$$\n",
        "\n",
        "Die Forderung nach $C^1$-Stetigkeit der Ansatzfunktionen an den Rändern benachbarter Elemente wird in diesem Fall nur von dem Verschiebungsansatz, nicht aber von den beiden Verdrehungen, erfüllt. @fig-Hermite-nichtkonform-Formfunktionen zeigt, die sich ergebenen Formfunktionen des nichtkonformen Elements.\n",
        "\n",
        "![Formfunktionen des nicht konformen Hermite Elements auf dem Referenzelement](00-pics/Hermite-unkonform-Formfunktionen.png){#fig-Hermite-nichtkonform-Formfunktionen width=75%} \n",
        "-->\n",
        "\n",
        "### Rechteckelement der Serendipity Klasse {#sec-FE-Hermite-konform}\n",
        "\n",
        "Die Ansatzfunktion für $w(x,y)$ für das Rechteckelement der Serendipity Klasse basiert auf einer unvollständigen quadratischen Polynomfunktion mit den Polynomen  \n",
        "$$\n",
        "1,x,y,x^2,xy,y^2,x^2y,xy^2 \\quad.\n",
        "$$\n",
        "\n",
        "Das Element besteht, wie @fig-ref-serendipity zeigt, aus vier Eckknoten und vier Mittelknoten in der Mitte der jeweiligen Seiten. Die Forderung nach $C^1$-Stetigkeit der Ansatzfunktionen an den Rändern benachbarter Elemente wird nicht erfüllt.\n",
        "\n",
        "![Serendipityelement](00-pics/Serendipity.png){#fig-ref-serendipity width=40%}\n",
        "\n",
        "Die sich ergebenen Formfunktionen\n",
        "$$\n",
        "\\begin{align}\n",
        "N_1(\\xi,\\eta) &= \\frac{1}{4} (-\\xi^2\\eta - \\xi\\eta^2 + \\xi^2  + \\xi\\eta+\\eta^2 - 1) \n",
        "&\\qquad\\qquad N_5(\\xi,\\eta) &= \\frac{1}{2}  (\\xi^2\\eta - \\xi^2 - \\eta + 1) \\\\\n",
        "N_2(\\xi,\\eta) &= \\frac{1}{4} (-\\xi^2\\eta + \\xi\\eta^2 + \\xi^2  - \\xi\\eta+\\eta^2 - 1) \n",
        "&\\qquad\\qquad N_6(\\xi,\\eta) &= \\frac{1}{2}  (-\\xi\\eta^2 - \\eta^2    + \\xi     + 1) \\\\\n",
        "N_3(\\xi,\\eta) &= \\frac{1}{4} (\\xi^2\\eta  + \\xi\\eta^2 + \\xi^2  + \\xi\\eta+\\eta^2 - 1) \n",
        "&\\qquad\\qquad N_7(\\xi,\\eta) &= \\frac{1}{2}  (\\xi^2\\eta  - \\xi^2     + \\eta    + 1) \\\\\n",
        "N_4(\\xi,\\eta) &= \\frac{1}{4} (\\xi^2\\eta  - \\xi\\eta^2 + \\xi^2  - \\xi\\eta+\\eta^2 - 1) \n",
        "&\\qquad\\qquad N_8(\\xi,\\eta) &= \\frac{1}{2}  (\\xi\\eta^2  - \\eta^2    - \\xi     + 1) \\\\\n",
        "\\end{align}\n",
        "$$ \n",
        "\n",
        "sind in @fig-Serendipity-Formfunktionen dargestellt. Häufig finden die Formfunktionen der Serendipity Klasse Anwendung bei der Berechnung von Strukturen, dessen Elemente isoparametrisch sind. Dies ist vor allem dann der Fall, wenn die Struktur eine unregelmäßige, unsymmetrische Geometrie hat und die Elemente dementsprechend schiefwinklig und in beliebiger Lage angeordnet sind. Auf die Formulierung für allgemeine Viereckelemente wird in @sec-Steifigkeitsmatrix-DKQ und @sec-Parametrisierung näher eingegangen.\n",
        "\n",
        "![Formfunktionen des Serendipity Elements auf dem Referenzelement](00-pics/Serendipity-Formfunktionen.png){#fig-Serendipity-Formfunktionen width=60%}\n",
        "\n",
        "\n",
        "\n",
        "## Approximation von Funktionen {#sec-approximation-funktionen}\n",
        "\n",
        "Die zwei wesentlichen Ideen der FEM-Lösung:\n",
        "\n",
        "1. Konstruieren einer Näherungslösung durch die Kombination von vordefinierten Funktionen und\n",
        "2. Funktionen stückweise definieren auf sogenannten Elementen\n",
        "\n",
        "werden nachfolgend näher erläutert. Die schubstarre Kirchhoff-Platte bildet die Basis dieser Arbeit. Bei dieser Plattentheorie wird die Verformung durch $w$ beschrieben. Die Verdrehungen $\\theta_x$ und $\\theta_y$ werden durch die Ableitung der Verformung beschrieben. Für die Näherungslösung der Verformung werden Basisfunktionen $\\varphi_1, \\varphi_2,...,\\varphi_N$ gewählt, sodass $w_h$ durch die Funktion\n",
        "$$\n",
        "\\begin{align}\n",
        "&w_h(x,y) = \\varphi_1(x,y) \\cdot \\hat{w}_1 +  \\varphi_2(x,y) \\cdot \\hat{w}_2 + ... + \\varphi_N(x,y) \\cdot \\hat{w}_N = \\sum_{i=1}^N \\varphi_i(x,y) \\cdot \\hat{w}_i \n",
        "\\end{align}\n",
        "$${#eq-linearkombination-platte}\n",
        "\n",
        "approximiert wird. Das ursprüngliche Problem, eine Lösungsfunktionen zu finden, ist jetzt ersetzt worden durch das Problem, reele Zahlen $\\hat{w}_1, \\hat{w}_2,...,\\hat{w}_N$ zu finden. Die Summe in @eq-linearkombination-platte versteht sich als Linearkombination von Basisfunktionen. Bei der Definition des abstrakten Variationsproblems für den Biegebalken wurde bereits der Raum $V$ eingeführt, welcher die Menge aller Funktionen auf dem Gebiet $\\Omega$ beschreibt. Der Raum $V$ ist unendlich dimensional. Die Menge aller möglichen Linearkombination von $\\varphi_1, \\varphi_2,...,\\varphi_N$ ist der endlich dimensionale Vektorraum \n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "&V_h = Lin(\\varphi_1,\\varphi_2,...,\\varphi_N) = \\{ \\sum_{i=1}^N \\varphi_i \\cdot \\hat{w}_i \\vert \\hat{w}_i \\in \\mathbb{R} \\}, \\\\\n",
        "% &V_h \\subset V\n",
        "\\end{align}\n",
        "$${#eq-subspace}\n",
        "\n",
        "wobei $V_h$ ein Unterraum von $V$ ist und $N$ die Dimension des Raums $V_h$. Die Funktionen $\\varphi_i$ sind die Elemente des Vektorraums $V_h$. Das sich daraus ergebende Problem wird _abstraktes, diskretes Variationsproblem_ bezeichnet.\n",
        "\n",
        "::: {.block fill=\"luma(230)\" inset=\"8pt\" radius=\"4pt\"}\n",
        "\n",
        "*Abstraktes, diskretes Variationsproblem* \n",
        "\\\n",
        "\\\n",
        "Gesucht ist eine Funktion $w_h \\in V_h$, sodass \n",
        "$$\n",
        "a(w_h, \\delta w_h)= b(\\delta w_h) \\quad \\forall \\quad \\delta w_h \\in V_h\n",
        "$${#eq-abstraktes-diskretes-variationsproblem}\n",
        "\n",
        ":::\n",
        "\n",
        "Die zweite Idee basiert darauf, dass das gesamte System in mehrere Elemente aufgeteilt wird und die Funktionen elementweise definiert werden. Das Berechnungsgebiet $\\Omega$, in diesem Fall die Platte, wird in die Elemente $\\Omega_e, e = 1,...,N_e$ unterteilt. In dieser Arbeit wird sich auf viereckige Plattenelemente beschränkt, sodass jedes Element mindestens vier Knoten hat, je nach Elementansatz aber auch acht oder mehr Knoten haben kann (s. @sec-basis-funktionen). Die Basisfunktionen $\\varphi_1, \\varphi_2,...,\\varphi_N$ werden elementweise definiert. Die gesuchten reellen Zahlen $\\hat{w}_i \\in \\mathbb{R}$ werden Freiheitsgrade bzw. im englischen _degrees of freedom_ (abgekürzt DOF) bezeichnet.\n",
        "\n",
        "\n",
        "Für die Definition des Variationsproblems in @eq-abstraktes-diskretes-variationsproblem werden die Linear- und die Bilinearform genutzt. Um im weiteren Verlauf mit dem Variationsproblem weiterrechnen zu können wird kurz auf die Eigenschaften der genutzten Funktionale eingegangen. Diese beiden Funktionale gehören dem mathematischen Teilgebiet der Funktionalanalysis an. Als Funktional werden eine Funktion bzw. Abbildung bezeichnet, die den Vektorraum $V$ in seinem Skalarkörper $\\mathbb{K}$ abbilden. Die mathematische Definition ist nachfolgend dargestellt.\n",
        "\n",
        "::: {.block fill=\"luma(230)\" inset=\"8pt\" radius=\"4pt\"}\n",
        "_Definition_ (Funktional): Sei $V$ ein $\\mathbb{K}$-Vektorraum mit $\\mathbb{K} \\in \\{ \\mathbb{R},\\mathbb{C} \\}$. Ein Funktional $T$ ist eine Abbildung $T:V \\to \\mathbb{K}$.\n",
        ":::\n",
        "\n",
        "Sowohl die Linearform, als auch die Bilinearform, sind, wie der Name erkennen lässt, lineare Funktionale. Als Vektorraum $V$ wird die Menge von Funktionen die $V$ abbilden genannt. Die folgenden Rechenoperationen können auf die Funktionen\n",
        "\n",
        "$\\quad \\quad \\quad f,g: \\mathbb{R}^n \\to \\mathbb{R}$\n",
        "\n",
        "angewandt werden:\n",
        "$$\n",
        "\\begin{align}\n",
        "&\\text{Addition zweier Funktionen:} &&\\quad h = f+g &&\\quad \\quad \\text{definiert} \\quad \\quad h(x)=f(x)+g(x) \\\\\n",
        "&\\text{Multiplikation mit einer Zahl:} &&\\quad h = \\alpha \\cdot f &&\\quad \\quad \\text{definiert} \\quad \\quad h(x)=\\alpha \\cdot f(x) \\quad , \\quad \\alpha \\in \\mathbb{R} \\\\\n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        "Die Linearform $b(\\delta w)$ des abstrakten Variationsproblems (Einführungsbeispiel @eq-abstraktes-variationsproblem-balken, Kirchhoff-Platte @eq-linearform) beschreibt eine Abbildung von dem Vektorraum $V \\to \\mathbb{R}$ mit den in @eq-eig-linearform genannten Eigenschaften.\n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "& b(u+v) = b(u) + b(v) &&\\quad \\quad \\quad \\text{(Additivität)} \\\\\n",
        "\\\\\n",
        "& b(\\alpha \\cdot u) = \\alpha \\cdot b(u) &&\\quad \\quad \\quad \\text{(Homogenität)}\n",
        "\\end{align}\n",
        "$${#eq-eig-linearform}\n",
        "\n",
        "Die Bilinearform $a(w,\\delta w)$ des abstrakten Variationsproblems beschreibt die Abbildung $V \\times V \\to \\mathbb{R}$, wobei beide Funktionen demselben Vektorraum $V$ entstammen. Gemäß der Definition einer Bilinearform sind beide Funktionen linear. Die Eigenschaften der Bilinearform ergeben sich analog zu \n",
        "$$\n",
        "\\begin{align}\n",
        "&a(u+v,w) &&= a(u,w) + a(v,w) \\quad , \\\\\n",
        "\\\\\n",
        "&a(\\alpha \\cdot u,v) &&= \\alpha \\cdot a(u,v) \\quad , \\\\\n",
        "\\\\\n",
        "&a(u,v+w) &&= a(u,v) + a(u,w) \\quad ,\\\\\n",
        "\\\\\n",
        "&\\text{und}\\\\\n",
        "\\\\\n",
        "&a(u,\\alpha \\cdot v) &&= \\alpha \\cdot a(u,v) \\quad .\n",
        "\\end{align}\n",
        "$${#eq-eig-bilinearform}\n",
        "\n",
        "Weiterführend ist die Bilinearform _positiv definit_ für\n",
        "$$\n",
        "a(u,u) \\ge 0 \\quad \\forall \\quad u \\in V\n",
        "$$\n",
        "\n",
        "und _symmetrisch_ für \n",
        "$$\n",
        "a(u,v) = a(v,u) \\quad .\n",
        "$$\n",
        "\n",
        "Ist die Bilinearform sowohl positiv definit als auch symmetrisch, so wird von einem Skalarprodukt gesprochen. Dies ist im Fall der Bilinearform $a(w,\\delta w)$ des abstrakten Variationsproblems gegeben.\n",
        "\n",
        "\n",
        "## numerische Lösung {#sec-numerische-loesung}\n",
        "\n",
        "Die Gleichung des abstrakten, diskreten Variationsproblems gilt für alle Testfunktionen $\\delta w_h$. Für die numerische Lösung des Problems\n",
        "wird dieses durch $N$ Gleichungen mit $w_h$ als Unbekannte ersetzt. Dazu wird die Linearkombination\n",
        "\n",
        "$$\n",
        "\\delta w_h = \\sum_{i = 1}^N \\varphi_i \\cdot \\delta \\hat{w}_i\n",
        "$$\n",
        "\n",
        "eingesetzen in @eq-abstraktes-diskretes-variationsproblem. Durch die zuvor besprochenen Funktionale, angewandt auf das vorliegende Problem ergeben sich die äquivalenten Sätze \n",
        "\n",
        "::: {.block fill=\"luma(230)\" inset=\"8pt\" radius=\"4pt\"}\n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "a(w_h, \\delta w_h) &= b(\\delta w_h) \\qquad &&\\forall \\delta w_h \\in V_h \\\\\n",
        "\\\\\n",
        "a(w_h, \\Sigma_{i = 1}^N \\varphi_i \\cdot \\delta \\hat{w}_i)&= b(\\Sigma_{i = 1}^N \\varphi_i \\cdot \\delta \\hat{w}_i) \\quad &&\\forall \\quad \\delta w_h \\in V_h \\\\\n",
        "\\\\\n",
        "a(w_h, \\varphi_i)&= b(\\varphi_i) \\qquad &&i = 1,...,N\n",
        "\\end{align}\n",
        "$${#eq-03}\n",
        "\n",
        ":::\n",
        "\n",
        "Im zweiten Schritt wird die Liniearkombination aus @eq-linearkombination-platte mit veränderter Laufvariable $j$ in die dritte Zeile von @eq-03 eingesetzt, dessen Ergebniss, nach gleicher Vorhergehensweise wie oben, \n",
        "\n",
        "$$\n",
        "\\sum_{j = 1}^N \\underbrace{a(\\varphi_j, \\varphi_i)}_{k_{ij}} \\cdot \\hat{w}_j= \\underbrace{b(\\varphi_i)}_{r_i}\n",
        "$$\n",
        "\n",
        "ist. Für das Gesamtsystem ergibt sich das lineare Gleichungssystem\n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "\\mathbf{K} \\mathbf{\\hat{w}} &= \\boldsymbol{r} \\\\\n",
        "\\\\\n",
        "&\\text{mit} \\\\\n",
        "\\\\\n",
        "&\\mathbf{K} &&= k_{ij} &&= a(\\varphi_j, \\varphi_i) \\\\\n",
        "&\\boldsymbol{r} &&= r_i    &&= b(\\varphi_i) \\quad \\text{mit} \\quad i,j = 1,...,N,\n",
        "\\end{align}\n",
        "$${#eq-lin-gleichungssystem}\n",
        "\n",
        "$\\mathbf{K}$ bezeichnet die Gesamtsteifigkeitsmatrix, $\\boldsymbol{r}$ den Lastvektor und $\\boldsymbol{\\hat{w}}$ den unbekannten, zu approximierenden Verschiebungsvektor. Die Bilinearform (@eq-bilinearform) wird für jedes einzelne Element ausgewertet, wodurch sich die jeweiligen Elementsteifigkeitsmatrizen ergeben. Durch die Assemblierung der Elementsteifigkeitsmatrizen lässt sich die globale Steifigkeitsmatrix ableiten. Die gleiche Vorgehensweise wird bei der Assemblierung des globalen Lastvektors verwendet. Die entsprechenden Bezeichnungen für ein Element sind $\\mathbf{k^e_{ij}}$ für die Elementsteifigkeitsmatrix, $\\boldsymbol{r^e}$ für den Elementlastvektor und $\\boldsymbol{\\hat{w}^e}$ für den Knotenverschiebungsvektor (s. @tbl-Variablen).\n",
        "\n",
        "\n",
        "|                     | Gesamtsystem         | Element|\n",
        "|:------------------------|:--------------------:|:-----------:|\n",
        "| Bilinearform (Variationsproblem) | $a(w, \\delta w)$ | $a(w^e, \\delta w^e)$ | \n",
        "| Steifigkeitsmatrix  | $\\mathbf{K}$         |$\\mathbf{k_{ij}^e}$|\n",
        "| Bilinearform (Steifigkeitsmatrix) | $a(\\varphi_j, \\varphi_i)$ | $a(\\varphi^e_j, \\varphi^e_i)$|\n",
        "| Lastvektor          | $\\mathbf{r}$         |$\\mathbf{r^e}$|\n",
        "| Verschiebungsvektor | $\\mathbf{\\hat{w}}$   |$\\mathbf{\\hat{w}^e}$|\n",
        "\n",
        ": Variablen des linearen Gleichungssystems {#tbl-Variablen}\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "{{< pagebreak >}}\n",
        "\n",
        "\n",
        "<!-- Kapitel 3 -->\n",
        "\n",
        "```{=typst}\n",
        "#set page(header: align(right, emph(text(size: 12pt)[Kapitel 3: Kirchhoffsche Plattentheorie])))\n",
        "```\n",
        "\n",
        "# Kirchhoffsche Plattentheorie {#sec-mech-math-grundlagen}\n",
        "\n",
        "Die Differentialgleichung des physikalischen Problems bildet den Ausgangspunkt der Finite Elemente Berechnung. Bevor in @sec-fem-plattentragwerke die Finite Elemente Methode auf die schubstarre Platte angewandt wird, werden in diesem Kapitel die Grundgleichungen der Kirchhoff-Platte erläutert. Verschiebungsfeld (@sec-kinematik), Verzerrungsfeld (@sec-verzerrung) und Gleichgewichtsbeziehungen (@sec-gleichgewicht) werden auf Grundlage der Kirchhoffschen Plattentheorie hergeleitet und bilden zusammen mit dem Materialgesetz (@sec-materialgesetz) die Basis für die Formulierung der Differentialgleichung. \n",
        "\n",
        "Die Lösung der Differentialgleichung erfolgt gemäß @fig-Ablauf-FEM-Berechnung mittels Unterteilung des Problemgebiets in finite Elemente.\n",
        "\n",
        "\n",
        "## Einführung Plattentragwerke {#sec-einfuehrung-plattentragwerke}\n",
        "\n",
        "Tragwerke wie Wohnhäuser, Brücken, Lagerhallen und weitere, werden in Tragwerksstrukturen wie Balken, Platten und Scheiben unterteilt. Selten besteht ein Tragwerk aus nur einem Element. Üblicherweise besteht es aus einer Zusammenstellung mehrerer Elemente, welche sich gegenseitig beeinflussen. Ziel der Modellierung des Tragwerkes ist es, ein möglichst realitätsnahes Abbild zu schaffen, um somit die Tragfähigkeit beurteilen zu können. Plattentragwerke sind ein wesentlicher Teil bei der Modellierung von Tragwerksstrukturen.\n",
        "\n",
        "Die Zustandsgrößen, d.h. die Verschiebungsgrößen sowie die äußeren Kraftgrößen, beschreiben das mechanische Verhalten eines Tragwerks und werden zur Formulierung der Grundgleichungen, d.h. den kinematischen Gleichungen, Gleichgewichtsbeziehungen und der Einführung eines Materialgesetzes, benötigt (s. @fig-zg-und-gg).\n",
        "\n",
        "Zur Berechnung der Tragwerksstrukturen werden zwei wesentliche Vereinfachungen getroffen. Zum einen wird das Werkstoffverhalten als linear angenommen, entsprechend dem Hookschen Gesetz. Zum anderen werden die Geometrien, je nach räumlicher Ausdehnung, als eindimensionales Linienelement oder als zweidimensionales Flächenelement definiert. Bei den Flächenelementen wird in Platten- und Scheibenelemente unterschieden. Diese, in der Realität dreidimensionalen Strukturen, zeichnen sich dadurch aus, dass Länge und Breite der Struktur deutlich größer als die Dicke sind. Die Flächen werden somit auf die zwei maßgebenden Dimensionen reduziert. Flächenelemente können, in Form von Platten und Scheiben, eben, oder, in Form von Schalen, gekrümmt sein. \n",
        "\n",
        "![Zustandsgrößen und Grundgleichungen der Platte](00-pics/Grundgleichungen.png){#fig-zg-und-gg width=90%}\n",
        "\n",
        "Bei der Berechnung von Plattentragwerken in der Finite-Elemente-Analyse sind zwei Theorien von wesentlicher Bedeutung. Zum einen das Kirchhoffsche Plattenmodell und zum anderen das Reissner-Mindlin Plattenmodell. Die Unterschiede der beiden Modelle, sowie die Grundgleichungen für die Kirchhoff-Platte werden im Folgenden definiert. Ziel ist es, die entsprechenden Differentialgleichungen der Kirchhoff-Platte herzuleiten.\n",
        "\n",
        "\n",
        "## Differentialgleichung der Kirchhoff Platte{#sec-kirchhoffschen-plattentheorie}\n",
        "\n",
        "Die Platte, als ebenes Flächentragwerk, zeichnet sich durch ausschließlich senkrecht zur Plattenmittelebene wirkende Beanspruchungen aus. Zudem ist die Plattendicke $h$ signifikant kleiner, verglichen mit den Abmessungen in der Plattenebene.\n",
        "Die zugrunde liegende Theorie wurde von Gustav Kirchhoff im Jahr 1850 zum ersten Mal formuliert. Entsprechend der Annahmen von Bernoulli in Bezug auf einen elastischen Stab, geht Kirchhoff von folgenden zwei grundlegenden kinematischen Annahmen aus:\n",
        "\n",
        "- eine Normale, welche im unverformten Zustand senkrecht zur Plattenmittelebene ist, bleibt auch im verformten Zustand senkrecht zu der neutralen Ebene. Die Durchbiegung der verformten Platte im Abstand $z$ zur neutralen Achse wird durch \n",
        "$$ \n",
        "w = w(x,y) \n",
        "$$ {#eq-verformung-w}\n",
        "beschrieben.\n",
        "\n",
        "- die Plattenfaser verwölbt sich im  verformten und unverformten Zustand nicht. Dies entspricht der Hypothese vom Ebenbleiben des Querschnitts beim Euler-Bernoulli-Balken und ist in @fig-kirchhoffplatte dargestellt.\n",
        "\n",
        "![Verformung einer Kirchhoff Platte](00-pics/Kirchhoff.png){#fig-kirchhoffplatte width=80%}\n",
        "\n",
        "Neben dem beschriebenen schubstarren Kirchhoff-Plattenmodell, gibt es das Modell der schubweichen Platte (@fig-reissner-mindlin-platte). Letztere wird in der Fachliteratur vielfach als Reissner-Mindlin-Platte aufgeführt. Den wesentlichen Unterschied stellt die Normalenhypothese dar. Die Hypothese vom Ebenebleiben des Querschnitts bleibt bei der schubweichen Platte bestehen, wohingegen die Normalenhypothese fallengelassen wird. Infolgedessen sind die Biegewinkel $\\theta$ nicht mehr abhängig von der Durchbiegung und stellen unabhängige Freiheitsgrade dar. Eine weitere Folge sind transversale Schubverzerrungen, welche bei der Kirchhoff-Platte vernachlässigt werden.\n",
        "\n",
        "![Verformung einer Reissner-Mindlin Platte](00-pics/Reissner-Mindlin.png){#fig-reissner-mindlin-platte width=80%}\n",
        "\n",
        "\\\n",
        "\n",
        "### kinematische Gleichungen (Verschiebungsfeld) {#sec-kinematik}\n",
        "\n",
        "Zur Formulierung der kinematischen Gleichungen werden die partiellen Ableitung von $w(x,y)$ nach $x$, beziehungsweise $y$ berechnet, welche die Neigung der neutralen Ebene angeben. Der Winkel des Steigungsdreiecks von $\\frac{\\partial w}{\\partial y}$ oder $\\frac{\\partial w}{\\partial x}$ an dem Punkt $P(x,y)$ der Ebene, entspricht dem Verdrehwinkel der Fläche an dem Punkt $P(x,y)$ um die $x$-Achse oder $y$-Achse. In Abhängigkeit der Verdrehwinkel\n",
        "\n",
        "$$ \n",
        "\\theta_x (x,y) = \\arctan(-\\frac{\\partial w(x,y)}{\\partial y}) \n",
        "$$ {#eq-black-scholes-02}\n",
        "\n",
        "und\n",
        "$$ \n",
        "\\theta_y (x,y) = \\arctan(-\\frac{\\partial w(x,y)}{\\partial x}) \n",
        "$$ {#eq-black-scholes-03}\n",
        "\n",
        "werden die horizontalen Verschiebungen des Punktes P\n",
        "$$ \n",
        "u(x,y,z)=sin(\\theta_x (x,y)) \\cdot z\n",
        "$$ {#eq-black-scholes-04}\n",
        "\n",
        "und\n",
        "$$ \n",
        "v(x,y,z)=sin(\\theta_y (x,y)) \\cdot z\n",
        "$$ {#eq-black-scholes-05}\n",
        "\n",
        "berechnet. \n",
        "Unter der weiteren Annahme, dass die Verschiebungen und die Verdrehungen klein sind gilt näherungsweise $sin(\\theta_x) \\approx \\theta$ und $sin(\\theta_y) \\approx \\theta$ und es ergeben sich die Zusammenhänge\n",
        "$$ \n",
        "u(x,y,z) = - z \\cdot \\frac{\\partial w(x,y)}{\\partial x} \n",
        "$$ {#eq-verschiebung-u}\n",
        "$$ \n",
        "v(x,y,z) = - z \\cdot \\frac{\\partial w(x,y)}{\\partial y}. \n",
        "$$ {#eq-verschiebung-v}\n",
        "\n",
        "Die Zusammenhänge nach @eq-verformung-w, @eq-verschiebung-u und @eq-verschiebung-v werden in der Literatur auch als Verschiebungsfeld nach der Kirchhoffschen Plattentheorie bezeichnet.\n",
        "\n",
        "![Verdrehung und Verschiebung eines Punktes nach Kirchhoff](00-pics/Verschiebung.png){#fig-horizontale-Verschiebung width=100%}\n",
        "\n",
        "{{< pagebreak >}}\n",
        "### Materialgesetz {#sec-materialgesetz}\n",
        "\n",
        "Die bisher betrachteten kinematischen Gleichungen sind unabhäging von materialspezifischen Eigenschaften. Um das mechanische Verhalten der Platte vollständig zu beschreiben, besteht die Notwendigkeit der Einführung eines Materialgesetztes. Bei der Betrachtung von linear-elastischem Materialverhalten, also einem linearen Zusammenhang zwischen Spannungen und Verzerrungen, kann das Material durch das _verallgemeinerte Hooksche Gesetz_ mit\n",
        "\n",
        "\\\n",
        "\n",
        "$$\n",
        "\\sigma = E \\cdot \\varepsilon\n",
        "$$ {#eq-black-scholes-08}\n",
        "\n",
        "und\n",
        "$$\n",
        "\\tau = G \\cdot \\gamma\n",
        "$$ {#eq-black-scholes-09}\n",
        "\n",
        "dargestellt werden. Die Normalspannung $\\sigma$ und die Schubspannung $\\tau$ werden durch das Elastizitätsmodul $E$ bzw. das Schubmodul $G$ und die Dehung $\\epsilon$ bzw. die Schubverzerrung $\\gamma$ ausgedrückt. Diese Gesetzmäßigkeiten gelten für Materialien, dessen Verhalten richtungsunabhängig ist (isotropes Verhalten).\n",
        "\n",
        "### Verzerrungsfeld {#sec-verzerrung}\n",
        "\n",
        "Aus dem Verschiebungsfeld der Kirchhoff-Platte lässt sich das Verzerrungsfeld herleiten. Die Dehnungen \n",
        "\n",
        "$$ \n",
        "\\begin{align} \n",
        "\\epsilon_{xx} &= \\frac{\\partial u}{\\partial x}= -z \\cdot \\frac{\\partial^2 w}{\\partial x^2} \\\\\n",
        "\\epsilon_{yy} &=\\frac{\\partial v}{\\partial y}= -z \\cdot \\frac{\\partial^2 w}{\\partial y^2} \\\\\n",
        "\\end{align}\n",
        "$$ {#eq-dehnungen}\n",
        "\n",
        "beschreiben die Längenänderung der Platte in $x$- bzw. $y$-Richtung. Entsprechend der Kirchhoffschen Plattentheorie verschwindet die Dehnung $\\epsilon_{zz}$ aufgrund der Annahme der gleichbleibenden Plattendicke $h$. Die Schubverzerrung \n",
        "$$ \n",
        "\\begin{align} \n",
        "\\gamma_{xy} &= \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} =-2z \\cdot \\frac{\\partial^2 w}{\\partial x \\partial y}, \\\\ \n",
        "\\end{align}\n",
        "$$ {#eq-schubverzerrung-gleitung}\n",
        "\n",
        "oder auch Gleitung, beschreibt eine Winkeländerung. Konsistent mit den in @eq-verschiebung-u und @eq-verschiebung-v getroffenen Annahmen, als Folge des Ebenbleibens der Querschnitte, ergeben sich die Schubverzerrungen\n",
        "$$ \n",
        "\\begin{align} \n",
        "\\gamma_{xz} &= \\frac{\\partial u}{\\partial z} - \\frac{\\partial w}{\\partial x} = \\frac{\\partial w}{\\partial x}- \\frac{\\partial w}{\\partial x} =0\\\\ \n",
        "\\gamma_{yz} &= \\frac{\\partial v}{\\partial z} - \\frac{\\partial w}{\\partial y} = \\frac{\\partial w}{\\partial y} - \\frac{\\partial w}{\\partial y} =0.\\\\ \n",
        "\\end{align}\n",
        "$$ {#eq-schubverzerrung}\n",
        "\n",
        "Durch die Definition der Krümmungen mit\n",
        "$$ \n",
        "\\begin{align}  \n",
        "\\kappa_{xx} &= -\\frac{\\partial^2 w}{\\partial x^2} \\qquad\n",
        "\\kappa_{yy} &= -\\frac{\\partial^2 w}{\\partial y^2} \\qquad\n",
        "\\kappa_{xy} &= -2 \\frac{\\partial^2 w}{\\partial x \\partial y}\n",
        "\\end{align}\n",
        "$$ {#eq-kruemmung}\n",
        "\n",
        "kann das Verzerrungsfeld nach der Kirchhoffschen Plattentheorie \n",
        "als Vektor-Matrix-Produkt mit\n",
        "$$\n",
        "\\left[ \\begin{array}{center}\n",
        "\\epsilon_{xx} \\\\ \n",
        "\\epsilon_{yy} \\\\ \n",
        "\\gamma_{xy} \n",
        "\\end{array}\\right]\n",
        "=\n",
        "z \\kappa \n",
        "= \n",
        "z \n",
        "\\left[ \\begin{array}{center}\n",
        "\\kappa_{xx} \\\\ \n",
        "\\kappa_{yy} \\\\ \n",
        "\\kappa_{xy} \n",
        "\\end{array}\\right]\n",
        "= \n",
        "-z \n",
        "\\left[ \\begin{array}{center}\n",
        "\\frac{\\partial^2 w}{\\partial x^2} \\\\\n",
        "\\frac{\\partial^2 w}{\\partial y^2} \\\\\n",
        "-2 \\frac{\\partial^2 w}{\\partial x \\partial y} \n",
        "\\end{array}\\right]\n",
        "$$ {#eq-black-scholes}\n",
        "\n",
        "beschrieben werden. Bei der isotropen Platte mit linear-elastischem Materialverhalten lässt sich das Spannungsfeld aus dem oben beschriebenem Verzerrungsfeld herleiten. Die Spannungen\n",
        "$$\n",
        "\\begin{align}\n",
        "\\sigma_{xx} &= \\frac{E}{1-\\nu^2} \\cdot (\\epsilon_{xx} + \\nu \\cdot \\epsilon_{yy}) \\\\\n",
        "\\sigma_{yy} &= \\frac{E}{1-\\nu^2} \\cdot (\\nu \\cdot \\epsilon_{xx} + \\epsilon_{yy}) \\\\\n",
        "\\tau_{xy}   &= \\frac{E}{2 \\cdot (1+\\nu)}  \\cdot \\gamma_{xy}\\ \n",
        "\\end{align}\n",
        "$$ {#eq-spannungen}\n",
        "\n",
        "sind linear veränderlich über die Plattendicken $h$. \n",
        "\n",
        "{{< pagebreak >}}\n",
        "### Schnittgrößen {#sec-schnittgrößen}\n",
        "\n",
        "Resultierend aus den Spannungskomponenten $\\sigma_{xx}$,$\\sigma_{yy}$ und $\\tau_{xy}$ ergeben sich die Biegemomente $m_{xx}$ und $m_{yy}$ und das Drillmoment $m_{xy}$, definiert als Moment pro Längeneinheit. Die Momente lassen sich durch Integration der Spannungen über die Höhe der Platte und Multiplikation mit dem Hebelarm $z$ zu\n",
        "$$\n",
        "\\begin{align}\n",
        "m_{xx} &= \\int_{-h/2}^{h/2} z \\cdot \\underbrace{\\frac{E}{1-\\nu^2} \\cdot (\\epsilon_{xx} + \\nu \\cdot \\epsilon_{yy})}_{\\sigma_{x x}} \\cdot dz \\\\\n",
        "m_{yy} &= \\int_{-h/2}^{h/2} z \\cdot \\underbrace{\\frac{E}{1-\\nu^2} \\cdot (\\nu \\cdot \\epsilon_{xx}+ \\epsilon_{yy})}_{\\sigma_{y y}} \\cdot dz \\\\\n",
        "m_{xy} &= \\int_{-h/2}^{h/2} z \\cdot \\underbrace{\\frac{E}{2 \\cdot (1+\\nu)} \\cdot \\gamma_{xy}}_{\\tau_{xy}} \\cdot dz \\\\\n",
        "\\end{align}\n",
        "$$ {#eq-black-scholes}\n",
        "\n",
        "berechnen. Die isotrope Plattensteifigkeit \n",
        "$$\n",
        "D = \\frac{E \\cdot h^3}{12 \\cdot (1-\\nu^2)}\n",
        "$$ {#eq-plattensteifigkeit}\n",
        "\n",
        "und die in @eq-kruemmung definierten Krümmungen $\\kappa$ erlauben eine vereinfachte Darstellung der Momente\n",
        "$$\n",
        "\\begin{align}\n",
        "m_{xx} &= D \\cdot (\\kappa_{xx} + \\nu \\cdot \\kappa_{yy}) &&= D \\cdot (\\frac{\\partial^2 w}{\\partial x^2} + \\nu \\cdot \\frac{\\partial^2 w}{\\partial y^2}) \\\\\n",
        "m_{yy} &= D \\cdot (\\nu \\cdot \\kappa_{xx} + \\kappa_{yy}) &&= D \\cdot (\\nu \\cdot \\frac{\\partial^2 w}{\\partial x^2} + \\frac{\\partial^2 w}{\\partial y^2}) \\\\\n",
        "m_{xy} &= D \\cdot \\frac{1-\\nu}{2} \\cdot \\kappa_{xy} &&= D \\cdot \\frac{1-\\nu}{2} \\cdot (-2 \\frac{\\partial^2 w}{\\partial x \\partial y}).\n",
        "\\end{align}\n",
        "$$ {#eq-momente-platte}\n",
        "\n",
        "Die Momente, resultierend aus den Normalspannungen, und die Drillmomente, resultierend aus den ebenen Schubspannungen, sind in @fig-biegemomente-platte und @fig-drillmomente-platte dargestellt.\n",
        "\n",
        "![Normalspannungen und resultierende Biegemomente](00-pics/Biegemoment.png){#fig-biegemomente-platte width=80%}\n",
        "\n",
        "![eben Schubspannungen und resultierende Drillmomente](00-pics/Drillmomente.png){#fig-drillmomente-platte width=80%}\n",
        "\n",
        "Um die Querkräfte zu berechnen werden im Normalfall die transversalen Schubspannungen über die Plattendicke $h$ integriert. Bei der Kirchhoffschen Plattentheorie ist dies nicht möglich, da, wie in @eq-schubverzerrung dargestellt, die Schubverzerrungen und somit die Schubspannungen, gemäß der getroffenen Annahmen, verschwinden. Die Querkräfte ergeben sich allein aus den Gleichgewichtsbedingungen (s. @sec-gleichgewicht) und lassen sich aus der dritten Ableitung der Verschiebung $w$ zu\n",
        "$$\n",
        "\\begin{align}\n",
        "q_{xx} &= D \\cdot (\\frac{\\partial^3 w}{\\partial x^3} + \\nu \\cdot \\frac{\\partial^3 w}{\\partial y^3}) \\\\\n",
        "q_{yy} &= D \\cdot (\\nu \\cdot \\frac{\\partial^3 w}{\\partial x^3} + \\frac{\\partial^3 w}{\\partial y^3}) \\\\\n",
        "\\end{align} \n",
        "$$ {#eq-querkraft-platte}\n",
        "\n",
        "berechnen. Die Darstellung der transversalen Schubspannungen und resultierenden Querkräften erfolgt in @fig-querkraefte-platte\n",
        "\n",
        "![transversale Schubspannungen und resultierende Querkräfte](00-pics/Querkraft.png){#fig-querkraefte-platte width=80%}\n",
        "\n",
        "### Gleichgewichtsbeziehungen & Plattengleichung {#sec-gleichgewicht}\n",
        "\n",
        "Betrachtet wird zunächst ein Schnittelement einer Platte mit den Abmessungen $\\Delta x$ und $\\Delta y$, welches durch eine senkrecht zur Mittelebene angreifende Flächenlast $p(x,y)$ belastet wird. In @fig-schnittgroessen sind die Schnittgrößen welche am positiven sowie am negativen Schnittufer des Elements angreifen dargestellt. \n",
        "<!-- Die Definitionen der Schnittgrößen sind in @tbl-schnittgroessen abgebildet. -->\n",
        "\n",
        "<!-- \n",
        "|        | Schnittufer $+$      |                 | Schnittufer $-$                                                       |\n",
        "|--------|----------------------|-----------------|-----------------------------------------------------------------------|\n",
        "|$M_x$   |$m_{xx}\\cdot \\Delta y$|$M_{x+\\Delta x}$ |$(m_{xx} + \\frac{\\partial m_{xx}}{\\partial x} \\cdot \\Delta x) \\Delta y$| \n",
        "|$M_y$   |$m_{yy}\\cdot \\Delta x$|$M_{y+\\Delta y}$ |$(m_{yy} + \\frac{\\partial m_{yy}}{\\partial y} \\cdot \\Delta y) \\Delta x$| \n",
        "|$M_{xy}$|$m_{xy}\\cdot \\Delta y$|$M_{xy+\\Delta x}$|$(m_{xy} + \\frac{\\partial m_{xy}}{\\partial x} \\cdot \\Delta x) \\Delta y$| \n",
        "|$M_{yx}$|$m_{yx}\\cdot \\Delta x$|$M_{yx+\\Delta y}$|$(m_{yx} + \\frac{\\partial m_{yx}}{\\partial y} \\cdot \\Delta y) \\Delta x$| \n",
        "|$Q_x$   |$q_{xx}\\cdot \\Delta y$|$Q_{x+\\Delta x}$ |$(q_{xx} + \\frac{\\partial q_{xx}}{\\partial x} \\cdot \\Delta x) \\Delta y$| \n",
        "|$Q_y$   |$q_{yy}\\cdot \\Delta x$|$Q_{y+\\Delta y}$ |$(q_{yy} + \\frac{\\partial q_{yy}}{\\partial y} \\cdot \\Delta y) \\Delta x$| \n",
        "\n",
        ": Schnittgrößen {#tbl-schnittgroessen} \n",
        "-->\n",
        "\n",
        "![Schnittgrößen](00-pics/Schnittgroessen.png){#fig-schnittgroessen width=100%}\n",
        "\n",
        "Bei der Grenzbetrachtung $\\Delta x \\to 0$ und $\\Delta y \\to 0$ ergeben sich die Gleichgewichtsbeziehungen\n",
        "$$     \n",
        "\\begin{align}\n",
        "\\frac{\\partial Q_{xx}}{\\partial x} + \\frac{\\partial Q_{yy}}{\\partial y} + q &= 0 \\\\\n",
        "\\frac{\\partial M_{xx}}{\\partial x} + \\frac{\\partial M_{xy}}{\\partial y} - Q_{xx} &= 0 \\\\\n",
        "\\frac{\\partial M_{yy}}{\\partial y} + \\frac{\\partial M_{xy}}{\\partial y} - Q_{yy} &= 0. \\\\\n",
        "\\end{align}\n",
        "$$ {#eq-gleichgewichtsbeziehungen}\n",
        "\n",
        "\n",
        "Durch das Einsetzen der in @eq-momente-platte definierten Momente $m_{xx}$, $m_{yy}$ und $m_{xy}$ in die Gleichgewichtsbeziehungen, sowie das Ersetzen der Ausdrücke $Q_{xx}$ und $Q_{yy}$ in der ersten Gleichgewichtsbeziehung (@eq-gleichgewichtsbeziehungen) durch die Momentenausdrücke der zweiten und dritten Gleichgewichtsbeziehung (@eq-gleichgewichtsbeziehungen), erhält man die Differentialgleichung aus @eq-randwertproblem. Dieses Randwertproblem wird auch als schwache Form des Problems bezeichnet.\n",
        "\n",
        "\n",
        "::: {.block fill=\"luma(230)\" inset=\"8pt\" radius=\"4pt\"}\n",
        "\n",
        "*Randwertproblem (D)* \\\n",
        "\n",
        "Gesucht ist die Funktion $w:\\Omega \\to \\mathbb{R}$ welche die Differentialgleichung\n",
        "$$\n",
        " D \\cdot [\\frac{\\partial^4 w}{\\partial x^4} + 2 \\cdot \\frac{\\partial^2 w}{\\partial x^2 \\partial y^2} + \\frac{\\partial^4 w}{\\partial y^4}] = q \n",
        "$${#eq-randwertproblem}\n",
        "\n",
        "erfüllt.\n",
        "\\\n",
        "\n",
        ":::\n",
        "\n",
        "Das Randwertproblem wird als Divergenz des Gradienten von $w$ wie folgt ausgedrückt:\n",
        "$$\n",
        "D \\cdot \\Delta \\Delta w(x,y) = q \n",
        "$$ {#eq-black-scholes}\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "{{< pagebreak >}}\n",
        "\n",
        "\n",
        "<!-- Kapitel 4 -->\n",
        "\n",
        "```{=typst}\n",
        "#set page(header: align(right, emph(text(size: 12pt)[Kapitel 4: Finite Elemente für schubstarre Platten])))\n",
        "```\n",
        "\n",
        "# Finite Elemente für schubstarre Platten {#sec-fem-plattentragwerke}\n",
        "\n",
        "Anknüpfend an das, in @sec-mech-math-grundlagen hergeleitete Randwertproblem, erfolgt in @sec-vorbereitung die Herleitung der schwachen Form für die Kirchhoff-Platte. Ziel ist es das Variationsproblem und die daraus resultierende Bilinearform und Linearform zu formulieren. Abgeleitet aus dem Variationsproblem wird in @sec-Steifigkeitsmatrix-BFS und @sec-Steifigkeitsmatrix-DKQ die globale Steifigkeitsmatrix für das Bogner-Fox-Schmit Element und das _Discrete Kirchhoff Quadrilateral_ Element hergeleitet. Die Formulierung der Steifigkeitsmatrizen der beiden Element bilden die Basis für die Implementierung in das in @sec-Umsetzung-Julia beschriebene Programm.\n",
        "\n",
        "## Vorbereitung {#sec-vorbereitung}\n",
        "\n",
        "### Herleitung der schwachen Form {#sec-schwache-form}\n",
        "\n",
        "Die Basis der Finite Element Methode bildet die schwache Form des Problems. Ausgehend von der Differentialgleichung der Kirchhoff-Platte, ausgedrückt durch den Laplace-Operator,\n",
        "\n",
        "$$\n",
        "D \\cdot \\Delta \\Delta w = q \n",
        "$$ {#eq-diffgl-laplace}\n",
        "\n",
        "<!-- \n",
        "$$\n",
        "\\Delta w = \\frac{\\partial^2 w}{\\partial x^2} + \\frac{\\partial^2 w}{\\partial y^2}\n",
        "$$ {#eq-diffgl-laplace} \n",
        "-->\n",
        "\n",
        "ergibt sich nach Multiplikation mit der Testfunktion $\\delta w : \\Omega \\to \\mathbb{R}$\n",
        "\n",
        "$$\n",
        "D \\cdot  (w_{,xxxx} \\cdot \\delta w \n",
        "+ 2 \\cdot w_{,xxyy} \\cdot \\delta w \n",
        "+ \\cdot w_{,yyyy}\\cdot \\delta w)\n",
        "=  q \\cdot \\delta w . \n",
        "$$ {#eq-diffgl-testfunk}\n",
        "\n",
        "Nach der Integration beider Seiten über die Fläche $\\Omega$ und durch Anwendung der Summenregel für Integrale folgt\n",
        "$$\n",
        "D \\cdot [ \\underbrace{\\int_{\\Omega} w_{,xxxx} \\cdot \\delta w \\quad d \\Omega}_{\\text{1. Summand}} + \\underbrace{\\int_{\\Omega} 2 \\cdot w_{,xxyy} \\cdot \\delta w \\quad d \\Omega}_{\\text{2. Summand}} + \\underbrace{\\int_{\\Omega} w_{,yyyy}\\cdot \\delta w \\quad d \\Omega}_{\\text{3. Summand}}] = \\int_{\\Omega} q \\cdot \\delta w \\quad d \\Omega.\n",
        "$$ {#eq-diffgl-testfunk-integral}\n",
        "\n",
        "Die drei Summanden auf der linken Seite der Gleichung werden zweifach partiell integriert. Zudem wird angenommen, dass alle Randterme, also Momente und Querkräfte an dem Rand des Gebiets $\\Omega$, $=0$. Dadurch ergeben sich die Teilergebnisse für \n",
        "\n",
        "$$\n",
        "\\begin{flalign}\n",
        "&\\text{den 1. Summanden} \\\\\n",
        "\\\\\n",
        "&\\int_{\\Omega} w_{,xxxx} \\cdot \\delta w \\quad d \\Omega\n",
        "&&=\n",
        "- \\int_{\\Omega} \\delta w_{,xx} \\cdot w_{,xx} \\quad d \\Omega \\\\\n",
        "\\\\\n",
        "\\\\\n",
        "&\\text{den 2. Summanden} \\\\\n",
        "\\\\\n",
        "&\\int_{\\Omega} 2 \\cdot w_{,xxyy} \\cdot \\delta w \\quad d \\Omega\n",
        "&&= \\int_{\\Omega} 2 \\cdot \\delta w_{,xy} \\cdot w_{,xy} \\quad d \\Omega \\\\\n",
        "\\\\\n",
        "\\\\\n",
        "&\\text{und den 3. Summanden} \\\\\n",
        "\\\\\n",
        "&\\int_{\\Omega} w_{,yyyy} \\cdot \\delta w \\quad d \\Omega\n",
        "&&=\n",
        "- \\int_{\\Omega} \\delta w_{,yy} \\cdot w_{,yy} \\quad d \\Omega\n",
        "\\end{flalign}\n",
        "$$\n",
        "\n",
        "\n",
        "Das Zusammenführen der Teilergebnisse ergibt das nachfolgend dargestellte Variationsproblem für die Kirchhoff-Platte.\n",
        "\n",
        "::: {.block fill=\"luma(230)\" inset=\"8pt\" radius=\"4pt\"}\n",
        "*Variationsproblem (V)* \\\n",
        "\n",
        "Gesucht ist die Funktion $w:\\Omega \\to \\mathbb{R}$, sodass\n",
        "\\\n",
        "\\\n",
        "$$\n",
        "\\begin{align}\n",
        "\\int_{\\Omega} D (w_{,xx} \\delta w_{,xx} + 2 w_{,xy} \\delta w_{,xy} + w_{,yy} \\delta w_{,yy} ) \\quad d \\Omega \n",
        "= \\int_{\\Omega} q \\cdot \\delta w \\quad d \\Omega\n",
        "\\end{align}\n",
        "$$ {#eq-variationsproblem}\n",
        "\n",
        "\\\n",
        "<!-- \n",
        "__Eigentlich RICHTIG__\n",
        "$$\n",
        "\\begin{align}\n",
        "\\int_{\\Omega}  D (1+\\nu) \\cdot (\\frac{\\partial^2 w}{\\partial x^2} \\cdot \\frac{\\partial^2 \\delta w}{\\partial x^2} + 2 \\cdot \\frac{\\partial w}{\\partial x \\partial y} \\cdot \\frac{\\partial \\delta w}{\\partial x \\partial y} + \\frac{\\partial^2 w}{\\partial y^2} \\cdot \\frac{\\partial^2 \\delta w}{\\partial y^2} \\quad d \\Omega) \\\\ \n",
        "= \\int_{\\Omega} q \\cdot \\delta w \\quad d \\Omega\n",
        "\\end{align}\n",
        "$$ {#eq-variationsproblem-2}\n",
        " -->\n",
        "für jede (fast) beliebige Testfunktion $\\delta w:\\Omega \\to \\mathbb{R}$.\n",
        "\n",
        ":::\n",
        "\n",
        "<!-- \n",
        "Das Variationsproblem lässt sich mit Hilfe von Funktionalen in eine generelle Form bringen. Die linke Seite der @eq-variationsproblem wird als Bilinearform $a:V \\times V \\to \\mathbb{R}$ und die rechte Seite als Linearform $b:V \\to \\mathbb{R}$ definiert.\n",
        "\n",
        "::: {.block fill=\"luma(230)\" inset=\"8pt\" radius=\"4pt\"}\n",
        "\n",
        "*Abstraktes Variationsproblem* \n",
        "\\\n",
        "\\\n",
        "Gesucht ist die Funktion $w \\in V$, sodass \n",
        "$$\n",
        "a(w, \\delta w)= b(\\delta w)\n",
        "$${#eq-abstraktes-variationsproblem}\n",
        "\n",
        "für alle Testfunktionen $\\delta w \\in V$\n",
        "\n",
        ":::\n",
        "\n",
        "Diese generelle Form des Problems wird für eine Vielzahl von Anwendungen genutzt.  \n",
        "-->\n",
        "\n",
        "Im Fall der Kirchhoff-Platte ist die Bilinearform \n",
        "\n",
        "$$ \n",
        "\\begin{align}\n",
        "&a(w, \\delta w) &&= \\int_{\\Omega} D (w_{,xx} \\delta w_{,xx} + 2 w_{,xy} \\delta w_{,xy} + w_{,yy} \\delta w_{,yy} ) \\quad d \\Omega \\\\\n",
        "\\end{align}\n",
        "$$ {#eq-bilinearform}\n",
        "\n",
        "und die Linearform\n",
        "\n",
        "$$ \n",
        "b(\\delta w) = \\int_{\\Omega} q \\cdot \\delta w \\quad d \\Omega.\n",
        "$$ {#eq-linearform}\n",
        "\n",
        "<!-- \n",
        "### Parametrisierung (Jacobi-Matrix)\n",
        "\n",
        "Analog zu Kapitel ... erfolgt die Abbildung der physikalischen Koordinaten $(x,y) \\in [(x_1,y_1),(x_2,y_2),(x_3,y_3),(x_4,y_4)]$, auf die Referenzkoordinaten $(\\xi,\\eta) \\text{ mit} -1 \\le \\xi,\\eta \\le 1$, durch Bestimmung der Bilinearform $\\hat{a}$ und  der Linearform $\\hat{b}$. Für die Platte ergibt sich somit aus dem Variationsproblem (@eq-variationsproblem) die Gleichung \n",
        "$$\n",
        "\\hat{a}(\\hat{w}, \\hat{\\delta w}) = \\hat{b}(\\hat{\\delta w})\n",
        "$${#eq-diffgl-referenzkoordinaten}\n",
        "\n",
        "Es ergeben sich die Bilinearform \n",
        "$$ \n",
        "\\begin{align}\n",
        "&\\hat{a}(\\hat{w}, \\hat{\\delta w})  \n",
        "= D \\int_{\\Omega}\n",
        "&&\\hat{w}_{,xx}(\\underline{F}^{-1}(x,y)) \\cdot \\hat{\\delta w}_{,xx}(\\underline{F}^{-1}(x,y)) \\\\\n",
        "&\\qquad &&+ 2 \\hat{w}_{,xy}(\\underline{F}^{-1}(x,y)) \\cdot \\hat{\\delta w}_{,xy}(\\underline{F}^{-1}(x,y)) \\\\\n",
        "\\\\\n",
        "&\\qquad &&+ \\hat{w}_{,yy}(\\underline{F}^{-1}(x,y)) \\cdot \\hat{\\delta w}_{,yy}(\\underline{F}^{-1}(x,y)) \n",
        "\\quad d \\Omega \\\\\n",
        "\\end{align} \n",
        "$$ {#eq-ahat}\n",
        "\n",
        "und die Linearform \n",
        "$$ \n",
        "\\begin{align}\n",
        "&\\hat{b}(\\hat{\\delta w})  \n",
        "= \\int_{\\Omega} q \\cdot \\delta w(\\underline{F}^{-1}(x,y)) \\quad d \\Omega\n",
        "\\end{align} \n",
        "$$ {#eq-bhat}\n",
        "\n",
        "Für die Parametrisierung werden die Variablen $\\beta^x$ und $\\beta^y$ als Rotation der Normalen, bezogen auf die unverformte Plattenebene, innerhalb der $x-z$-Ebene bzw. der $y-z$-Ebene mit \n",
        "$$\n",
        "\\beta^x(x,y) = \\theta_y (x,y) = - \\frac{\\partial w(x,y)}{\\partial x}\n",
        "\\qquad  \\text{und} \\qquad \n",
        "\\beta^y(x,y) = \\theta_x (x,y) = - \\frac{\\partial w(x,y)}{\\partial y}\n",
        "$$\n",
        "\n",
        "eingeführt. Mittels der Substitution von \n",
        "$$\n",
        "\\underline{F}^{-1}(x,y) = \n",
        "\\begin{cases} \n",
        "F_x^{-1}(x,y)\\quad & \\to \\quad \\xi(x,y) \\\\\n",
        "F_y^{-1}(x,y)\\quad & \\to \\quad \\eta(x,y)\n",
        "\\end{cases}\n",
        "$$\n",
        "\n",
        "und der Darstellung der Bilinearform als Matrix-Vektor Produkt resultiert\n",
        "$$\n",
        "\\hat{a}(\\hat{w}, \\hat{\\delta w})  \n",
        "= D \\int_{-1}^1 \\int_{-1}^1 [\\beta]^T [\\delta \\beta] \\quad d\\xi d\\eta\n",
        "$$\n",
        "\n",
        "mit den Vektoren \n",
        "$$\n",
        "\\underline{\\beta} = \n",
        "\\left[ \\begin{array}{center} \n",
        "\\beta^x_{,x} \\\\\n",
        "\\beta^y_{,y}\\\\\n",
        "\\beta^x_{,y}+\\beta^y_{,x}\n",
        "\\end{array}\\right] \n",
        "\\qquad \\qquad \\text{und} \\qquad \\qquad\n",
        "\\underline{\\delta\\beta} = \n",
        "\\left[ \\begin{array}{center} \n",
        "\\delta\\beta^x_{,x} \\\\\n",
        "\\delta\\beta^y_{,y}\\\\\n",
        "\\delta\\beta^x_{,y}+\\delta\\beta^y_{,x}\n",
        "\\end{array}\\right] .\n",
        "$$\n",
        "\n",
        "\n",
        "Entsprechend der Herleitung der Transformationsmatrix in Kapitel ... ergeben sich die Vektoren zu \n",
        "\n",
        "$$ \n",
        "\\begin{align}\n",
        "\\underline{\\beta} &= \n",
        "\\left[ \\begin{array}{center} \n",
        "j_{11} \\frac{\\partial \\beta^x(\\xi(x,y),\\eta(x,y))}{\\partial x} +\n",
        "j_{12} \\frac{\\partial \\beta^x(\\xi(x,y),\\eta(x,y))}{\\partial y} \\\\\n",
        "j_{21} \\frac{\\partial \\beta^y(\\xi(x,y),\\eta(x,y))}{\\partial x} +\n",
        "j_{22} \\frac{\\partial \\beta^y(\\xi(x,y),\\eta(x,y))}{\\partial y} \\\\\n",
        "j_{11} \\frac{\\partial \\beta^y(\\xi(x,y),\\eta(x,y))}{\\partial x} + \n",
        "j_{12} \\frac{\\partial \\beta^y(\\xi(x,y),\\eta(x,y))}{\\partial y} + \n",
        "j_{21} \\frac{\\partial \\beta^x(\\xi(x,y),\\eta(x,y))}{\\partial x} +\n",
        "j_{22} \\frac{\\partial \\beta^x(\\xi(x,y),\\eta(x,y))}{\\partial y}\n",
        "\\end{array}\\right] \\\\\n",
        "\\underline{\\delta\\beta} &= \n",
        "\\left[ \\begin{array}{center} \n",
        "j_{11} \\frac{\\partial \\delta\\beta^x(\\xi(x,y),\\eta(x,y))}{\\partial x} +\n",
        "j_{12} \\frac{\\partial \\delta\\beta^x(\\xi(x,y),\\eta(x,y))}{\\partial y} \\\\\n",
        "j_{21} \\frac{\\partial \\delta\\beta^y(\\xi(x,y),\\eta(x,y))}{\\partial x} +\n",
        "j_{22} \\frac{\\partial \\delta\\beta^y(\\xi(x,y),\\eta(x,y))}{\\partial y} \\\\\n",
        "j_{11} \\frac{\\partial \\delta\\beta^y(\\xi(x,y),\\eta(x,y))}{\\partial x} + \n",
        "j_{12} \\frac{\\partial \\delta\\beta^y(\\xi(x,y),\\eta(x,y))}{\\partial y} + \n",
        "j_{21} \\frac{\\partial \\delta\\beta^x(\\xi(x,y),\\eta(x,y))}{\\partial x} +\n",
        "j_{22} \\frac{\\partial \\delta\\beta^x(\\xi(x,y),\\eta(x,y))}{\\partial y}\n",
        "\\end{array}\\right] \n",
        "\\end{align}\n",
        "$$ {#eq-Beta}\n",
        "\n",
        "mit den Komponenten der inversen Transformationsmatrix definiert\n",
        "$$\n",
        "\\begin{align}\n",
        "j_{11} &= \\frac{\\partial F_x^{-1}(x,y)}{\\partial x} \\qquad\n",
        "j_{12} &= \\frac{\\partial F_y^{-1}(x,y)}{\\partial x} \\\\\n",
        "j_{21} &= \\frac{\\partial F_x^{-1}(x,y)}{\\partial y} \\qquad\n",
        "j_{22} &= \\frac{\\partial F_y^{-1}(x,y)}{\\partial y} \\\\\n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        "-----------------------------------------\n",
        "\n",
        "$$\n",
        "K u = r\n",
        "$$\n",
        "\n",
        "$$\n",
        "u^e = \n",
        "\\left[ \\begin{array}{center} \n",
        "w_1 \\\\\n",
        "\\theta_{x1} \\\\\n",
        "\\theta_{y1} \\\\\n",
        "w_2 \\\\\n",
        "\\theta_{x2} \\\\\n",
        "\\theta_{y2} \\\\\n",
        "w_3 \\\\\n",
        "\\theta_{x3} \\\\\n",
        "\\theta_{y3} \\\\\n",
        "w_4 \\\\\n",
        "\\theta_{x4} \\\\\n",
        "\\theta_{y4}\n",
        "\\end{array}\\right] \n",
        "=\n",
        "\\left[ \\begin{array}{center} \n",
        "w_1 \\\\\n",
        "\\frac{\\partial w_1}{\\partial y} \\\\\n",
        "-\\frac{\\partial w_1}{\\partial x} \\\\\n",
        "w_2 \\\\\n",
        "\\frac{\\partial w_2}{\\partial y} \\\\\n",
        "-\\frac{\\partial w_2}{\\partial x} \\\\\n",
        "w_3 \\\\\n",
        "\\frac{\\partial w_3}{\\partial y} \\\\\n",
        "-\\frac{\\partial w_3}{\\partial x} \\\\\n",
        "w_4 \\\\\n",
        "\\frac{\\partial w_4}{\\partial y} \\\\\n",
        "-\\frac{\\partial w_4}{\\partial x}\n",
        "\\end{array}\\right] \n",
        "$$\n",
        "\n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "w_{,xx} &= \\beta_{,x} &&= H^x_{,x} U_n \\\\\n",
        "w_{,yy} &= \\beta_{,y} &&= H^y_{,y} U_n \\\\\n",
        "w_{,xy} &= \\beta_{,x} + \\beta_{,y} &&= (H^x_{,y} + H^y_{,x}) U_n \\\\\n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        "$$ \n",
        "\\begin{align}\n",
        "K^e &= \\int_{\\Omega} [B]^T [D_b][B] d \\Omega \\\\\n",
        "&= \n",
        "\\left[ \\begin{array}{center} \n",
        "\\frac{\\partial H^x}{\\partial x} \\\\\n",
        "\\frac{\\partial H^y}{\\partial y} \\\\\n",
        "\\frac{\\partial H^x}{\\partial y}+\\frac{\\partial H^y}{\\partial x}\n",
        "\\end{array}\\right]\n",
        "\\end{align}\n",
        "$$ {#eq-bilinearform-ahat}\n",
        "\n",
        "$$ \n",
        "a(w, \\delta w) = \\int_{\\Omega} D \n",
        "\\left[ \\begin{array}{center} \n",
        "w_{,xx} &\n",
        "w_{,yy} &\n",
        "2w_{,xy}\n",
        "\\end{array}\\right]\n",
        "\\begin{bmatrix} D & D\\nu & 0 \\\\ D\\nu & D & 0 \\\\ 0 & 0 & D\\frac{1-\\nu}{2} \\end{bmatrix}\n",
        "\\left[ \\begin{array}{center} \n",
        "\\delta w_{,xx} \\\\\n",
        "\\delta w_{,yy} \\\\\n",
        "2\\delta w_{,xy}\n",
        "\\end{array}\\right]\n",
        "d \\Omega \n",
        "$$\n",
        "\n",
        "\n",
        "$$ \n",
        "\\begin{align}\n",
        "\\hat{a}(\\hat{w}, \\hat{\\delta w})  \n",
        "&= \\int_{\\Omega}  D\n",
        "\\left[ \\begin{array}{center} \n",
        "w_{,xx}(\\underline{F}^{-1}(x,y)) &\n",
        "w_{,yy}(\\underline{F}^{-1}(x,y)) &\n",
        "w_{,xy}(\\underline{F}^{-1}(x,y))\n",
        "\\end{array}\\right]\n",
        "\\left[ \\begin{array}{center} \n",
        "\\delta w_{,xx}(\\underline{F}^{-1}(x,y)) \\\\\n",
        "\\delta w_{,yy}(\\underline{F}^{-1}(x,y)) \\\\\n",
        "2 \\delta w_{,xy}(\\underline{F}^{-1}(x,y))\n",
        "\\end{array}\\right]\n",
        "d \\Omega \\\\\n",
        "\\end{align} \n",
        "$$ {#eq-black-scholes-04}\n",
        "\n",
        "\n",
        "--------------------------------------------\n",
        "Bilinearform $a:V \\times V \\to \\mathbb{R}$\n",
        "zur \"Referenz\"-Bilinearform $\\hat{a}: \\hat{V} \\times \\hat{V}  \\to \\mathbb{R}$\n",
        "\n",
        "$$\n",
        "\\hat{a}(\\hat{w}, \\hat{\\delta w}) = \\hat{a}(\\hat{w} \\circ \\underline{F}^{-1}(x,y), \\hat{\\delta w}\\circ \\underline{F}^{-1}(x,y))\n",
        "$$\n",
        "\n",
        "Linearform $b:V \\to \\mathbb{R}$\n",
        "zur \"Referenz\"-Linearform $\\hat{b}: \\hat{V} \\to \\mathbb{R}$\n",
        "\n",
        "$$\n",
        "\\hat{b}(\\hat{\\delta w}) = \\hat{b}(\\hat{\\delta w}\\circ \\underline{F}^{-1}(x,y))\n",
        "$$\n",
        "\n",
        "$$\n",
        "\\mathbf{K^e} = \\int_{\\Omega} [B]^T [D_b][B]\n",
        "$$\n",
        "\n",
        "-->\n",
        "\n",
        "\n",
        "## Assemblierung der globalen Steifigkeitsmatrix {#sec-assemblierung-steifigkeitsmatrix}\n",
        "\n",
        "Die Entwicklung des linearen Gleichungssystems für ein System aus mehreren Plattenelementen geschieht über die Assemblierung der zuvor hergeleiteten und für die einzelnen Elemente ausgewertete Bilinearformen, den Elementsteifigkeitsmatrizen.  \n",
        "\n",
        "### BFS-Rechteckelement {#sec-Steifigkeitsmatrix-BFS}\n",
        "\n",
        "Wie in @sec-FE-BFS bereits beschrieben, hat das konforme Rechteckelement vier Knoten und an jedem Knoten vier Freiheitsgrade, sodass der Knotenverschiebungsvektor eines Elements\n",
        "\n",
        "$$\n",
        "\\mathbf{\\hat{w}^e}= \\left[ \\begin{array}{center} \n",
        "w_1 & \\theta_{x1} & \\theta_{y1} & \\theta_{xy1} &\n",
        "w_2 & \\theta_{x2} & \\theta_{y2} & \\theta_{xy2} &\n",
        "w_3 & \\theta_{x3} & \\theta_{y3} & \\theta_{xy3} &\n",
        "w_4 & \\theta_{x4} & \\theta_{y4} & \\theta_{xy4}\n",
        "\\end{array}\\right]^T\n",
        "$${#eq-knotenverschiebungsvekor-BFS}\n",
        "\n",
        "ist. Für die Herleitung der globalen Steifigkeitsmatrix mit dem Elementansatz des Bogner-Fox-Schmit Rechteckelements wird das abstrakte, diskrete Variationsproblem, durch das Skalarprodukt von Momentenvektor\n",
        "\n",
        "$$\n",
        "\\mathbf{m} = \n",
        "\\left[ \\begin{array}{center} \n",
        "m_{xx} \\\\\n",
        "m_{yy} \\\\\n",
        "m_{xy}\n",
        "\\end{array}\\right]\n",
        "\\qquad \\qquad \\text{und Krümmungsvektor} \\qquad \\qquad\n",
        "\\mathbf{\\kappa} =\n",
        "\\left[ \\begin{array}{center} \n",
        "\\kappa_{xx} \\\\\n",
        "\\kappa_{yy} \\\\\n",
        "2\\kappa_{xy}\n",
        "\\end{array}\\right]\n",
        "$$\n",
        "\n",
        "ausgedrückt. Das Ergebnis ist die Formulierung \n",
        "$$ \n",
        "a(w, \\delta w) \n",
        "= \\int_{\\Omega} \\mathbf{m} \\cdot \\mathbf{\\kappa} d \\Omega \n",
        "= \\int_{\\Omega} (m_{xx} \\kappa_{xx} + 2 m_{xy} \\kappa_{xy} + m_{yy} \\kappa_{yy} ) d \\Omega. \n",
        "$$ {#eq-bilinearform-Skalarprodukt-m-kappa}\n",
        "\n",
        "für die Bilinearform. Der Krümmungsvektor kann gemäß @eq-kruemmung durch die zweiten Ableitungen der Verschiebung $w_h$ bzw. durch die ersten Ableitungen der Verdrehungen $\\theta_{xh}$ und $\\theta_{yh}$ ausgedrückt werden. Bezogen auf ein Element ergibt sich, durch die Linearkombination für $w_h$ (@eq-linearkombination-platte) und den Knotenverschiebungsvektor $\\mathbf{\\hat{w}^e}$ (@eq-knotenverschiebungsvekor-BFS), die Formulierung des Krümmungsvektors für das Element $i$  \n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "\\mathbf{\\kappa_i} = \n",
        "% \\left[ \\begin{array}{center} \n",
        "% \\frac{\\partial \\sum N_i^e \\theta_{xi}}{\\partial x} \\\\\n",
        "% \\frac{\\partial \\sum N_i^e \\theta_{yi}}{\\partial y} \\\\\n",
        "% \\frac{\\partial \\sum N_i^e \\theta_{xi}}{\\partial y} \n",
        "% + \\frac{\\partial \\sum N_i^e \\theta_{yi}}{\\partial x} \\\\\n",
        "% \\end{array}\\right] \n",
        "% = \n",
        "\\mathbf{B_b} \\mathbf{\\hat{w}^e}\n",
        "\\end{align}\n",
        "$$ {#eq-kruemmungsvekor-mit-B-Matrix}\n",
        "\n",
        "mit der B-Matrix\n",
        "$$\n",
        "\\mathbf{B_b} = \n",
        "\\begin{bmatrix} \n",
        "0 & \\frac{\\partial \\varphi_1}{\\partial x} & 0 & 0 & \n",
        "0 & \\frac{\\partial \\varphi_2}{\\partial x} & 0 & 0 & \n",
        "0 & \\frac{\\partial \\varphi_3}{\\partial x} & 0 & 0 & \\cdots &\n",
        "0 & \\frac{\\partial \\varphi_16}{\\partial x} & 0 & 0 \\\\\n",
        "0 & 0 & \\frac{\\partial \\varphi_1}{\\partial y} & 0 & \n",
        "0 & 0 & \\frac{\\partial \\varphi_2}{\\partial y} & 0 & \n",
        "0 & 0 & \\frac{\\partial \\varphi_3}{\\partial y} & 0 & \\cdots &\n",
        "0 & 0 & \\frac{\\partial \\varphi_16}{\\partial y} & 0 \\\\\n",
        "0 & \\frac{\\partial \\varphi_1}{\\partial y} & \\frac{\\partial \\varphi_1}{\\partial x} & 0 & \n",
        "0 & \\frac{\\partial \\varphi_2}{\\partial y} & \\frac{\\partial \\varphi_2}{\\partial x} & 0 & \n",
        "0 & \\frac{\\partial \\varphi_3}{\\partial y} & \\frac{\\partial \\varphi_3}{\\partial x} & 0 & \\cdots &\n",
        "0 & \\frac{\\partial \\varphi_16}{\\partial y} & \\frac{\\partial \\varphi_16}{\\partial x}  & 0  \\\\\n",
        "\\end{bmatrix}.\n",
        "$$\n",
        "\n",
        "<!-- wobei $n_n$ die Anzahl der Elementknoten und folglich auch die Anzahl der Formfunktionen angibt. -->\n",
        "Der Momentenvektor kann dementsprechend durch \n",
        "\n",
        "$$\n",
        "\\mathbf{m_i} = \n",
        "\\mathbf{D_b}\n",
        "\\mathbf{\\kappa_i}\n",
        "% \\left[ \\begin{array}{center} \n",
        "% \\kappa_{xx} \\\\\n",
        "% \\kappa_{yy} \\\\\n",
        "% \\kappa_{xy}\n",
        "% \\end{array}\\right]\n",
        "=\n",
        "\\mathbf{D_b} \\mathbf{B_b} \\mathbf{\\hat{w}^e}\n",
        "$$ {#eq-momentenvekor-mit-B-Matrix}\n",
        "\n",
        "mit\n",
        "$$\n",
        "\\mathbf{D_b} = D \\begin{bmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{bmatrix}\n",
        "$$\n",
        "\n",
        "beschrieben werden, mit der isotropen Plattensteifigkeit $D$ (s. @eq-plattensteifigkeit).\n",
        "Mit den Formulierungen aus @eq-kruemmungsvekor-mit-B-Matrix und @eq-momentenvekor-mit-B-Matrix, eingesetzt in @eq-bilinearform-Skalarprodukt-m-kappa, ergibt sich die elementweise Formulierung der Bilinearform zu \n",
        "$$ \n",
        "\\begin{align}\n",
        "a(w^e, \\delta w^e) \n",
        "% &=  \\int_{\\Omega} \\mathbf{m} \\cdot \\mathbf{\\kappa} \\quad d \\Omega \\\\\n",
        "% &=  \\int_{\\Omega} \\mathbf{m}^T \\mathbf{\\kappa} \\quad d \\Omega \\\\\n",
        "% &=  \\int_{\\Omega} (\\mathbf{D_b}\\mathbf{\\kappa})^T \\mathbf{\\kappa} \\quad d \\Omega \\\\\n",
        "% &=  \\int_{\\Omega} \\mathbf{\\kappa}^T \\mathbf{D_b} \\mathbf{\\kappa} \\quad d \\Omega \\\\\n",
        "% &=  \\int_{\\Omega}  (\\mathbf{B_b} \\underline{u^e})^T \\mathbf{D_b}  (\\mathbf{B_b} \\underline{u^e})  \\quad d \\Omega \\\\\n",
        "&=  \\int_{\\Omega}  \\mathbf{B_b}^T \\mathbf{D_b} \\mathbf{B_b} \\mathbf{\\hat{w}^e} \\quad d \\Omega \\\\\n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        "Diese Formulierung wird in der Literatur im Regelfall durch die Elementsteifigkeitsmatrix\n",
        "\n",
        "$$ \n",
        "\\mathbf{k_{ij}^e} = a(\\varphi^e_j, \\varphi^e_i)\n",
        "= \\int_{\\Omega^e} \\mathbf{B}_b^T \\mathbf{D_b} \\mathbf{B}_b d\\Omega\n",
        "$$ {#eq-elementsteifigkeitsmatrix}\n",
        "\n",
        "ausgedrückt.\n",
        "\n",
        "<!-- \n",
        "----------\n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "a(w,\\delta w) = \\int_{\\Omega} D (w_{,xx} \\delta w_{,xx} + 2 w_{,xy} \\delta w_{,xy} + w_{,yy} \\delta w_{,yy} ) \\quad d \\Omega \\\\\n",
        "\\rightsquigarrow \\mathbf{k_{ij}} = a(\\varphi_j, \\varphi_i) = \\int_{\\Omega} D (\\varphi_{j_{,xx}} \\varphi_{i_{,xx}} + 2 \\varphi_{j_{,xy}} \\varphi_{i_{,xy}} + \\varphi_{j_{,yy}} \\varphi_{i_{,yy}} ) \n",
        "\\end{align}\n",
        "$$ \n",
        "-->\n",
        "\n",
        "### DKQ Element {#sec-Steifigkeitsmatrix-DKQ}\n",
        "\n",
        "Gitter, die bei der FE-Methode generiert werden, sind üblicherweise nicht gleichmäßig. Die Elemente haben nicht immer dieselebe Größe und Form, weshalb eine Lösung für die Berechnung von allgemeinen Viercken notwendig ist. Die in diesem Kapitel gemachten Formulierungen für ein isoparametrisches Element basieren auf dem von Jean-Louis Batoz und Mabrouk Ben Tahars veröffentlichtem Paper \"Evaluation of a new quadrilateral thin plate bending element\" aus dem Jahr 1981. Das vorgestellte Element ist ein Vierknotenelement mit je 3 Freiheitsgraden je Ecke. Die Geometrie ist in @fig-geometrie-DKQ dargestellt.\n",
        "\n",
        "![Geometrie des DKQ-Elements](00-pics/Geometrie-BTP.png){#fig-geometrie-DKQ fig-env=\"figure*\" width=60%}\n",
        "\n",
        "Dieses sogenannte DKQ (_Discrete Kirchhoff Quadrilateral_) Element basiert auf den folgenden Annahmen: \n",
        "\n",
        "1. Die Verdrehungen $\\beta_x$ um die $y$-Achse und $\\beta_y$ um die $x$-Achse sind als Ableitungen der Linearkombination aus @eq-linearkombination-platte zu verstehen.\n",
        "$$\n",
        "\\begin{align}\n",
        "&\\beta_x &\\quad= - w,_x &\\quad= \\theta_y &\\quad= \\frac{\\partial \\sum_{i=1}^8 \\varphi_i(x,y) \\cdot \\hat{w}_i}{\\partial x} \\\\\n",
        "&\\beta_y &\\quad= - w,_y &\\quad= - \\theta_x &\\quad= \\frac{\\partial \\sum_{i=1}^8 \\varphi_i(x,y) \\cdot \\hat{w}_i}{\\partial x} \\\\\n",
        "\\end{align}\n",
        "$$ {#eq-betaX-betaY}\n",
        "Als Formfunktionen $\\varphi_i(x,y)$ dienen die Funktionen des in @sec-basis-funktionen vorgestellten Serendipity-Elements, abhängig von den Variablen $\\xi$ und $\\eta$. Die Freiheitsgrade des Serendipity-Elements sind die Verformungen $\\hat{w}_i$ mit $i = 1,...,8$, wobei $i$ die Nummer des Knotens nach @fig-geometrie-DKQ angibt.\n",
        "\n",
        "2. Entsprechend der Kirchhoff Theorie sind die Verdrehungen an den \n",
        "a) Eckknoten $i$\n",
        "$$\n",
        "\\begin{align}\n",
        "&\\beta_x_i = - w,_x_i \\\\\n",
        "&\\beta_y_i = - w,_y_i \\qquad \\text{mit} i = 1,2,3,4,\n",
        "\\end{align}\n",
        "$$ {#eq-verdrehungen-beta-i}\n",
        "(Ableitungen der Verformung $w$ nach $x$ und nach $y$ an den Knoten $i$) und an den \n",
        "b) Mittelknoten $k$\n",
        "$$\n",
        "\\begin{align}\n",
        "&\\beta_s_k = - w,_s_k \\\\\n",
        "&\\beta_n_k = - w,_n_k \\qquad \\text{mit} k = 5,6,7,8,\n",
        "\\end{align}\n",
        "$$ {#eq-verdrehungen-beta-k}\n",
        "(Ableitungen der Verformung $w$ nach $s$ und nach $n$ an den Knoten $k$) wobei $s$ die Koordinate entlang der Elementseite ist und $n$ die senkrechte Achse zur $s$-Achse. (s. @fig-geometrie-DKQ)\n",
        "\n",
        "3. $\\beta_s$ ist die Verdrehung um die $n$-Achse. Nach Batoz und Tahar wird, zur Bestimmung von $\\beta_s$ an dem Knoten $k$, die Verformung $w$ entlang der Elementkanten als kubische Funktion ausgedrückt. Zur Bestimmung der Funktion dritten Grades wird die allgemeine Form\n",
        "$$\n",
        "w(s) = a s^3 + bs^2 +cs +d\n",
        "$$\n",
        "mit den Randbedingungen\n",
        "$$\n",
        "\\begin{align}\n",
        "&w(s_i) = w_i   &&\\qquad w'(s_i) = w,_{si} \\\\\n",
        "&w(s_j) = w_j   &&\\qquad w'(s_j) = w,_{sj}\n",
        "\\end{align}\n",
        "$$\n",
        "gelöst. Für die Verdrehung um die n-Achse ergibt sich\n",
        "$$\n",
        "w,_{sk} = w'(0) = \\frac{-3}{l_{ij}} (w_i - w_j) - \\frac{1}{4}(w,_{si}+w,_{sj})\n",
        "$$ {#eq-verdrehungen-beta-x-Formel}\n",
        "wobei $k = 5,6,7,8$ die Mittelknoten der Elementkanten $ij = 12,23,34,41$ sind. $l_{ij}$ ist die Länge der Seiten $ij$.\n",
        "\n",
        "4. $\\beta_n$ ist die Verdrehung um die $s$-Achse und wird entlang der Elementkanten durch eine lineare Funktion \n",
        "$$\n",
        "w'(s) = ax+b\n",
        "$$\n",
        "mit den Randbedingungen  \n",
        "$$\n",
        "\\begin{align}\n",
        "w'(s_i) = w,_{ni}   &&\\qquad w'(s_j) = w,_{nj}\n",
        "\\end{align}\n",
        "$$\n",
        "ausgedrückt. Es ergibt sich somit\n",
        "$$\n",
        "w,_n_k = w'(0) = -\\frac{1}{2}(w,_{ni}+w,_{nj})\n",
        "$$\n",
        "\n",
        "{{< pagebreak >}}\n",
        "\n",
        "::: {.block fill=\"luma(230)\" inset=\"8pt\" radius=\"4pt\"}\n",
        "Zusammengefasst sind die Verdrehungen der Knoten  \n",
        "$$\n",
        "\\begin{align}\n",
        "&\\qquad\\qquad\\qquad\\beta_x_i = - w,_x_i \\\\\n",
        "&\\qquad\\qquad\\qquad\\beta_y_i = - w,_y_i\n",
        "&&\\text{mit} i = 1,2,3,4 \\\\\n",
        "&\\qquad\\qquad\\qquad\\beta_s_k = - w,_s_k = \\frac{-3}{l_{ij}} (w_i - w_j) - \\frac{1}{4}(w,_{si}+w,_{sj}) \\\\\n",
        "&\\qquad\\qquad\\qquad\\beta_n_k = - w,_n_k = -\\frac{1}{2}(w,_{ni}+w,_{nj})\n",
        "&&\\text{mit} k = 5,6,7,8 \n",
        "\\end{align}\n",
        "$$ {#eq-verdrehungen-beta}\n",
        "\n",
        ":::\n",
        "\n",
        "Die Formeln für die Verdrehungen an den Eckknoten um die $x$-Achse und die $y$-Achse und für die Verdrehungen an den Mittelknoten um die $s$-Achse und die $n$-Achse sind gegeben. Da bei isoparametrischen Elementen die Elementkanten nicht parallel zu den Koordinatenachsen verlaufen ist eine Umrechnung der Verdrehung der Mittelknoten, auf die Verdrehung um die $x$- und $y$-Achse notwendig. \n",
        "\n",
        "Nach geometrischer Umrechnung der Verdrehung an den Mittelknoten, von $w,_s_k$ und $w,_n_k$ zu \n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "&w,_x_k = -cos(\\gamma_k) \\cdot w,_n_k + sin(\\gamma_k) \\cdot w,_s_k  \\qquad \\qquad \\text{und}\\\\\n",
        "&w,_y_k = -sin(\\gamma_k) \\cdot w,_n_k - cos(\\gamma_k) \\cdot w,_s_k \\qquad \\qquad \\text{mit}\\gamma_k = \\gamma_{ij} \\\\\n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        "wird die Linearkombination aus @eq-betaX-betaY aufgeteilt in Eck- und Mittelknoten mit\n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "&\\beta_x =  -\\sum_{i=1}^4 \\varphi_i(x,y) \\cdot w,_x_i \n",
        "            -\\sum_{k=5}^8 \\varphi_i(x,y) \\cdot w,_x_k \\\\\n",
        "&\\beta_y =  -\\sum_{i=1}^4 \\varphi_i(x,y) \\cdot w,_y_i \n",
        "            -\\sum_{k=5}^8 \\varphi_i(x,y) \\cdot w,_y_k \\\\\n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        "und Einsetzen der Vereinbarungen aus @eq-verdrehungen-beta berechnet. Es ergibt sich durch Extrahieren des Knotenverschiebungsvektors\n",
        "\n",
        "$$\n",
        "\\mathbf{\\hat{w}^e}= \\left[ \\begin{array}{center} \n",
        "w_1 & \\theta_{x1} & \\theta_{y1} &\n",
        "w_2 & \\theta_{x2} & \\theta_{y2} &\n",
        "w_3 & \\theta_{x3} & \\theta_{y3} &\n",
        "w_4 & \\theta_{x4} & \\theta_{y4} \n",
        "\\end{array}\\right]^T\n",
        "$${#eq-knotenverschiebungsvekor-DKQ}\n",
        "\n",
        "die Formulierung \n",
        "$$\n",
        "\\begin{align}\n",
        "&\\beta_x = \n",
        "\\left[ \\begin{array}{center} \n",
        "H^x_1 & H^x_2 & H^x_3 & H^x_4 & H^x_5 & H^x_6 & H^x_7 & H^x_8 & H^x_9 & H^x_{10} & H^x_{11} & H^x_{12} \n",
        "\\end{array}\\right] \n",
        "\\mathbf{\\hat{w}^e}  \\\\\n",
        "&\\beta_y =\n",
        "\\left[ \\begin{array}{center} \n",
        "H^y_1 & H^y_2 & H^y_3 & H^y_4 & H^y_5 & H^y_6 & H^y_7 & H^y_8 & H^y_9 & H^y_{10} & H^y_{11} & H^y_{12} \n",
        "\\end{array}\\right]\n",
        "\\mathbf{\\hat{w}^e}\n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        "mit \n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "H_1^x &= \\frac{3}{2} (\\varphi_5 a_5 - \\varphi_8 a_8)    &\\qquad \\qquad H_1^y &=\\frac{3}{2} (\\varphi_5 d_5 - \\varphi_8 d_8) \\\\\n",
        "H_2^x &= \\varphi_5 b_5 + \\varphi_8 b_8                  &\\qquad \\qquad H_2^y &= -\\varphi_1 + \\varphi_5 e_5 + \\varphi_8 e_8\\\\\n",
        "H_3^x &= \\varphi_1 - \\varphi_5 c_5 - \\varphi_8 c_8            &\\qquad \\qquad H_3^y &= -\\varphi_5 b_5 - \\varphi_8 b_8 \\\\\n",
        "H_4^x &= \\frac{3}{2} (\\varphi_6 a_6 - \\varphi_5 a_5)    &\\qquad \\qquad H_4^y &= \\frac{3}{2}(\\varphi_6 d_6 - \\varphi_5 d_5) \\\\\n",
        "H_5^x &= \\varphi_6 b_6 + \\varphi_5 b_5                  &\\qquad \\qquad H_5^y &= -\\varphi_2 + \\varphi_6 e_6 + \\varphi_5 e_5\\\\\n",
        "H_6^x &= \\varphi_2 - \\varphi_6 c_6 - \\varphi_5 c_5            &\\qquad \\qquad H_6^y &= -\\varphi_6 b_6 - \\varphi_5 b_5\\\\\n",
        "H_7^x &= \\frac{3}{2} (\\varphi_7 a_7 - \\varphi_6 a_6)    &\\qquad \\qquad H_7^y &= \\frac{3}{2} (\\varphi_7 d_7 - \\varphi_6 d_6) \\\\\n",
        "H_8^x &= \\varphi_7 b_7 + \\varphi_6 b_6                  &\\qquad \\qquad H_8^y &= -\\varphi_3 + \\varphi_7 e_7 + \\varphi_6 e_6 \\\\\n",
        "H_9^x &= \\varphi_3 - \\varphi_7 c_7 - \\varphi_6 c_6            &\\qquad \\qquad H_9^y &= -\\varphi_7 b_7 - \\varphi_6 b_6 \\\\\n",
        "H_10^x &= \\frac{3}{2} (\\varphi_8 a_8 - \\varphi_7 a_7)   &\\qquad \\qquad H_10^y &= \\frac{3}{2} (\\varphi_8 d_8 - \\varphi_7 d_7) \\\\\n",
        "H_11^x &= \\varphi_8 b_8 + \\varphi_7 b_7                 &\\qquad \\qquad H_11^y &= -\\varphi_4 + \\varphi_8 e_8 + \\varphi_7 e_7 \\\\\n",
        "H_12^x &= \\varphi_4 - \\varphi_8 c_8 - \\varphi_7 c_7           &\\qquad \\qquad H_12^y &= -\\varphi_8 b_8 - \\varphi_7 b_7 \n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        "und\n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "&a_k = \\frac{-sin(\\gamma_{ij})}{l_{ij}} \n",
        "&&\\qquad \\qquad d_k = \\frac{cos(\\gamma_{ij})}{l_{ij}}\\\\\n",
        "&b_k = - \\frac{3}{4} cos(\\gamma_{ij}) sin(\\gamma_{ij}) \\\\\n",
        "&c_k = - \\frac{1}{2} cos(\\gamma_{ij})^2 - \\frac{1}{4} sin(\\gamma_{ij})^2 \n",
        "&&\\qquad \\qquad e_k = -\\frac{1}{2} sin(\\gamma_{ij})^2 + \\frac{1}{4} cos(\\gamma_{ij})^2 \\\\\n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        "Ausgehen von der Formulierung aus @eq-bilinearform-Skalarprodukt-m-kappa und der Berechnung des Krümmungsvektors entsprechend @eq-kruemmungsvekor-mit-B-Matrix, ergibt sich die B-Matrix für das isoparametrische Element zu\n",
        "\n",
        "$$\n",
        "\\mathbf{B_b} = \n",
        "\\begin{bmatrix} \n",
        "\\frac{\\partial H_1^x}{\\partial x} & \\frac{\\partial H_2^x}{\\partial x} & \\cdots & \\frac{\\partial H_{12}^x}{\\partial x} \\\\\n",
        "\\frac{\\partial H_1^y}{\\partial y} & \\frac{\\partial H_2^y}{\\partial y} & \\cdots & \\frac{\\partial H_{12}^y}{\\partial y}\\\\\n",
        "\\frac{\\partial H_1^x}{\\partial y} + \\frac{\\partial H_1^y}{\\partial x} & \n",
        "\\frac{\\partial H_2^x}{\\partial y} + \\frac{\\partial H_2^y}{\\partial x} & \\cdots &\n",
        "\\frac{\\partial H_{12}^x}{\\partial y} + \\frac{\\partial H_{12}^y}{\\partial x} \\\\\n",
        "\\end{bmatrix}.\n",
        "$$ {#eq-B-Matrix-DQT}\n",
        "\n",
        "Die Formulierung der Elementsteifigkeitsmatrizen stimmt mit der Formulierung für das BFS-Element aus @eq-elementsteifigkeitsmatrix überein.\n",
        "\n",
        "{{< pagebreak >}}\n",
        "\n",
        "### Parametrisierung DKQ {#sec-Parametrisierung}\n",
        "\n",
        "Die in dem vorangehenden Kapitel hergeleitete Formulierung für allgemeine Vierecke bezieht sich auf das Referenzkoordinatensystem mit $\\xi$ - und $\\eta$-Achse, da die verwendeten Formfunktionen in diesem System definiert sind. Nach @eq-B-Matrix-DQT wird eine Ableitung der H-Funktionen nach $x$ und $y$ gefordert. Um eine Berechnung von allgemeinen Finite-Elemente-Gittern zu ermöglichen, muss also die Umrechnung der Referenzkoordinaten $\\xi$ und $\\eta$ zu den physikalischen Koordinaten $x$ und $y$, und andersherum, hergeleitet werden. Ziel ist die Projektion des physikalischen Elements \n",
        "$$\n",
        "\\Omega_e := \\{ (x,y) \\in \\mathbb{R}^2 \\}\n",
        "$$\n",
        "\n",
        "auf das Referenzelement \n",
        "$$\n",
        "\\hat{\\Omega}_e := \\{ (\\xi,\\eta) \\in \\mathbb{R}^2 | -1 \\le \\xi,\\eta \\le 1 \\}.\n",
        "$$\n",
        "\n",
        "wie in @fig-parametrisierung dargestellt.\n",
        "\n",
        "![Abbildung des Raums $\\hat{\\Omega}$ auf $\\Omega$](00-pics/Parametrisierung.png){#fig-parametrisierung width=90%}\n",
        "\n",
        "Sei $(\\xi,\\eta)$ ein beliebiger Punkt auf dem Referenzelement, so werden durch\n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "\\mathbf{F}(\\xi,\\eta) =  \n",
        "\\left[ \\begin{array}{center} \n",
        "x(\\xi,\\eta) \\\\\n",
        "y(\\xi,\\eta) \\\\\n",
        "\\end{array}\\right]\n",
        "=\n",
        "\\left[ \\begin{array}{center} \n",
        "F_{x}(\\xi,\\eta) \\\\\n",
        "F_{y}(\\xi,\\eta) \\\\\n",
        "\\end{array}\\right]\n",
        "= \n",
        "\\left[ \\begin{array}{center} \n",
        "\\sum_{i=1}^n N_i(\\xi,\\eta) \\cdot x_i  \\\\\n",
        "\\sum_{i=1}^n N_i(\\xi,\\eta) \\cdot y_i \\\\\n",
        "\\end{array}\\right]\n",
        "\\end{align}\n",
        "$$ {#eq-black-scholes-01}\n",
        "\n",
        "die physikalischen Koordinaten auf dem Element $\\Omega$ beschrieben. \n",
        "Die vier linearen Formfunktionen entsprechenen den in @sec-FE-Lagrange besprochenen Funktionen des bilinearen Elements, dargestellt in  @fig-Lagrange-Formfunktionen und beschrieben durch @eq-formfunktionen-bilinear. Um die physikalischen Koordinaten $(x,y)$ zu den Referenzkoordinaten $(\\xi,\\eta)$ umzurechnen, ist das Umkehren der Funktionen $F_{x}(\\xi,\\eta)$ und $F_{y}(\\xi,\\eta)$ zu\n",
        "$$\n",
        "\\begin{align}\n",
        "\\mathbf{{F}^{-1}}(x,y) =  \n",
        "\\left[ \\begin{array}{center} \n",
        "\\xi(x,y) \\\\\n",
        "\\eta(x,y) \\\\\n",
        "\\end{array}\\right]\n",
        "=\n",
        "\\left[ \\begin{array}{center} \n",
        "F_{x}^{-1}(x,y) \\\\\n",
        "F_{y}^{-1}(x,y) \\\\\n",
        "\\end{array}\\right]\n",
        "\\end{align}\n",
        "$$ {#eq-f-1}\n",
        "\n",
        "notwendig. Ziel der Parametrisierung ist die Umrechnung beliebiger Formfunktionen. Seien $N_i(\\xi,\\eta)$ die Formfunktionen definiert auf dem Referenzelement, so sind\n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "&\\varphi_I(x,y)  = N_i(\\xi(x,y),\\eta(x,y)), \\\\\n",
        "\\end{align}\n",
        "$$ {#eq-phi-I}\n",
        "\n",
        "die Formfunktionen defniert auf dem physikalischen Element, wobei $i$ und $I$ je nach Elementansatz variieren. Zur Berechnung der Elementsteifigkeitsmatrix, werden die Ableitungen\n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "\\varphi_{I,_x}(x,y) = \n",
        "\\left[ \\begin{array}{center}    \n",
        "F_{x,_x}^{-1}(x,y) &\n",
        "F_{y,_x}^{-1}(x,y)\n",
        "\\end{array}\\right]\n",
        "\\left[ \\begin{array}{center} \n",
        "N_{i,_\\xi}(F_{x}^{-1}(x,y),F_{y}^{-1}(x,y)) \\\\\n",
        "N_{i,_\\eta}(F_{x}^{-1}(x,y),F_{y}^{-1}(x,y))\n",
        "\\end{array}\\right] \n",
        "\\end{align}\n",
        "$$ {#eq-phi-I-Ableitung-x}\n",
        "$$\n",
        "\\begin{align}\n",
        "\\varphi_{I,_y}(x,y) = \n",
        "\\left[ \\begin{array}{center}    \n",
        "F_{x,_y}^{-1}(x,y) &\n",
        "F_{y,_y}^{-1}(x,y)\n",
        "\\end{array}\\right]\n",
        "\\left[ \\begin{array}{center} \n",
        "N_{i,_\\xi}(F_{x}^{-1}(x,y),F_{y}^{-1}(x,y)) \\\\\n",
        "N_{i,_\\eta}(F_{x}^{-1}(x,y),F_{y}^{-1}(x,y))\n",
        "\\end{array}\\right] \n",
        "\\end{align}\n",
        "$$ {#eq-phi-I-Ableitung-y}\n",
        "\n",
        "benötigt, die mithilfe der Kettenregel zusammengefasst und durch die Formulierung aus @eq-f-1 vereinfacht zum Matrix-Vektor-Produkt\n",
        "$$ \n",
        "\\left[ \\begin{array}{center} \n",
        "\\varphi_{I,_x}(x,y) \\\\\n",
        "\\varphi_{I,_y}(x,y)\n",
        "\\end{array}\\right]\n",
        "= \n",
        "\\underbrace{\\left[ \\begin{array}{center} \n",
        "\\xi_{,_x}(x,y) & \\eta_{,_x}(x,y) \\\\\n",
        "\\xi_{,_y}(x,y) & \\eta_{,_y}(x,y) \n",
        "\\end{array}\\right]}_{\\mathbf{J}_{F^-1}}\n",
        "\\left[ \\begin{array}{center} \n",
        "N_{i,_\\xi}(\\xi(x,y),\\eta(x,y)) \\\\\n",
        "N_{i,_\\eta}(\\xi(x,y),\\eta(x,y))\n",
        "\\end{array}\\right].\n",
        "$$ {#eq-Ableitung-phi-I-gesamt}\n",
        "\n",
        "zusammengefasst werden. Der Ausdruck\n",
        "$$\n",
        "\\nabla \\varphi_I = \\mathbf{J}_{F^{-1}} \\cdot \\nabla N_i\n",
        "$$ {#eq-Ableitung-phi-I-Nabla}\n",
        "\n",
        "ergibt sich durch eine weitere Vereinfachung mit Hilfe des Nabla-Operators.\n",
        "\n",
        "Die Jacobi-Matrix der inversen Funktionen $F_x^{-1}$ und $F_y^{-1}$\n",
        "$$ \n",
        "\\mathbf{J}_{F^{-1}}(x,y) = \n",
        "\\left[ \\begin{array}{center} \n",
        "\\xi_{,_x}(x,y) & \\eta_{,_x}(x,y) \\\\\n",
        "\\xi_{,_y}(x,y) & \\eta_{,_y}(x,y) \n",
        "\\end{array}\\right]\n",
        "=\n",
        "\\left[ \\begin{array}{center} \n",
        "\\frac{\\partial F_{x}^{-1}(x,y)}{\\partial x} & \\frac{\\partial F_{y}^{-1}(x,y)}{\\partial x} \\\\\n",
        "\\frac{\\partial F_{x}^{-1}(x,y)}{\\partial y} & \\frac{\\partial F_{y}^{-1}(x,y)}{\\partial y} \n",
        "\\end{array}\\right]\n",
        "$$ {#eq-JF-1}\n",
        "\n",
        "fasst die Ableitung von $F_x^{-1}$ und $F_y^{-1}$ nach $x$ und nach $y$ in einer Matrix zusammen. Für die Funktionen $F_x$ und $F_y$ ist die entsprechende Ableitungsmatrix \n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "\\mathbf{J}_F \n",
        "&=\n",
        "\\left[ \\begin{array}{center} \n",
        "x_{,_{\\xi}}(\\xi,\\eta) & y_{,_{\\xi}}(\\xi,\\eta) \\\\\n",
        "x_{,_{\\eta}}(\\xi,\\eta) & y_{,_{\\eta}}(\\xi,\\eta) \n",
        "\\end{array}\\right]\n",
        "=\n",
        "\\left[ \\begin{array}{center} \n",
        "\\frac{\\partial F_{x}(\\xi,\\eta)}{\\partial \\xi} & \\frac{\\partial F_{y}(\\xi,\\eta)}{\\partial \\xi} \\\\\n",
        "\\frac{\\partial F_{x}(\\xi,\\eta)}{\\partial \\eta} & \\frac{\\partial F_{y}(\\xi,\\eta)}{\\partial \\eta} \n",
        "\\end{array}\\right] \\\\\n",
        "&= \n",
        "\\left[ \\begin{array}{center} \n",
        "\\sum_{i=1}^4 \\frac{ N_i(\\xi,\\eta)}{\\partial \\xi} \\cdot x_i^e & \\sum_{i=1}^4 \\frac{N_i(\\xi,\\eta)}{\\partial \\xi} \\cdot y_i^e \\\\\n",
        "\\sum_{i=1}^4 \\frac{ N_i(\\xi,\\eta)}{\\partial \\eta} \\cdot x_i^e & \\sum_{i=1}^4 \\frac{N_i(\\xi,\\eta)}{\\partial \\eta} \\cdot y_i^e\n",
        "\\end{array}\\right] .\n",
        "% =\n",
        "% \\left[ \\begin{array}{center} \n",
        "% \\frac{N_1}{\\partial \\xi}   & \\frac{N_2}{\\partial \\xi}   & \\frac{N_3}{\\partial \\xi}   & \\frac{N_4}{\\partial \\xi} \\\\\n",
        "% \\frac{N_1}{\\partial \\eta}  & \\frac{N_2}{\\partial \\eta}  & \\frac{N_3}{\\partial \\eta}  & \\frac{N_4}{\\partial \\eta}\n",
        "% \\end{array}\\right]\n",
        "% \\left[ \\begin{array}{center} \n",
        "% x_1^e & y_1^e \\\\\n",
        "% x_2^e & y_2^e \\\\\n",
        "% x_3^e & y_3^e \\\\\n",
        "% x_4^e & y_4^e \n",
        "% \\end{array}\\right]\n",
        "\\end{align}\n",
        "$$ {#eq-JF}\n",
        "\n",
        "$N_i$ mit $i = 1,2,3,4$ bezeichnet in diesem Fall die vier linearen Formfunktionen des bilinearen Elementansatzes, welche für die Parametrisierung notwendig sind. Sei die Jacobi-Matrix vereinfacht ausgedrückt \n",
        "\n",
        "$$\n",
        "\\mathbf{J}_F =\n",
        "\\left[ \\begin{array}{center} \n",
        "J_{11} & J_{12} \\\\\n",
        "J_{21} & J_{22}\n",
        "\\end{array}\\right]\n",
        "$$\n",
        "\n",
        "und die inverse Jacobi-Matrix \n",
        "\n",
        "$$\n",
        "\\mathbf{J}_F^{-1} = \\frac{1}{det(\\mathbf{J})}\n",
        "\\left[ \\begin{array}{center} \n",
        "J_{22} & -J_{12} \\\\\n",
        "-J_{21} & J_{11}\n",
        "\\end{array}\\right]\n",
        "=\n",
        "\\left[ \\begin{array}{center} \n",
        "j_{11} & j_{12} \\\\\n",
        "j_{21} & j_{22}\n",
        "\\end{array}\\right]\n",
        "$$\n",
        "\n",
        "so sind die Komponenten der Jacobi-Matrix \n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "J_{11}  &= \\frac{1}{4} \\cdot (-x_1^e + x_2^e + x_3^e - x_4^e + \\eta (x_1^e - x_2^e + x_3^e - x_4^e)) \\\\\n",
        "J_{12}  &= \\frac{1}{4} \\cdot (-y_1^e + y_2^e + y_3^e - y_4^e + \\eta (y_1^e - y_2^e + y_3^e - y_4^e)) \\\\\n",
        "J_{21}  &= \\frac{1}{4} \\cdot (-x_1^e - x_2^e + x_3^e + x_4^e + \\xi (x_1^e - x_2^e + x_3^e - x_4^e)) \\\\\n",
        "J_{22}  &= \\frac{1}{4} \\cdot (-y_1^e - y_2^e + y_3^e + y_4^e + \\xi (y_1^e - y_2^e + y_3^e - y_4^e)) \\\\\n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        "und die Komponenten der inversen Transformationsmatrix \n",
        "$$ \n",
        "\\begin{align}\n",
        "j_{11} &= \\frac{1}{det(\\mathbf{J})} \\cdot J_{22}, \\quad &j_{12} = \\frac{1}{det(\\mathbf{J})} \\cdot J_{12}, \\\\\n",
        "j_{21} &= \\frac{1}{det(\\mathbf{J})} \\cdot J_{21}, \\quad &j_{22} = \\frac{1}{det(\\mathbf{J})} \\cdot J_{11}. \\\\\n",
        "\\end{align}\n",
        "$$ \n",
        "\n",
        "mit der Determinanten \n",
        "$$\n",
        "det(\\mathbf{J}) = J_{11} J_{22} - J_{21} J_{12}  \n",
        "$$\n",
        "\n",
        "Da, entsprechend dem _inverse function theorem_, die Jacobi-Matrix der inversen Funktionen $F_x^{-1}$ und $F_y^{-1}$ gleich der inversen Jacobi-Matrix der Funktionen $F_x$ und $F_y$ ist, \n",
        "\n",
        "$$\n",
        "\\mathbf{J}_{F^{-1}} = (\\mathbf{J}_F)^{-1},\n",
        "$$ {#eq-inverse-function-theorem}\n",
        "\n",
        "ergibt sich die Parametrisierung der Formfunktionen aus @eq-Ableitung-phi-I-gesamt zu \n",
        "\n",
        "$$ \n",
        "\\left[ \\begin{array}{center} \n",
        "\\varphi_{I,_1}(x,y) \\\\\n",
        "\\varphi_{I,_2}(x,y)\n",
        "\\end{array}\\right]\n",
        "= \n",
        "\\left[ \\begin{array}{center} \n",
        "j_{11} & j_{12} \\\\\n",
        "j_{21} & j_{22} \n",
        "\\end{array}\\right]\n",
        "\\left[ \\begin{array}{center} \n",
        "N_{i,_x}(\\xi(x,y),\\eta(x,y)) \\\\\n",
        "N_{i,_y}(\\xi(x,y),\\eta(x,y))\n",
        "\\end{array}\\right].\n",
        "$$\n",
        "\n",
        "Bezogen auf das DKQ-Element aus @sec-Steifigkeitsmatrix-DKQ ist die Parametrisierte B-Matrix\n",
        "\n",
        "$$\n",
        "\\mathbf{B_b} = \n",
        "\\left[ \\begin{array}{center}\n",
        "j_{11} H_{i,_\\xi}^x + j_{12} H_{i,_\\eta}^x \\\\\n",
        "j_{21} H_{i,_\\xi}^y + j_{22} H_{i,_\\eta}^y \\\\\n",
        "j_{11} H_{i,_\\xi}^y + j_{12} H_{i,_\\eta}^y +\n",
        "j_{21} H_{i,_\\xi}^x + j_{22} H_{i,_\\eta}^x & \n",
        "\\end{array}\\right]\n",
        "$$\n",
        "\n",
        "und die dementsprechende Formulierung für die Elementsteifigkeitsmatrizen bezogen auf das Referenzelement\n",
        "\n",
        "$$ \n",
        "\\begin{align}\n",
        "\\mathbf{k_{ij}^e} = a(\\varphi^e_j, \\varphi^e_i)\n",
        "&= \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{B}_e^T \\mathbf{D_b} \\mathbf{B}_e det[J] \\quad d\\xi \\eta\n",
        "\\end{align}\n",
        "$$ {#eq-elementsteifigkeitsmatrix_DKQ}\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "{{< pagebreak >}}\n",
        "\n",
        "\n",
        "<!-- Kapitel 5 -->\n",
        "\n",
        "```{=typst}\n",
        "#set page(header: align(right, emph(text(size: 12pt)[Kapitel 5: Umsetzung in JULIA])))\n",
        "```\n",
        "\n",
        "# Umsetzung in JULIA {#sec-Umsetzung-Julia}\n",
        "\n",
        "Im Folgenden wird der Aufbau des Programmcodes schematisch erläutert, sowie zentrale Teile des Quelltextes dargestellt. Da die verwendete Programmiersprache JULIA noch sehr jung ist, wird in @sec-JULIA eine kurze Einführung in die Sprache gegeben. @sec-kommerzielle-Software gibt einen Überblick über bestehende Finite Elemente Software, sowie der unterschiedlichen implementierten Elementansätze. Unter anderem wird das Programm _RFEM_ vorgestellt, welches in @sec-anwendungsbeispiele für Vergleichsrechnungen genutzt wird. Darauf folgend wird die allgemeine Struktur des erstellten Programmcodes in @sec-programmstruktur dargestellt, um darauf aufbauend in @sec-programmteile detaillierter auf die einzelnen Programmteile einzugehen.\n",
        "\n",
        "## Programmiersprache JULIA {#sec-JULIA}\n",
        "\n",
        "JULIA ist eine, seit 2009 am Massachusetts Institute of Technology (MIT) entwickelte, dynamische Programmiersprache für numerische und wissenschaftliche Berechnungen. Die Veröffentlichung wurde im Februar 2012 bekannt gegeben. Mittlerweile wurde das Open-Source-Programm bereits über 45 Millionen mal heruntergeladen und beinhalten über 10000 Packages. Außerdem können Bibliotheken von anderen Programmiersprachen wie beispielsweise Python, C++, R und Fortran genutzt werden. Ziel der Entwickler war es eine Programmiersprache zu schaffen, die sowohl eine benutzerfreundliche Umgebung hat, als auch leistungsfähig wie C und Fortran ist. \n",
        "\n",
        "JULIA beschreibt sich selber als^[www.julialang.org] \\\n",
        "- Fast - Schnell \\\n",
        "- Dynamic - Dynamisch \\\n",
        "- Reproducible - Nachvollziehbar \\\n",
        "- Composable - Ausbaubar / Erweiterbar \\\n",
        "- General - Allgemein \\\n",
        "- Open Source \\\n",
        "\n",
        "Die Programmiersprache hat einen LLVM (Low-Level Virtual Machine) basierten Just-in-Time Kompiler wodurch eine _hohe Ausführungsgeschwindigkeit_ erzielt wird, die in vielen Fällen mit der von C und Fortran vergleichbar ist.\n",
        "\n",
        "Die Syntax von Julia ist ähnlich der von MATLAB und Python, was sie für Nutzer aus diesen Umfeldern leicht zugänglich macht. Eine Deklaration von Typen ist in der Juliaumgebung nicht notwendig, dank ihrer dynamischen Typisierung. Trotzdem ermöglicht Julia auch die Verwendung von statischen Typen, wenn dies erforderlich ist.\n",
        "\n",
        "Obwohl Julia im Vergleich zu etablierten Programmiersprachen wie Python oder R eine jüngere Sprache ist, hat sie eine wachsende Zahl von Paketen und Bibliotheken, die eine breite Palette von Anwendungsbereichen abdecken. Die Julia-Community ist sehr aktiv, und viele Pakete sind speziell auf wissenschaftliche und technische Berechnungen ausgerichtet.\n",
        "\n",
        "Als _Open-Source_ Projekt mit über 1000 Mitwirkenden hat Julia das Potenzial durch die stetige Weiterentwicklung eine führende Rolle in der Programmierwelt für numerische und technische Anwendungen zu spielen.\n",
        "\n",
        "Der Quellcode von Julia ist auf GitHub verfügbar.\n",
        "\n",
        "\n",
        "## Plattenelementtypen in aktueller Finite-Element-Software {#sec-kommerzielle-Software}\n",
        "\\\n",
        "\n",
        "Zu den bekanntesten Finite Elemente Softwares gehören ADINA und ANSYS, welche, neben der Lösung von statischen und dynamischen Aufgabenstellungen der linearen und nicht linearen Strukturmechanik, primär in der Strömungsmechanik, und bei der Lösung multiphysikalischer Probleme eingesetzt werden. Diese beiden Programme gelten als Vertreter der General-Purpose Software, wohingegen InfoCAD, RFEM, SAP2000, SOFiSTiK, iTWO structure fem / TRIMAS und MircoFE speziell für die Tragwerksplanung entwickelte Programme sind. Die numerische Berechnung von Plattentragwerken durch die Finite ELemente Analyse basiert in allen Fällen entweder auf der Reissner-Mindlin Theorie oder der Kirchhoffplattentheorie. Neben der Wahl der Plattentheorie ist auch der Elementansatz von wesentlicher Bedeutung und variiert je nach kommerziellen Programm. Auf die Software von InfoCAD, RFEM und SAP2000 wird nachfolgend näher eingegangen.\n",
        "\n",
        "__InfoCAD__\n",
        "\n",
        "InfoCAD bietet die Möglichkeit, sich zwischen „discrete Kirchhoff theory“ (DKT) - Elementen und „Mindlin-Reissner“ (MR) - Elemente zu entscheiden. Laut Benutzerhandbuch erfüllen alle Elementansätze den Patch-Test. Bei der Berechnung nach Kirchhoff werden, nachdem die Verzerrungs-Verschiebungs-Beziehungen für die dicke Platte formuliert wurden, die Kirchhoffschen Bedingungen für die dünne Platte an diskreten Punkten der Elementberandung eingeführt. \"Dadurch können auch bei diesen Elementen die Unbekannten des Verformungsansatzes durch die Eckknotenverformungen ausgedrückt werden. Der Vorteil gegenüber einem reinen Verschiebungsansatz bei Plattenelementen\n",
        "zeigt sich in einem wesentlich verbesserten Konvergenzverhalten.\"^[s. Benutzerhandbuch InfoCAD].\n",
        "\n",
        "|*Software* |*Elementtyp Platten*|\n",
        "|:--------|:--------------|\n",
        "|_ADINA_| DKT-Element (Kirchhoffsche Plattentheorie) \\\n",
        "              3-Knoten-Dreieck-Schalenelement (Reissner-Mindlin-Plattentheorie) \\\n",
        "              -> gemische Interpolation tensorieller Komponenten (?) \\\n",
        "              4-Knoten-Viereck-Schalenelement (Reissner-Mindlin-Plattentheorie) \\\n",
        "              -> gemische Interpolation tensorieller Komponenten (?) \\\n",
        "              Elemente höherer Ordnung|\n",
        "|_ANSYS_|  schubweiche Dreieck-Plattenelemente \\\n",
        "                schubweiche Viereck-Plattenelemente|\n",
        "|_InfoCad_| DKT-Element (Kirchhoffsche Plattentheorie) \\\n",
        "                DKQ-Element (Kirchhoffsche Plattentheorie) \\ alternativ auch Elemente mit gemischter Interpolation nach Reissner-Mindlin Plattentheorie |\n",
        "|_RFEM_| 3-Knoten-Dreieck-Schalenelement (Reissner-Mindlin-Plattentheorie) \\\n",
        "              4-Knoten-Viereck-Schalenelement (Reissner-Mindlin-Plattentheorie)|\n",
        "|_SAP2000_| DKT-Element (Kirchhoffsche Plattentheorie)\\\n",
        "                DKQ-Element (Kirchhoffsche Plattentheorie)\\\n",
        "                3-Knoten-Dreieck-Schalenelement (Reissner-Mindlin-Plattentheorie) \\\n",
        "                4-Knoten-Viereck-Schalenelement (Reissner-Mindlin-Plattentheorie)|\n",
        "|_SOFiSTiK_|schubweiches 4-Knoten-Viereck-Plattenelement|\n",
        "|_iTWO structure fem / TRIMAS_ | 4-Knoten-Viereck-Schalenelement \\\n",
        "9-Knoten-Viereck-Schalenelement \\\n",
        "3-Knoten-Dreieck-Schalenelement \\\n",
        "6-Knoten-Dreieck-Schalenelement |\n",
        "|_MicroFe_ | Kirchhoff/Mindlin Elementansätze für dicke und dünne Platten und Faltwerke (mbAEC, Produktflyer MicroFe) |\n",
        "\n",
        ": Finite-Elemente-Software und deren Elementtypen {#tbl-FEM-Software}\n",
        "\n",
        "__RFEM__\n",
        "\n",
        "Auch bei RFEM ist die Wahl zwischen beiden Plattentheorien möglich. Empfohlen wird die Nutzung der Kirchhofftheorie für die Berechnung dünnerer Platten wie Stahlbleche. Dicke Platten und Schalen des Massivbaus sollten auf Grundlage der Reissner-Mindlin Theorie berechnet werden. Eine genaue Beschreibung der verwendeten Plattenelemente erfolgt in dem Handbuch von RFEM 6 nicht. Lediglich die viereckigen Schalenelemente, basierend auf der Reissner-Mindlin Theorie werden vorgestellt. \"Basierend auf einer gemischten Interpolation der transversalen Verschiebungen, Querschnittsdrehungen und transversalen Schubverzerrungen werden die von Bathe und Dvorkin [3] vorgestellten MITC-Elemente (Mixed Interpolationof Tensorial Components) verwendet: MITC3+ für Dreiecke, MITC4 für Vierecke.\"^[s. Benutzerhandbuch RFEM]\n",
        "\n",
        "__SAP2000__\n",
        "\n",
        "Bei SAP2000 handelt es sich um eine amerikanische Software die entwickelt und vertrieben wird über Computers and Structures Inc. (CSi), Walnut Creek, CA, USA. Neben den US-Amerikanischen Normen ist auch der Eurocode in dem Programm hinterlegt und ermöglicht die Nutzung in Deutschland. Sowohl für die Reissner-Mindlin Theorie, als auch für die Kirchhoffsche Plattentheorie enthält SAP2000 eine 3-Knoten-Dreieckelement und ein 4-Knoten-Viereckelement.\n",
        "\n",
        "\n",
        "## Programmstruktur {#sec-programmstruktur}\n",
        "\n",
        "Die Umsetzung in JULIA erfolgt entsprechend dem mathematischen Konzept, welches in den vorangegangenen Kapiteln ausführlich beschrieben wurde. @fig-Programmstruktur zeigt den schematischen Aufbau des Programms anhand der einzelnen Programmteile, welche in den folgenden Unterkapiteln näher betrachtet werden. \n",
        "\n",
        "![Programmstruktur](00-pics/Programmstruktur.png){#fig-Programmstruktur width=65%} \n",
        "\n",
        "Die Topologie und die Parameter bilden die Basis der Berechnung und spiegeln das physikalische Problem wider. Mittels des erzeugten Netzes und den festgelegten Parametern werden die Funktionen zur Berechnung der Elementsteifigkeitsmatrizen und Elementlastvektoren an das Netz in Form von Daten zugewiesen. In der darauf folgenden Assemblierung von $K$ und $r$ werden diese Funktionen elementweise aufgerufen und ausgewertet. Es ergeben sich die globale Steifigkeitsmatrix und der globale Lastvektor. Zur Lösung der Differentialgleichung, welche den Kern der FE-Methode darstellt, ist die Definition und Anwendung von Randbedingungen erforderlich. Abschließend werden aus dem berechneten Verschiebungsvektor `w` die Schnittgrößen des physikalischen Problems abgeleitet.\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "{{< pagebreak >}}\n",
        "## Programmteile {#sec-programmteile}\n",
        "\n",
        "### Parameter {#sec-Parameter}\n",
        "\n",
        "Um ein physikalisches Problem lösen zu können, müssen zunächst die Parameter der zu berechnenden Platte in einer Parameterliste mit Variablen festgelegt werden. Eine beispielhafte Parameterliste wird nachfolgend dargestellt. "
      ],
      "id": "1e706bf5"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| echo: false\n",
        "#| warning: false\n",
        "include(\"../src/setup.jl\")\n",
        "using MMJMesh.Meshes\n",
        "nx = 1\n",
        "ny = 1;"
      ],
      "id": "1f1034a2",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "p = @var Params()\n",
        "p.lx = 8\n",
        "p.ly = 8\n",
        "p.q = 5e3\n",
        "p.ν = 0.2\n",
        "p.h = 0.2\n",
        "p.E = 31000e6;"
      ],
      "id": "eb022534",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "Bei einer rechteckigen Platte kann anhand der Parameter `p.lx` und `p.ly`, durch die in @sec-Berechnungsgebiet beschriebene Funktion `makemeshonrectangle()`, ein FE-Netz für die Platte der Länge `p.lx` und der Breite `p.ly` erzeugt werden. Die Parameter `p.q`, `p.ν`, `p.h` und `p.E` beschreiben die einwirkende Flächenlast $q$, die Querdehnzahl $\\nu$, die Plattendicke $h$ und das Elastizitätsmodul des Materials $E$.\n",
        "\n",
        "### Gebiet $\\Omega$ {#sec-Berechnungsgebiet}\n",
        "\n",
        "Die Definition eines Netzes erfolgt mithilfe der von Prof. Dr.-Ing. Mattias Baitsch entwickelten MMJMesh.Meshes Bibliothek. Für die Beispiele in @sec-anwendungsbeispiele sind die nachfolgenden drei Funktionen wichtig. Mit den Funktion `Mesh()`, aus der eben genannten Bibliothek, wird eine Platte und das zugehörige FE-Netz erzeugt. Eingabedaten sind zum einen die Koordinaten der Knoten, hier `coords`, sowie die Definition der Elemente durch das Verbinden der Knoten in einem Vektor, hier `elts`. Wichtig bei der Deklaration der Elemente ist die Reihenfolge der Knoten. Die Platte, erzeugt durch den nachfolgend beschriebenen Code, ist in @fig-Mesh dargestellt."
      ],
      "id": "ad6b0f60"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "coords = [0.0 20.0 40.0 0.0  20.0 40.0 0.0  20.0 40.0;\n",
        "          0.0 0.0  0.0  10.0 10.0 10.0 20.0 20.0 20.0]\n",
        "elts = [[1,2,5,4],[2,3,6,5],[4,5,8,7],[5,6,9,8]]\n",
        "m = MMJMesh.Meshes.Mesh(coords, elts, 2);"
      ],
      "id": "a54d93a2",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "Zur Erzeugung einer einfachen rechteckigen Platte mit den Längen $l_x$ und $l_y$ und einem gleichmäßigen Netz mit gleich großen Elementen wird die Funktion `makemeshonrectangle(lx, ly, nx, ny)` genutzt. Die Eingabeparameter `nx` und `ny` geben die Anzahl der Unterteilungen je Seite an. Eine beispielhafte Anwendung der Funktion zeigt @fig-makemeshonrectangle."
      ],
      "id": "b397999c"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "m = makemeshonrectangle(p.lx, p.ly, nx, ny);"
      ],
      "id": "b1d4d1f6",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "![FE-Netz erzeugt mit der Funktion `Mesh()`](00-pics/mesh-coords-elts.png){#fig-Mesh width=80%}\n",
        "\n",
        "![FE-Netz erzeugt mit der Funktion `makemeshonrectangle()`](00-pics/mesh-rect.png){#fig-makemeshonrectangle width=80%}\n",
        "\n",
        "Alternativ kann eine .msh Datei eingepflegt werden mit"
      ],
      "id": "6e342a92"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "m = MMJMesh.Meshes.Mesh(\"../gmsh/complex-plate-02.msh\");"
      ],
      "id": "f84934de",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "![FE-Netz aus complex-plate-02.msh Datei](00-pics/complex-plate.png){#fig-Mesh-complex width=45%}\n",
        "\n",
        "### Formfunktionen \n",
        "\n",
        "Für die Definition der Formfunktionen wird ebenfalls auf die MMJMesh Bibliothek zugegriffen. Für die Konstruktion der Funktionen ist ein Bezugselement, mit den Koordinaten gespeichert in der Matrix `V` vom Typ Int64, zu definieren. Für das Referenzelement ist `V` wie folgt festgelegt."
      ],
      "id": "17e06279"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "V = [ -1 1 1 -1; -1 -1 1 1]"
      ],
      "id": "170f7a2d",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "Um die Formfunktionen der unterschiedlichen Elementansätze zu erzeugen wird mittels der Funktion `mmonomials(n,p)` ein Vektor mit allen, für die Formfunktionen notwendigen, Monomen erzeugt. `n` ist dabei die Anzahl der Variablen und `p` der Grad der Monome. Außerdem kann optional das Gebiet und eine Vorschrift zum Erstellen der Monome als Eingabeparameter in der Funktion übergeben werden, wie es bei der Erzeugung des nicht konformen Hermite-Elements und bei dem Serendipity Element notwendig ist.\n",
        "\n",
        "In dem Vektor `N` werden die Linearformen für das jeweilige Element gespeichert. Die Funktionen `ValueAtLF(x)` und `PDerivativeAtLF(x, n)` werden für die Erzeugung der Linearformen genutzt. `ValueAtLF(x)` wertet eine Funktion f(x) an der Stelle `x` aus. `PDerivativeAtLF(x, n)` wertet die partielle Ableitung einer Funktion $f : \\mathbb{R}^n \\to \\mathbb{R}$ an der Stelle `x` in Richtung `n` aus. Mit `PDerivativeAtLF([-1,-1], [1, 2])` wird beispielsweise eine Funktion an der Stelle $[-1,-1]$ einmal in $x$- und zweimal in $y$-Richtung abgeleitet.\n",
        "\n",
        "Durch Multiplikation der Inversen der Matrix `M` mit den in `P` generierten Monomen ergeben sich die Funktionen der Formfunktionen. Nachfolgend wird beispielhaft der Ablauf zur Konstruktion der Formfunktionen für das konforme Hermite-Element dargestellt.\n"
      ],
      "id": "7b527c50"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "function hermiteelement(V)\n",
        "        m = 16\n",
        "        P = mmonomials(2, 3, QHat  ,type = BigInt)\n",
        "        N = vcat(\n",
        "            [   [ValueAtLF(p), \n",
        "                PDerivativeAtLF(p, [1, 0]), \n",
        "                PDerivativeAtLF(p, [0, 1]), \n",
        "                PDerivativeAtLF(p, [1, 1])]\n",
        "                for p in eachcol(V)]...\n",
        "            )\n",
        "    Imatrix = Matrix{Int}(I, m, m)\n",
        "    M = [n(p) for p in P, n in N]\n",
        "    Minv = simplifyx.(M \\ Imatrix)\n",
        "    H4 = Minv * P\n",
        "    return H4\n",
        "end;"
      ],
      "id": "6ece6562",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "### Elementsteifigkeitsmatrizen & Elementlastvektoren\n",
        "\n",
        "Für die Umsetzung der Bogner-Fox-Schmit Formulierung und der DKQ-Formulierung ist es essentiell die Elementsteifigkeitsmatrix für beide Elementtypen zu generieren. Die allgemeine Elementsteifigkeitsmatrix des konformen Hermite-Elements wird durch den unten stehenden Algorithmus erzeugt. `H4` ist der Vektor der Formfunktionen erzeugt mit der oben beschriebenen Funktion `hermiteelement()`. Für die geometrischen Größen `a`, `b`, und `h` des Elements, sowie für die materialspezifischen Größen `ν` und `E` werden zunächst Variablen deklariert. Hierfür wird das `Symbolics` Paket von Julia genutzt. Die generierte Steifigkeitsmatrix, abhängig von den oben genannten Variablen wird in einer weiteren Funktion `pkcKe(p)` gespeichert, welche für die FEM Berechnung genutzt wird. \n",
        "\n",
        "```{{julia}}\n",
        "using Symbolics\n",
        "@variables  a,b, h, ν,E;\n",
        "# Punkte des Elements\n",
        "points = [0 a a 0; 0 0 b b]\n",
        "# Formfunktione konformes Hermite Element\n",
        "H4 = hermiteelement(points;conforming=true)\n",
        "∂1(u) =  (∂x(∂x(u)))\n",
        "∂2(u) =  (∂y(∂y(u)))\n",
        "∂3(u) =  2*(∂x(∂y(u)))\n",
        "Be1std(u) = [∂1(u), ∂2(u), ∂3(u)]\n",
        "Be2std(u) = [∂1(u) + ν * ∂2(u), ν * ∂1(u) + ∂2(u),(1- ν)/2 * ∂3(u)]\n",
        "aestd(u,v) = integrate(Be1std(u) ⋅ Be2std(v), (0 .. a) , (0 .. b))\n",
        "Ke = (simplifyx.([aestd(n1, n2) for n1 ∈ H4, n2 ∈ H4]));\n",
        "```\n",
        "\n",
        "Bei der Elementsteifigkeitsmatrix für allgemeine Vierecke ist ein solcher Algorithmus aufwendiger, da neben der Länge und der Breite auch die Winkel verschieden sind. Für die Berechnung der Elementsteifigkeitsmatrix des DKQ Elements wurden zunächst die $H_x$- und $H_y$-Funktionen generiert, dessen Anforderungen, basierend auf dem Paper von Batoz und Tahar, in @sec-Steifigkeitsmatrix-DKQ beschrieben wurden. Für die Parametrisierung der Elemente mittels der Jacobi-Matrix wird auf die Funktion `jacobian()` aus der `MMJMesh` Bibliothek zurückgegriffen. Um `Ke` elementweise zu berechnen wird für die numerische Integration die Gauß-Quadratur angewandt. Es ergibt sich die Schleife über die Integrationspunkte `gaussPoints` mit den zugehörigen Integrationsgewichten `gaussWeights`. "
      ],
      "id": "fa5aff38"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "function DKQKe(p)\n",
        "    function keFunc(e)\n",
        "        D = p.E*p.h^3 / 12*(1-p.ν^2) * [1 p.ν 0; p.ν 1 0; 0 0 (1-p.ν)/2]\n",
        "        Ke = zeros(12,12)\n",
        "        # Jacobimatrix des betrachteten Elements\n",
        "        jF = jacobian(parametrization(geometry(e)))\n",
        "        HxFace, HyFace = makeDKQFunctions(e)\n",
        "        Hx = MappingFromComponents(HxFace...)  # 12 Element Vektor mit Hx Funktionen \n",
        "        Hy = MappingFromComponents(HyFace...)  # 12 Element Vektor mit Hy Funktionen \n",
        "        # Gradient Hx\n",
        "        ∇ξηHx = MMJMesh.Mathematics.TransposeMapping(jacobian(Hx)) \n",
        "        # Gradient Hy\n",
        "        ∇ξηHy = MMJMesh.Mathematics.TransposeMapping(jacobian(Hy))\n",
        "\n",
        "        for (ξ, w) ∈ zip(gaussPoints, gaussWeights)\n",
        "            # Jacobi matrix ausgewertet an der Stelle ξ\n",
        "            J = jF(ξ)\n",
        "            ∇ˣʸHx = (inv(J') * ∇ξηHx(ξ))\n",
        "            ∇ˣʸHy = (inv(J') * ∇ξηHy(ξ)) \n",
        "            B = [∇ˣʸHx[1,:]', ∇ˣʸHy[2,:]', ∇ˣʸHy[1,:]'+∇ˣʸHx[2,:]']\n",
        "            Ke += w * B' * D * B * det(J)\n",
        "        end\n",
        "        return Ke\n",
        "    end\n",
        "    return keFunc\n",
        "end;"
      ],
      "id": "95fd5b05",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "### Randbedingungen\n",
        "\n",
        "Zur Berechnung ingenieurstechnischer Aufgaben durch die FEM ist Festlegung von Randbedingungen unabdingbar. Bei bautechnischen Fragestellungen wird dies in Form von Auflagerbedingungen umgesetzt. Je nach Elementansatz gibt es drei bzw. vier Freiheitsgrade je Knoten. Mit der Funktion `applyDirichletBCs!()` können die Verschiebung und die Verdrehungen an bestimmten Knoten zu null gesetzt werden. \n",
        "\n",
        "|Lagerbedingung | BFS                        | DKQ                 |\n",
        "|:-------------:|:---------------------------|:--------------------|\n",
        "| gelenkig      | `[true,false,false,false]` | `[true,false,false]`| \n",
        "| starr         | `[true,true,true,false]`    | `[true,true,true]`  | \n",
        "\n",
        ": Auflagerbedinungen für den Bogner-Fox-Schmitt Elementansatz und für das DKQ Element {#tbl-Auflagerbedinungen-Programm}"
      ],
      "id": "01be7186"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "function applyDirichletBCs!(fixedNodes, K, r, fixed = [true])\n",
        "    dofs = fixedDOFs(fixedNodes,fixed)\n",
        "    r[dofs] .= 0\n",
        "    K[dofs, :] .= 0\n",
        "    K[diagind(K)[dofs]] .= 1\n",
        "    return nothing \n",
        "end;"
      ],
      "id": "1aeca685",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "### Assemblierung Steifigkeitsmatrix\n",
        "\n",
        "Für die Zusammenführung der Elementsteifigkeitsmatrizen und der Elementlastvektoren wird in `assembleKr()` zunächst eine $N \\times N$ Matrix und ein Vektor mit $N$ Nullen erstellt. `N` ist die Anzahl der gesamten Freiheitsgrade. In einer Schleife über alle Elemente des Netzes werden die Indexvektoren `I` mit der Funktion `idxDOFs()` erstellt."
      ],
      "id": "456c9a3d"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "idxDOFs(nodes::AbstractVector{<:Integer}, nf::Integer) = collect(reshape([(i - 1) * nf + j for i = nodes, j = 1:nf]', :));"
      ],
      "id": "82d1f62c",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "Die Funktionen zur Erstellung der Elementsteifigkeitsmatrizen `pkcKe(p)` bzw. `DKQKe(p)` und der Elementlastvektoren `pkcRe(p.q)` bzw. `DKQRe(p.q)`, müssen vor der Zusammenstellung dem `Mesh` als Daten zugefügt werden. Durch eine Schleife werden elementweise die Funktionen abgerufen und die Ergebnisse der globalen Matrix `K` und dem Vektor `r` beigefügt. "
      ],
      "id": "a406e9d2"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "function assembleKr(s, nf)\n",
        "    N = nnodes(s) * nf\n",
        "    K = zeros(N, N)\n",
        "    r = zeros(N)\n",
        "\n",
        "    for e ∈ elements(s)\n",
        "        # Indexvektor\n",
        "        I = idxDOFs(nodeindices(e),nf)\n",
        "\n",
        "        # Berechnung ke für Element + Addition ke globale Steifigkeitsmatrix K\n",
        "        kef = data(e, :kefunc)\n",
        "        K[I, I] += kef(e)\n",
        "\n",
        "        # Berechnung re für Elemente + Addition re globalen Lastvektor\n",
        "        ref = data(e, :refunc)\n",
        "        r[I] += ref(e)\n",
        "    end\n",
        "    return K, r\n",
        "end;"
      ],
      "id": "017799a1",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "{{< pagebreak >}}\n",
        "### Postprozessor\n",
        "\n",
        "Für die Lösung des linearen Gleichungssystems aus @eq-lin-gleichungssystem wird der Verschiebungsvektor durch \n",
        "\n",
        "`K \\ w` \n",
        "\n",
        "berechnet. Für das Bogner-Fox-Schmit Element basieren die, im `postprozessor()` berechneten Größen, je Element auf den Ableitungen der Verschiebungsfunktion. Für die Formulierung allgemeiner Vierecke werden die Schnittgrößen abhängig von den Verdrehungen $\\beta_x$ und $\\beta_y$ berechnet. Die Funktion `moment()` spiegelt Gl. (17) aus dem Paper von Batoz und Tahar wieder."
      ],
      "id": "f93a5c7a"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "function moment(name)\n",
        "    x -> begin\n",
        "        J = jF(x) \n",
        "        ∇ˣʸHx = (inv(J') * ∇ξηHx(x))\n",
        "        ∇ˣʸHy = (inv(J') * ∇ξηHy(x)) \n",
        "        B = [∇ˣʸHx[1,:]', ∇ˣʸHy[2,:]', ∇ˣʸHy[1,:]'+∇ˣʸHx[2,:]']\n",
        "        if name == :mxfunc\n",
        "            return (Db * B)[1] * wHat[idxs]\n",
        "        elseif name == :myfunc\n",
        "            return (Db * B)[2] * wHat[idxs]\n",
        "        elseif name == :mxyfunc\n",
        "            return (Db * B)[3] * wHat[idxs]\n",
        "        end\n",
        "    end\n",
        "end;"
      ],
      "id": "e5009d75",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "Für die Berechnung der Querkräfte werden die Momentenfunktionen an den Knotenpunkten ausgewertet und bilinear interpoliert. Anschließend werden die entstandenen Funktionen abgeleitet und mittels der inversen Jacobi-Matrix parametrisiert."
      ],
      "id": "f0fe5e55"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "function querkraft(name)\n",
        "    x -> begin\n",
        "        VV = [[-1, -1], [1, -1], [1, 1], [-1, 1]]\n",
        "        J = jF(x) \n",
        "        ∇ˣʸNi = (inv(J') * ∇Ni(x))\n",
        "        ∇Mx = ∇ˣʸNi * moment(:mxfunc).(VV)\n",
        "        ∇My = ∇ˣʸNi * moment(:myfunc).(VV)\n",
        "        ∇Mxy = ∇ˣʸNi * moment(:mxyfunc).(VV)\n",
        "        qx = ∇Mx[1] + ∇Mxy[2]\n",
        "        qy = ∇Mxy[1] + ∇My[2]\n",
        "        if name == :qxfunc\n",
        "            return qx\n",
        "        elseif name == :qyfunc\n",
        "            return qy\n",
        "        end\n",
        "    end\n",
        "end;"
      ],
      "id": "4e33d2a1",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "{{< pagebreak >}}\n",
        "\n",
        "\n",
        "\n",
        "<!-- Kapitel 6 -->\n",
        "\n",
        "```{=typst}\n",
        "#set page(header: align(right, emph(text(size: 12pt)[Kapitel 6: Anwendungsbeispiele])))\n",
        "```\n",
        "\n",
        "# Anwendungsbeispiele {#sec-anwendungsbeispiele}\n",
        "\n",
        "Um das in @sec-Umsetzung-Julia beschriebene Programm anzuwenden werden zwei Plattensysteme untersucht. In @sec-patch-test wird zuvor ein sogenannter Patch-Test durchgeführt, und die Berechnungen, entsprechend der Formulierung von Batoz und Tahar, zu untersuchen. Der Patch-Test dient vor allem zur Überprüfung der Momentenverläufe. In @sec-kreisplatte wird an einer eingespannten Kreisplatte die Verformungsberechnung mit einem Berechnungsbeispiel aus @altenbach_ebene_2023 verglichen.\n",
        "\n",
        "Darauf folgend wird ein einfaches statisches Plattensystem in @sec-beispiel-01, dann ein komplexeres System in @sec-beispiel-02 berechnet. Die verschiedenen Elementansätze werden angewandt. Die Validierung der Ergebnisse erfolgt bei Beispiel 1 zum einen durch den Vergleich mit den Tabellenwerten der Plattentafeln von Czerny und zum anderen durch die Vergleichsrechnung mit dem kommerziellen Programm _RFEM_. Zur Überprüfung der Berechnungsergebnisse von Beispiel 2 wird die Vergleichsrechnung mit selbigem Programm durchgeführt.\n",
        "\n",
        "## Patch-Test {#sec-patch-test}\n",
        "\n",
        "Der Patch-Test ist eine gängige Methode um die Qualität eines Elementansatzes zu überprüfen. Ziel ist es, ein statisches System zu berechnen, bei dem erwartet wird, dass sich ein konstanter Spannungszustand einstellt. Um das in @sec-programmstruktur und @sec-programmteile beschriebene Programm zu validieren wird der Patch-Test auf das in @fig-Patch-test-system gezeigte System angewandt.\n",
        "\n",
        "| Eingabeparameter  |                           |\n",
        "|:------------------|:--------------------------|\n",
        "|Plattendicke       | $d = 1.0$        |\n",
        "|Elastizitätsmodul  | $E = 1.000$ |\n",
        "|Querdehnzahl       | $\\nu = 0.0$               |\n",
        "|                   | $a = 20$ bzw. $a = 20$             |\n",
        "|                   | $b = 10$ bzw. $b = 10$               |\n",
        "\n",
        ": Daten zum Beispiel \"Patch-Test\" {#tbl-Eingabedaten_patch}\n",
        "\n",
        "![Patch Test Problem](00-pics/Patch-Test-System.png){#fig-Patch-test-system width=70%} \n",
        "\n",
        "Die rechteckige Platte wird in fünf allgemeine Vierecke unterteilt. Um das Netz zu erzeugen wird die Funktion `makequadrilateralMesh(p)` aufgerufen. Die Abmessungen sind @fig-Patch-test-system, mit $a = 20$ und $b = 10$, zu entnehmen. Alle Eingabeparameter entsprechen dem Patch-Test-Problem aus @batoz_evaluation_1982 Abb. 3 und können @tbl-Eingabedaten_patch entnommen werden."
      ],
      "id": "db9a4c1a"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "function makequadrilateralMesh(p)\n",
        "    coords = [0.0 (9/50 * p.lx) (18/25 * p.lx) p.lx 0.0  \n",
        "              (9/25 * p.lx) (18/25 * p.lx) p.lx;\n",
        "              0.0 (2/10 * p.ly) (4/10 * p.ly) 0.0  \n",
        "              p.ly (7/10 * p.ly) (7/10 * p.ly) p.ly]\n",
        "    elts = [[1,4,3,2],[3,4,8,7],[6,7,8,5],[1,2,6,5],[2,3,7,6]]\n",
        "    m = MMJMesh.Meshes.Mesh(coords, elts, 2)\n",
        "    return m\n",
        "end;"
      ],
      "id": "371c596c",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "An den Eckpunkten wird jeweils um die $y$-Achse ein Moment von $20$ und um die $x$-Achse ein Moment von $10$ angesetzt. Über die Länge verteilt entspricht das, an allen Außenkanten, einem Moment von $1$. \n",
        "\n",
        "![Patch-Test: Verformung $w$](00-pics/Beispiel-00-w.png){#fig-Patch-test-verformung width=45%} \n",
        "\n",
        "Die Verformungsfigur der Berechnung ist in @fig-Patch-test-verformung dargestellt. Die Momentenverläufe (s. @fig-Patch-Momente) sind erwartungsgemäß, sowohl um die $x$- als auch um die $y$-Achse, konstant $1$\n",
        "\n",
        "\n",
        "::: {#fig-Patch-Momente  layout-ncol=2}\n",
        "\n",
        "```{=typst}\n",
        "#grid(\n",
        "  columns: (220pt, 220pt),\n",
        "  rows: (170pt, 170pt),\n",
        "  gutter: 3pt,\n",
        "  grid.cell(image(\"00-pics/Beispiel-00-mx.png\", height: 100%)),\n",
        "  grid.cell(image(\"00-pics/Beispiel-00-my.png\", height: 100%)),\n",
        "  grid.cell(image(\"00-pics/Beispiel-00-mxy.png\", height: 100%)),\n",
        ")\n",
        "```\n",
        "Patch-Test: Momentverläufe $m_x$, $m_x$ und $m_{xy}$ [kNm/m]\n",
        ":::\n",
        "\n",
        "\n",
        "## Kreisplatte {#sec-kreisplatte}\n",
        "\n",
        "![Beispiel \"Kreisplatte\": Finite-Elemente-Netz](00-pics/Beispiel-01-Circ-mesh.png){#fig-Kreisplatte-mesh width=70%} \n",
        "\n",
        "Als weiteres Minimalbeispiel dient eine rundum eingespannte Kreisplatte mit konstanter Flächenlast. Die Eingabeparameter sind in @tbl-Eingabedaten_kreisplatte aufgeführt.\n",
        "\n",
        "| Eingabeparameter  |                           |\n",
        "|:------------------|:--------------------------|\n",
        "|Radius             | $r = 8.0 \\text{ m}$        |\n",
        "|Plattendicke       | $d = 0.2 \\text{ m}$        |\n",
        "|Elastizitätsmodul  | $E = 31000*10^6 \\text{ N/m}^2$|\n",
        "|Querdehnzahl       | $\\nu = 0.0$               |\n",
        "|Flächenlast        | $q = 5000\\text{ N/m}^2$|\n",
        "\n",
        ": Daten zum Beispiel \"Kreisplatte\" {#tbl-Eingabedaten_kreisplatte}\n",
        "\n",
        "Die Durchbiegung einer eingespannten Kreisplatte kann entsprechend Abb. 3.35 aus @altenbach_ebene_2023 berechnet werden. Die maximale Verformung mit den angegebenen Parametern ist\n",
        "$$\n",
        "\\begin{align}\n",
        "&w_{max} = \\frac{q * r^4}{64 K} \\qquad \\qquad \\qquad = 0.0154  \\text{ m}\\\\\n",
        "\\\\\n",
        "&\\qquad \\text{mit} \\quad K = \\frac{E*d^3}{12*(1-p1.ν^2)}.\n",
        "\\end{align}\n",
        "$$\n",
        "\n",
        "Mit dem in @fig-Kreisplatte-mesh dargestellten Netz errechnet sich die maximale Verformung mit der DKQ-Formulierung zu \n",
        "\n",
        "$$\n",
        "w_{fe} = 0.0155 \\text{ m}\n",
        "$$\n",
        "\n",
        "was einer Abweichung von _0.680 %_ entspricht. Die Verformungsfigur ist in @fig-Kreisplatte-verformung dargestellt.\n",
        "\n",
        "![Beispiel \"Kreisplatte\": Verformungsfigur](00-pics/Beispiel-01-Circ-w.png){#fig-Kreisplatte-verformung width=70%}\n",
        "\n",
        "\n",
        "{{< pagebreak >}}\n",
        "## Beispiel 1: allseitig eingespannte Platte {#sec-beispiel-01}\n",
        "\n",
        "Als erstes Beispiel dient eine allseitig eingespannte Platte die durch eine konstante Flächenlast belastet wird. Das statische System sowie das FE-Netz sind in @fig-Beispiel-01-FE-Netz dargestellt. Die gewählte Struktur ermöglicht den Vergleich mit den Werten der Czerny-Tafeln, um die Plausibilität der Ergebnisse zu prüfen. Sowohl eine Finite Elemente Berechnung mittels des Bogner-Fox-Schmit Elementansatzes, als auch des DKQ-Elements wird angewandt. Zur weiteren Validierung erfolgt eine weitere Berechnung mit dem kommerziellen Programm _RFEM_ der Firma _Dlubal Software GmbH_.\n",
        "\n",
        "![allseitig eingespannte quadratische Platte](00-pics/Beispiel-01-BFS.png){#fig-Beispiel-01-FE-Netz width=80%} \n",
        "\n",
        "\n",
        "Für die Berechnung der $8m \\times 8m$ großen Platte werden die in @tbl-Eingabedaten angegebenen Eingangsparameter zugrunde gelegt.\n",
        "\n",
        "| Eingabeparameter       |                           |\n",
        "|:------------------|:--------------------------|\n",
        "|Plattendicke       | $d = 0.2 \\text{ m}$        |\n",
        "|Elastizitätsmodul  | $E = 31000*10^6 \\text{ N/m}^2$|\n",
        "|Flächenlast        | $p = 5000 \\text{ N}$         |\n",
        "|                   | $\\nu = 0.0$               |\n",
        "\n",
        ": Daten zum Beispiel \"allseitig eingespannte Platte\" {#tbl-Eingabedaten}\n",
        "\n",
        "Aus den Czerny-Tafeln (Tafel 2.2.6.1, \"Starre Einspannung der vier Ränder\") ergeben sich folgende Werte:\n",
        "\n",
        "$$\n",
        "\\begin{align}\n",
        "&m_{x_{erm}} &&= - \\frac{p \\cdot l_x^2}{19.4} &&= -16494.85 &&\\text{Nm}^2 \\\\\n",
        "&m_{x_{m}} &&=  \\frac{p \\cdot l_x^2}{56.8} &&= 5633.80 &&\\text{Nm}^2 \\\\\n",
        "&m_{y_{erm}} &&= - \\frac{p \\cdot l_x^2}{19.4} &&= -16494.85 &&\\text{Nm}^2 \\\\\n",
        "&m_{y_{max}} &&=  \\frac{p \\cdot l_x^2}{56.8} &&= 5633.80 &&\\text{Nm}^2 \\\\\n",
        "&q_{x_{erm}} &&= \\pm \\frac{p \\cdot l_x}{2.24} &&= \\pm 17857.14 &&\\text{Nm} \\\\\n",
        "&q_{y_{erm}} &&= \\pm \\frac{p \\cdot l_x}{2.24} &&= \\pm 17857.14 &&\\text{Nm} \\\\\n",
        "&w_{max} &&= \\frac{p \\cdot l_x^4}{E \\cdot d^3} \\cdot 0.0152 &&= 0.001255 &&\\text{m} \\\\\n",
        "\\end{align}\n",
        "$${#eq-werte-czerny-tafeln}\n",
        "\n",
        "\n",
        "Die Einspannmomente im Randmittelpunkt des starr eingespannten Plattenrandes sind $m_{x_{erm}}$ und $m_{y_{erm}}$. Die Feldmomente in Plattenmitte $m_{x_{m}}$ und  $m_{y_{m}}$ und die größten Feldmomente im Plattenmittenschnitt $m_{x_{max}}$, $m_{y_{max}}$ stimmen bei der symmetrischen Platte überein. Die Stützkräfte in Randmitte der starr eingespannten Plattenränder sind $q_{x_{erm}}$ und $q_{y_{erm}}$. Nachfolgend werden die Biegemomentenverläufe und die Querkraftverläufe des Beispiels dargestellt. \n",
        "\n",
        "Die resultierende Verformungsfigur in überhöhter Darstellung stimmt bei beiden Elementansätzen überein und ist in @fig-BFS-w dargestellt. Die maximale Durchbiegung in Feldmitte, ermittelt durch die FE-Berechnung beträgt $w_{max} =  0.001255 m$ für den BFS-Elementansatz bzw. $w_{max} =  0.001262 m$ für den DKQ-Elementansatz und weicht bezogen auf den Tabellenwert aus @eq-werte-czerny-tafeln um $0.0297 \\%$ bzw. $0.566 \\%$ ab. \n",
        "\n",
        "![Durchbiegung $w$ der Platte](00-pics/Beispiel-01-BFS-w.png){#fig-BFS-w width=50%}\n",
        "\n",
        "{{< pagebreak >}}\n",
        "### Berechnungsergebnisse: BFS Elementansatz\n",
        "\n",
        ":::{#fig-Biegemomente-BFS  layout-ncol=2}\n",
        "```{=typst}\n",
        "#grid(\n",
        "  columns: (220pt, 220pt),\n",
        "  rows: (180pt, 180pt,180pt),\n",
        "  gutter: 3pt,\n",
        "  grid.cell(image(\"00-pics/Beispiel-01-BFS-mx.png\", width: 100%)),\n",
        "  grid.cell(image(\"00-pics/Beispiel-01-BFS-mx-glatt.png\", width: 100%)),\n",
        "  grid.cell(image(\"00-pics/Beispiel-01-BFS-my.png\", width: 100%)),\n",
        "  grid.cell(image(\"00-pics/Beispiel-01-BFS-my-glatt.png\", width: 100%)),\n",
        "  grid.cell(image(\"00-pics/Beispiel-01-BFS-mxy.png\", width: 100%)),\n",
        "  grid.cell(image(\"00-pics/Beispiel-01-BFS-mxy-glatt.png\", width: 100%)),\n",
        ")\n",
        "```\n",
        "quadratische Platte: Biegemomente $m_x$, $m_y$ und $m_{xy}$ [kNm/m] (BFS) | links: _unbehandelte_ Ergebnisse | rechts: _geglättete_ Ergebnisse\n",
        ":::\n",
        "\n",
        "::: {#fig-Querkräfte-BFS  layout-ncol=2}\n",
        "\n",
        "![](00-pics/Beispiel-01-BFS-qx.png){width=80%}\n",
        "\n",
        "![](00-pics/Beispiel-01-BFS-qx-glatt.png){width=80%}\n",
        "\n",
        "![](00-pics/Beispiel-01-BFS-qy.png){width=80%}\n",
        "\n",
        "![](00-pics/Beispiel-01-BFS-qy-glatt.png){width=80%}\n",
        "\n",
        "quadratische Platte: Querkräfte $q_x$ und $q_y$ [kN/m] (BFS) | links: _unbehandelte_ Ergebnisse | rechts: _geglättete_ Ergebnisse\n",
        ":::\n",
        "\n",
        "{{< pagebreak >}}\n",
        "### Berechnungsergebnisse. DKQ-Elementansatz\n",
        "\n",
        "::: {#fig-Biegemomente-BTP  layout-nrow=\"3\"}\n",
        "```{=typst}\n",
        "#grid(\n",
        "  columns: (220pt, 220pt),\n",
        "  rows: (180pt, 180pt,180pt),\n",
        "  gutter: 3pt,\n",
        "  grid.cell(image(\"00-pics/Beispiel-01-BT-mx.png\", width: 100%)),\n",
        "  grid.cell(image(\"00-pics/Beispiel-01-BT-mx-glatt.png\", width: 100%)),\n",
        "  grid.cell(image(\"00-pics/Beispiel-01-BT-my.png\", width: 100%)),\n",
        "  grid.cell(image(\"00-pics/Beispiel-01-BT-my-glatt.png\", width: 100%)),\n",
        "  grid.cell(image(\"00-pics/Beispiel-01-BT-mxy.png\", width: 100%)),\n",
        "  grid.cell(image(\"00-pics/Beispiel-01-BT-mxy-glatt.png\", width: 100%)),\n",
        ")\n",
        "```\n",
        "quadratische Platte: Biegemomente $m_x$, $m_y$ und $m_{xy}$ [kNm/m] (DKQ) | links: _unbehandelte_ Ergebnisse | rechts: _geglättete_ Ergebnisse\n",
        ":::\n",
        "\n",
        "\n",
        "::: {#fig-Querkräfte-DKQ  layout-ncol=\"2\"}\n",
        "\n",
        "![](00-pics/Beispiel-01-BT-qx.png){width=80%}\n",
        "\n",
        "![](00-pics/Beispiel-01-BT-qx-glatt.png){width=80%}\n",
        "\n",
        "![](00-pics/Beispiel-01-BT-qy.png){width=80%}\n",
        "\n",
        "![](00-pics/Beispiel-01-BT-qy-glatt.png){width=80%}\n",
        "\n",
        "quadratische Platte: Querkräfte $q_x$ und $q_y$ [kN/m] (DKQ) | links: _unbehandelte_ Ergebnisse | rechts: _geglättete_ Ergebnisse\n",
        ":::\n",
        "\n",
        "{{< pagebreak >}}\n",
        "### Berechnungsergebnisse: RFEM\n",
        "\n",
        "::: {#fig-Biegemomente-RFEM  layout-ncol=1}\n",
        "```{=typst}\n",
        "#grid(\n",
        "  columns: (440pt),\n",
        "  rows: (180pt, 180pt,180pt),\n",
        "  gutter: 3pt,\n",
        "  grid.cell(image(\"00-pics/bsp01-RFEM-Moment-mx.PNG\", width: 100%)),\n",
        "  grid.cell(image(\"00-pics/bsp01-RFEM-Moment-my.PNG\", width: 100%)),\n",
        "  grid.cell(image(\"00-pics/bsp01-RFEM-Moment-mxy.PNG\", width: 100%)),\n",
        ")\n",
        "```\n",
        "quadratische Platte: Biegemomente $m_x$, $m_y$ und $m_{xy}$ [kNm/m] (_RFEM_) \n",
        ":::\n",
        "\n",
        "::: {#fig-Querkräfte-RFEM  layout-ncol=1}\n",
        "\n",
        "![](00-pics/bsp01-RFEM-Querkraft-vx.PNG){width=90%}\n",
        "\n",
        "![](00-pics/bsp01-RFEM-Querkraft-vy.PNG){width=90%}\n",
        "\n",
        "quadratische Platte: Querkräfte $q_x$ und $q_y$ [kN/m] (_RFEM_) \n",
        ":::\n",
        "\n",
        "\n",
        "### Vergleich der Berechnungsergebnisse\n",
        "\n",
        "Aufgrund der Symmetrie der Platte, der identischen Lagerung aller Ränder und der gleichmäßigen Belastung durch eine Gleichflächenlast, sind die Momentenverläufe und die Querkraftverläufe in $x$- und in $y$-Richtungen deckungsgleich.\n",
        "Der rein optischen Vergleich der Schnittgrößen, zeigt, zwischen den Berechnungsergebnisse der beiden Elementansätze sowie den Ergebnissen von _RFEM_, nahezu kongruente Verläufe. Neben den maximalen Verformungen stimmen auch die Zahlenwerte der Momente, aufgelistet in @tbl-Vergleich-Ergebnisse, mit einer maximalen Abweichung von $1.040 \\%$ überein. \n",
        "\n",
        "\n",
        "|            | $w_{max}$    | $m_{x,max} = m_{y,max}$ | $m_{x,erm} = m_{y,erm}$ | $q_{y,erm} = q_{y,erm}$ |\n",
        "|:-----------|:----------------|:------------------------|:------------------------|:------------------------|\n",
        "| Czerny     | $0.001255$ m | $5633.80$ kNm/m         | $-16494.85$ kNm/m       | $\\pm 17857.14$ kN/m     |\n",
        "| BFS        | $0.001255$ m | $5658.78$ kNm/m         | $-16359.92$ kNm/m       | $\\pm 16080.00$ kN/m     |\n",
        "| DKQ        | $0.001262$ m | $5692.38$ kNm/m         | $-16388.71$ kNm/m       | $\\pm 15867.62$ kN/m     |\n",
        "| RFEM       | $0.0013$   m | $5671.00$ kNm/m         | $-16483.00$ kNm/m       | $\\pm 17552.00$ kN/m     |\n",
        "\n",
        ": Vergleich der Ergebnisse zum Beispiel \"allseitig eingespannte Platte\" {#tbl-Vergleich-Ergebnisse}\n",
        "\n",
        "Bei der Anwendung kommerzieller Finite-Elemente Software ist die Ausgabe der Berechnungsergebnisse immer _geglättet_. Eine nähere Betrachtung der ungeglätteten Querkraftverläufe des BFS-Ansatzes in @fig-BFS-qx-bsplhaft zeigt an den Elementkanten große Versprünge. Dieser Diskretisierungsfehler resultiert aus den höheren Ableitungen der Basisfunktionen, welche für die Berechnung der Querkräfte wesentlich sind.\n",
        "\n",
        "![Querkraftverlauf $q_{x}$ [kN/m] (BFS)](00-pics/Beispiel-01-BFS-qx.png){#fig-BFS-qx-bsplhaft width=80%}\n",
        "\n",
        "Zur Verbesserung der Berechnung aus @fig-BFS-qx-bsplhaft wurde der Querkraftverlauf zwischen speziellen Punkten des Elements bilinear interpoliert. Die Punkte wurden entsprechend den Punkten der Gauss-Integration gewählt. Um einen fließenden Übergang zwischen den Elementen zu erzeugen, werden die Werte zudem an den gemeinsamen Knoten gemittelt. In @fig-interpolation ist der Vorgang der Interpolation und in @fig-glaettung ist die Mittlung an den Knoten schematisch dargestellt. Die Betrachtung ungeglätteter Ergebnisse ist dennoch bei jeder Berechnung zu empfehlen.\n",
        "\n",
        "![Interpolation der Ergebnisse](00-pics/Interpolation.png){#fig-interpolation width=80%}\n",
        "\n",
        "![Glättung der Ergebnisse](00-pics/Glaettung.png){#fig-glaettung width=80%}\n",
        "\n",
        "\n",
        "{{< pagebreak >}}\n",
        "## Beispiel 2: komplexe Platte {#sec-beispiel-02}\n",
        "\n",
        "Als zweites Beispiel wurde die Formulierung des Finite Elemente Ansatzes für allgemeine Vierecke auf ein realitätsnahes Beispiel angewandt. Die Geometrie der Platte erfordert die Anwendung des DKQ-Elementansatzes. Das Finite Elemente Netz ist, für das in JULIA entwickelte Programm in @fig-BSP-02-RFEM-Netz dargestellt. Neben der komplexen Geometrie wurden bei dem Beispiel verschiedene Lagerungstypen verwendet. An den drei grün markierten Punkten wird die Platte durch eine Stütze gelenkig gelagert. Die pinken Linien stellen gelenkige Linienlager dar. \n",
        "\n",
        "![FE-Netz der RFEM Berechnung](00-pics/Beispiel-02-BT-complex-mesh.png){#fig-BSP-02-RFEM-Netz width=80%}\n",
        "\n",
        "Die Eingabeparameter sind in @tbl-Eingabedaten-komplex aufgelistet. Das gewählte Elastizitätsmodul entspricht der Betongüte C25/30.\n",
        "Das Eigengewicht der Platte, welches aus der Dicke von $0.2 \\text{ m}$ resultiert, wurde nicht berücksichtigt. Ersatzweise wird die Berechnung mit einer Gleichflächenlast von $p = 5.00 \\text{ kN}$ durchgeführt.\n",
        "\n",
        "|Eingabeparameter   |                           |\n",
        "|:------------------|:--------------------------|\n",
        "|Plattendicke       | $d = 0.2 \\text{ m}$        |\n",
        "|Elastizitätsmodul  | $E = 31.000 \\text{ N/mm}^2$|\n",
        "|Flächenlast        | $p = 5.00 \\text{ kN}$         |\n",
        "|                   | $\\nu = 0.0$               |\n",
        "\n",
        ": Daten zum Beispiel \"komplexe Platte\" {#tbl-Eingabedaten-komplex}\n",
        "\n",
        "Zur besseren Vergleichbarkeit der Ergebnisse sind nachfolgend die Schnittgrößenverläufe $m_x$, $m_y$ und $m_xy$, jeweils aus der eigenen Berechnung und aus _RFEM_, untereinander dargestellt. \n",
        "Die maximale Verformung beträgt $0.0213$ m nach der _RFEM_-Berechnung und $0.0217$ m nach der eigenen Berechnung. Sowohl der Verformungsverlauf, als auch die Schnittgrößenverläufe sind kongruent.\n",
        "\n",
        "__Verformungsverlauf__\n",
        "\n",
        "![komplexe Platte: Verformung $w$ (DKQ)](00-pics/Beispiel-02-BT-complex-w.png){#fig-komplex-w width=80%} \n",
        "\n",
        "![komplexe Platte: Verformung $w$ (_RFEM_)](00-pics/bsp02-RFEM-Verformung-u.png){#fig-02-RFEM-w width=80%}\n",
        "\n",
        "{{< pagebreak >}}\n",
        "__Berechnungsergebnisse: DKQ__\n",
        "\n",
        "::: {#fig-Biegemomente-02-DKQ}\n",
        "```{=typst}\n",
        "#grid(\n",
        "  columns: (440pt),\n",
        "  rows: (180pt, 180pt,180pt),\n",
        "  gutter: 3pt,\n",
        "  grid.cell(image(\"00-pics/Beispiel-02-BT-complex-mx.png\", height: 100%)),\n",
        "  grid.cell(image(\"00-pics/Beispiel-02-BT-complex-my.png\", height: 100%)),\n",
        "  grid.cell(image(\"00-pics/Beispiel-02-BT-complex-mxy.png\", height: 100%)),\n",
        ")\n",
        "```\n",
        "komplexe Platte: Biegemomente $m_x$, $m_y$ und $m_{xy}$ [kNm/m] (DKQ)\n",
        ":::\n",
        "\n",
        "{{< pagebreak >}}\n",
        "__Berechnungsergebnisse: RFEM__\n",
        "\n",
        "::: {#fig-Biegemomente-02-RFEM}\n",
        "```{=typst}\n",
        "#grid(\n",
        "  columns: (440pt),\n",
        "  rows: (180pt, 180pt,180pt),\n",
        "  gutter: 3pt,\n",
        "  grid.cell(image(\"00-pics/bsp02-RFEM-Moment-mx.png\", width: 100%)),\n",
        "  grid.cell(image(\"00-pics/bsp02-RFEM-Moment-my.png\", width: 100%)),\n",
        "  grid.cell(image(\"00-pics/bsp02-RFEM-Moment-mxy.png\", width: 100%)),\n",
        ")\n",
        "```\n",
        "komplexe Platte: Biegemomente $m_x$, $m_y$ und $m_{xy}$ [kNm/m] (_RFEM_)\n",
        ":::\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "{{< pagebreak >}}\n",
        "\n",
        "\n",
        "<!-- Kapitel 7 -->\n",
        "\n",
        "```{=typst}\n",
        "#set page(header: align(right, emph(text(size: 12pt)[Kapitel 7: Zusammenfassung und Ausblick])))\n",
        "```\n",
        "\n",
        "# Zusammenfassung und Ausblick {#sec-zusammenfassung-ausblick}\n",
        "\n",
        "Im Rahmen dieser Arbeit wurden ausgewählte Elementansätze der Finite Elemente Methode erläutert und in der Programmierumgebung JULIA implementiert. Die Umsetzung eine Formulierung für das sogenannte DKQ Element, angelehnt an das 1982 veröffentlichte Paper von Batoz und Tahar, hat hierbei den Kern der Arbeit dargestellt. \n",
        "\n",
        "Das _Discrete Kirchhoff Quadrilateral_ Element ist laut Benutzerhandbüchern in einigen Softwarelösungen implementiert, jedoch ist dies in der Literatur nur spärlich dokumentiert. Essentiell für die Formulierung des DKQ-Elementansatzes sind die in @sec-Steifigkeitsmatrix-DKQ hergeleiteten $H$-Funktionen. Die globale Steifigkeitsmatrix wird dann über die Summe der Elementsteifigkeitsmatrizen\n",
        "\n",
        "$$ \n",
        "\\begin{align}\n",
        "\\mathbf{k_{ij}^e} = a(\\varphi^e_j, \\varphi^e_i)\n",
        "&= \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{B}_e^T \\mathbf{D_b} \\mathbf{B}_e det[J] \\quad d\\xi \\eta\n",
        "\\end{align}\n",
        "$$ \n",
        "\n",
        "assembliert. \n",
        "\n",
        "![Konvergenz Bespiel \"allseitig eingespannte Platte\"](00-pics/Konvergenzplot_quadratischePlatte.png){#fig-Konvergenz-DKQ width=70%} \n",
        "\n",
        "Mithilfe des implementierten Programmcodes wurde die Formulierung für den DKQ-Elementansatz für unterschiedliche Beispiele angewandt. Die Ergebnisse des Patch-Tests und der Kreisplatte bestätigen die Richtigkeit der Formulierung. Die Plausibilität des 1. und des 2. Beispiels wurde durch Vergleichsrechnung mit der Software _RFEM_ und durch Tabellenwerte geprüft. Die Genauigkeit der Berechnung der allseitig eingespannten quadratischen Platte steigt mit zunehmender Anzahl von Systemfreiheitsgraden wie @fig-Konvergenz-DKQ zeigt.\n",
        "\n",
        "Der Konvergenzplot lässt vermuten, dass ein feineres Netz immer zu genaueren Ergebnissen führt. Bei dem Berechnungsbeispiel der komplexen Platten wird jedoch sichtbar, dass vor allem Punktlager, Knicke in Wänden und Wandenden kritische Punkte für die Berechnung sind. An den genannten Stellen konzentrieren sich Querkräfte und Momente. Diese sogenannten Singularitäten verstärken sich durch zu feine Netze. \n",
        "\n",
        "Ich hoffe mit dieser Arbeit, durch die Implementierung der Berechnungsalgorithmen in der Programmiersprache JULIA und der Aufarbeitung der grundlegenden Ideen der FEM einen Beitrag zur Entwicklung computergestützter Berechnung geleistet zu haben und interessierten Studierenden die Möglichkeit für eine tiefer gehende Anwendung zu bieten.\n"
      ],
      "id": "2f3e73dd"
    }
  ],
  "metadata": {
    "kernelspec": {
      "name": "julia-1.10",
      "language": "julia",
      "display_name": "Julia 1.10.0",
      "path": "/Users/annapaganetty/Library/Jupyter/kernels/julia-1.10"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 5
}