## Assemblierung der globalen Steifigkeitsmatrix

Zur Herleitung der Systemgleichung für das gesamte System, aufgeteilt in mehrere Plattenelemente, wird zunächst die Bilinearform für jedes einzelne Element ausgewertet, wodurch sich die jeweiligen Elementsteifigkeitsmatrizen ergeben. Durch die Assemblierung der Elementsteifigkeitsmatrizen lässt sich die globale Steifigkeitmatrix ableiten.

Entsprechend der Vorgehensweise bei dem Einführungsbeispiel (@sec-einfuehrungsbeispiel) wird das Abstrakte Variationsproblem @eq-abstraktes-variationsproblem  zunächst auf den endlich großen Vektorraum $V_h$, welcher ein Unterraum von $V$ ist, reduziert. $V_h$ bezeichnet die Menge aller möglichen Linearkombinationen von $\varphi_1, \varphi_2,...,\varphi_N$ wobei $\varphi_i \text{mit} i = 1...N$ die Basisfunktionen sind und $N$ die Dimension des Raums $V_h$. Bei der schubstarren Platte nach Kirchhoff wird die Verformung durch $w$, $\theta_x$ und $\theta_y$ beschrieben. Die Näherungslösungen von $w_h$, $\theta_{xh}$ und $\theta_{yh}$ werden durch 
$$
\begin{align}
&w_h(x,y) = \varphi_1(x,y) \cdot \hat{w}_1 +  \varphi_2(x,y) \cdot \hat{w}_2 + ... + \varphi_N(x,y) \cdot \hat{w}_N = \sum_{i=1}^N \varphi_i(x,y) \cdot \hat{w}_i \\
\\
&\theta_{xh}(x,y) = \frac{\partial w_h(x,y)}{\partial y}
= \frac{\partial \sum_{i=1}^N \varphi_i(x,y) \cdot \hat{w}_i }{\partial x} \\
\\
&\theta_{yh}(x,y) =  \frac{\partial w_h(x,y)}{\partial x}
= \frac{\partial \sum_{i=1}^N \varphi_i(x,y) \cdot \hat{w}_i}{\partial y}
\end{align}
$${#eq-linearkombination-platte}

mit 
$$
\begin{align}
&V_h = Lin(\varphi_1,\varphi_2,...,\varphi_N) = \{ \sum_{i=1}^N \varphi_i \cdot \hat{w}_i \vert \hat{w}_i \in \mathbb{R} \}, \\
&V_h \subset V
\end{align}
$${#eq-subspace}

ausgedrückt. Das sich daraus ergebende Problem wird _abstracktes, diskretes Variationsproblem_ bezeichnet.

::: {.block fill="luma(230)" inset="8pt" radius="4pt"}

*Abstraktes, diskretes Variationsproblem* 
\
\
Gesucht ist eine Funktion $w_h \in V_h$, sodass 
$$
a(w_h, \delta w_h)= b(\delta w_h) \quad \forall \quad \delta w_h \in V_h
$${#eq-abstraktes-diskretes-variationsproblem}

:::

Zur numerischen Lösung des abstrakten, diskreten Variationsproblems, wird dieses zunächst als Skalarprodukt von Momentenvektor

$$
\mathbf{m} = 
\left[ \begin{array}{center} 
m_{xx} \\
m_{yy} \\
m_{xy}
\end{array}\right]
\qquad \qquad \text{und Krümmungsvektor} \qquad \qquad
\mathbf{\kappa} =
\left[ \begin{array}{center} 
\kappa_{xx} \\
\kappa_{yy} \\
2\kappa_{xy}
\end{array}\right]
$$

ausgedrückt. Es ergibt sich
$$ 
a(w, \delta w) 
= \int_{\Omega} \mathbf{m} \cdot \mathbf{\kappa} d \Omega 
= \int_{\Omega} (m_{xx} \kappa_{xx} + 2 m_{xy} \kappa_{xy} + m_{yy} \kappa_{yy} ) d \Omega. 
$$ {#eq-bilinearform-Skalarprodukt-m-kappa}

Der Krümmungsvektor kann gemäß @eq-kruemmung durch die zweiten Ableitungen der Verschiebung $w_h$ bzw. durch die ersten Ableitungen der Verdrehungen $\theta_{xh}$ und $\theta_{yh}$ ausgedrückt werden. Bezogen auf ein Element ergibt sich, durch die Linearkombination für $w_h$ (@eq-linearkombination-platte) und den Knotenverschiebungsvektor $u^e$ (@eq-knotenverschiebungsvekor), die Formulierung des Krümmungsvektors für das Element $i$  

$$
\begin{align}
\mathbf{\kappa_i} = 
% \left[ \begin{array}{center} 
% \frac{\partial \sum N_i^e \theta_{xi}}{\partial x} \\
% \frac{\partial \sum N_i^e \theta_{yi}}{\partial y} \\
% \frac{\partial \sum N_i^e \theta_{xi}}{\partial y} 
% + \frac{\partial \sum N_i^e \theta_{yi}}{\partial x} \\
% \end{array}\right] 
% = 
\mathbf{B_b} \boldsymbol{\hat{w}^e}
\end{align}
$$ {#eq-kruemmungsvekor-mit-B-Matrix}

mit der B-Matrix
$$
\mathbf{B_b} = 
\begin{bmatrix} 
0 & \frac{\partial \varphi_1}{\partial x} & 0 & 
0 & \frac{\partial \varphi_2}{\partial x} & 0 &
0 & \frac{\partial \varphi_3}{\partial x} & 0 & ... &
0 & \frac{\partial \varphi_{n_n}}{\partial x} & 0 \\
0 & 0 & \frac{\partial \varphi_1}{\partial y} &
0 & 0 & \frac{\partial \varphi_2}{\partial y} &
0 & 0 & \frac{\partial \varphi_3}{\partial y} & ... &
0 & 0 & \frac{\partial \varphi_{n_n}}{\partial y}\\
0 & \frac{\partial \varphi_1}{\partial x} & \frac{\partial \varphi_1}{\partial y} & 
0 & \frac{\partial \varphi_2}{\partial x} & \frac{\partial \varphi_2}{\partial y} &
0 & \frac{\partial \varphi_3}{\partial x} & \frac{\partial \varphi_3}{\partial y} & ... &
0 & \frac{\partial \varphi_{n_n}}{\partial x} & \frac{\partial \varphi_{n_n}}{\partial y} \\
\end{bmatrix}.
$$

wobei $n_n$ die Anzahl der Elementknoten und folglich auch die Anzahl der Formfunktionen angibt.
Der Momentenvektor kann dementsprechend durch 

$$
\mathbf{m_i} = 
\mathbf{D_b}
\mathbf{\kappa_i}
% \left[ \begin{array}{center} 
% \kappa_{xx} \\
% \kappa_{yy} \\
% \kappa_{xy}
% \end{array}\right]
=
\mathbf{D_b} \mathbf{B_b} \boldsymbol{\hat{w}^e}
$$ {#eq-momentenvekor-mit-B-Matrix}

mit
$$
\mathbf{D_b} = D \begin{bmatrix} 1 & \nu & 0 \\ \nu & 1 & 0 \\ 0 & 0 & \frac{1-\nu}{2} \end{bmatrix}
$$

beschrieben werden, wobei D die isotrope Plattensteifigkeit darstellt (@eq-plattensteifigkeit).
Mit den Formulierungen aus @eq-kruemmungsvekor-mit-B-Matrix und @eq-momentenvekor-mit-B-Matrix, eingesetzt in @eq-bilinearform-Skalarprodukt-m-kappa, ergibt sich die elementweise Formulierung der Bilinearform zu 
$$ 
\begin{align}
a(w^e, \delta w^e) 
% &=  \int_{\Omega} \mathbf{m} \cdot \mathbf{\kappa} \quad d \Omega \\
% &=  \int_{\Omega} \mathbf{m}^T \mathbf{\kappa} \quad d \Omega \\
% &=  \int_{\Omega} (\mathbf{D_b}\mathbf{\kappa})^T \mathbf{\kappa} \quad d \Omega \\
% &=  \int_{\Omega} \mathbf{\kappa}^T \mathbf{D_b} \mathbf{\kappa} \quad d \Omega \\
% &=  \int_{\Omega}  (\mathbf{B_b} \underline{u^e})^T \mathbf{D_b}  (\mathbf{B_b} \underline{u^e})  \quad d \Omega \\
&=  \int_{\Omega}  \mathbf{B_b}^T \mathbf{D_b} \mathbf{B_b} \boldsymbol{\hat{w}^e} \quad d \Omega \\
\end{align}
$$

Diese Formulierung wird in der Literatur im Regelfall durch die Elementsteifigkeitsmarix

$$ 
\mathbf{k_{ij}^e} = a(\varphi^e_j, \varphi^e_i)
= \int_{\Omega^e} \mathbf{B}_e^T \mathbf{D_b} \mathbf{B}_e d\Omega
$$ {#eq-elementsteifigkeitsmatrix}

und den Knotenverschiebungsvektor eines Elements 

$$
\mathbf{\hat{w}^e}= \left[ \begin{array}{center} 
w_1 & \theta_{x1} & \theta_{y1} &
w_2 & \theta_{x2} & \theta_{y2} &
w_3 & \theta_{x3} & \theta_{y3} &
... &
w_{n_n} & \theta_{xn_n} & \theta_{yn_n} 
\end{array}\right]^T
$${#eq-knotenverschiebungsvekor}

ausgedrückt. Für das Gesamtsystem ergibt sich das lineare Gleichungssystem

$$
\mathbf{K} \mathbf{\hat{w}} = \boldsymbol{r}.
$${#eq-lin-gleichungssystem}

mit
$$
\begin{align}
&\mathbf{K} &&= K_{ij} &&= a(\varphi_j, \varphi_i) \\
&\boldsymbol{r} &&= r_i    &&= b(\varphi_i) \quad \text{mit} \quad i,j = 1,...,N,
\end{align}
$$

$\mathbf{K}$ bezeichnet die Gesamtsteifigkeitsmatrix, $\boldsymbol{r}$ den Lastvektor und $\boldsymbol{\hat{w}}$ den unbekannten, zu approixmierenden Verschiebungsvektor. Die entsprechenden Bezeichnungen für ein Element sind $\mathbf{k^e_{ij}}$ für die Elementsteifigkeitsmatrix, $\boldsymbol{r^e}$ für den Elementlastvektor und $\boldsymbol{\hat{w}^e}$ für den Knotenverschiebungsvektor (siehe @tbl-Variablen).

|                     | Gesamtsystem         | Element|
|:--------------------|:--------------------:|:-----------:|
| Bilinearform (Variationsproblem) | $a(w, \delta w)$ | $a(w^e, \delta w^e)$ | 
| Steifigkeitsmatrix  | $\mathbf{K}$         |$\mathbf{k_{ij}^e}$|
| Bilinearform (Steifigkeitsmatrix) | $a(\varphi_j, \varphi_i)$ | $a(\varphi^e_j, \varphi^e_i)$|
| Lastvektor          | $\mathbf{r}$         |$\mathbf{r^e}$|
| Verschiebungsvektor | $\mathbf{\hat{w}}$   |$\mathbf{\hat{w}^e}$|

: Variablen des linearen Gleichungssystem für das Gesamtsystem und elementweise. {#tbl-Variablen}

### Anwendung an dem konformen Hermite Element

Für ein klassisches Plattenelement mit einer Differentialgleichung  dritter Ordnung bildet das Bogner-Fox-Schmit (BFS) Element, beschrieben in @sec-FE-BFS, mit dessen Formfunktionen, dargestellt in @fig-Bogner-Fox-Schmitt-Formfunktionen, einen geeigneten Ansatz. Durch den zusätzlichen Freiheitsgrad $\theta_{xy}$ wird der Ansatz nur selten in der Praxis genutzt, da er nur für reine Rechteckelemente Verwendung findet. Das BFS-Element besitzt in jedem Knoten vier Freiheitsgrade (fig), wodurch sich der Knotenverschiebungsvektor zu 

$$
\mathbf{\hat{w}^e}= \left[ \begin{array}{center} 
w_1 & \theta_{x1} & \theta_{y1} & \theta_{xy1} &
w_2 & \theta_{x2} & \theta_{y2} & \theta_{xy2} &
w_3 & \theta_{x3} & \theta_{y3} & \theta_{xy3} &
w_4 & \theta_{x4} & \theta_{y4} & \theta_{xy4}
\end{array}\right]^T
$${#eq-knotenverschiebungsvekor-BFS}

ergibt. Abweichend 

als geeignete Linearkombination der vier Monome 1, ξ, ξ2, ξ3 eine nodale Basis (siehe Abbildung 4.2).




###


































<!-- 
$$
\sum_{j=1}^N a(\varphi_j, \varphi_i) \cdot \hat{w}_j  = b(\varphi_i), \quad \text{mit} \quad i,j = 1,...,N,
$${#eq-weißnochnicht02}
 -->

<!-- 
## Bilinearform und Elementsteifigkeitsmatrix in der Literatur

$$
u(x,y) = \sum_i^n N^e d^e
$$

$$
N^e = 
\begin{bmatrix} 
N_1^e & 0 & N_2^e & 0 & N_3^e & 0 & ... & N_n^e & 0 \\ 
0 & N_1^e & 0 & N_2^e & 0 & N_3^e & ... & 0 & N_n^e \\ 
\end{bmatrix}
$$

$$
d^e = 
\begin{bmatrix} 
u_{x1}^e & u_{y1}^e & u_{x2}^e & u_{y2}^e & u_{x3}^e & u_{y3}^e & ... & u_{xn}^e & u_{yn}^e &
\end{bmatrix}
$$

_Bilinearform_

Hartmann
$$
\begin{align}
a(w, \delta w) &= \int_{\Omega} D \cdot (\frac{\partial^2 w}{\partial x^2} \cdot \frac{\partial^2 \delta w}{\partial x^2} + 2 \cdot \frac{\partial w}{\partial x \partial y} \cdot \frac{\partial \delta w}{\partial x \partial y} + \frac{\partial^2 w}{\partial y^2} \cdot \frac{\partial^2 \delta w}{\partial y^2} )\quad d \Omega
\end{align}
$$ {#eq-variationsproblem}

Werkle 

$$
\begin{align}
\delta W_i &= \int_{\Omega} D \cdot (-m_{xx} \cdot \frac{\partial^2 \delta w}{\partial x^2} -2 \cdot m_{yy} \cdot \frac{\partial \delta w}{\partial x \partial y} -m_{yy} \cdot \frac{\partial^2 \delta w}{\partial y^2}) \quad d \Omega
\end{align}
$$ {#eq-variationsproblem}

_Steifigkeitsmatrix_

Hartmann
$$ 
k_{ij}^e
= \int_{\Omega^e} \mathbf{\kappa}_i^T \mathbf{D_b} \mathbf{\kappa}_j d\Omega
$$

Fish & Belytschko
$$ 
k_{ij}^e
= \int_{\Omega^e} \mathbf{B}_e^T \mathbf{D_b} \mathbf{B}_e d\Omega
$$

Werkle 
$$ 
K_e
= \int_{\Omega^e} \mathbf{B}_b^T \mathbf{D_b} \mathbf{B}_b dx dy
$$


$$
\mathbf{D_b} = D \begin{bmatrix} 1 & \nu & 0 \\ \nu & 1 & 0 \\ 0 & 0 & \frac{1-\nu}{2} \end{bmatrix}
\qquad\text{und} \qquad
\mathbf{B_b}= 
\begin{bmatrix} 
0 & \frac{\partial N_1}{\partial x} & 0 & 
0 & \frac{\partial N_2}{\partial x} & 0 &
0 & \frac{\partial N_3}{\partial x} & 0 &
0 & \frac{\partial N_4}{\partial x} & 0 \\
0 & 0 & \frac{\partial N_1}{\partial y} &
0 & 0 & \frac{\partial N_2}{\partial y} &
0 & 0 & \frac{\partial N_3}{\partial y} & 
0 & 0 & \frac{\partial N_4}{\partial y}\\
0 & \frac{\partial N_1}{\partial x} & \frac{\partial N_1}{\partial y} & 
0 & \frac{\partial N_2}{\partial x} & \frac{\partial N_2}{\partial y} &
0 & \frac{\partial N_3}{\partial x} & \frac{\partial N_3}{\partial y} &
0 & \frac{\partial N_4}{\partial x} & \frac{\partial N_4}{\partial y} \\
\end{bmatrix}
$$

---------------------

Unterschied zwischen Literatur und meinem Ergebnis der Bilinearform 

$$ 
\begin{align}
a(w, \delta w) 
&= \int_{\Omega} ((D \kappa_{xx} + D\nu \kappa_{yy}) \delta\kappa_{xx} 
                + 2 (D(1-\nu) \kappa_{xy}) \delta\kappa_{xy} 
                + (D\nu \kappa_{xx} + D \kappa_{yy}) \delta\kappa_{yy} ) d \Omega \\
&= \int_{\Omega} (D \kappa_{xx} \delta\kappa_{xx} + D\nu \kappa_{yy} \delta\kappa_{xx} 
                + 2 D(1-\nu) \kappa_{xy} \delta\kappa_{xy} 
                + (D\nu \kappa_{xx} \delta\kappa_{yy} + D \kappa_{yy} \delta\kappa_{yy}) ) d \Omega \\
&= D \int_{\Omega} \kappa_{xx} \delta\kappa_{xx} + \nu \kappa_{yy} \delta\kappa_{xx} 
                + 2 (1-\nu) \kappa_{xy} \delta\kappa_{xy} 
                + \nu \kappa_{xx} \delta\kappa_{yy} + \kappa_{yy} \delta\kappa_{yy} d \Omega \\
&= D \int_{\Omega} w_{,xx} \delta w_{,xx} + \nu w_{,yy} \delta w_{,xx} 
                + 2 w_{,xy} \delta w_{,xy} - 2 \nu w_{,xy} \delta w_{,xy} 
                + \nu w_{,xx} \delta w_{,yy} + w_{,yy} \delta w_{,yy} d \Omega \\
&= D \int_{\Omega} w_{,xx} \delta w_{,xx} 
                + 2 w_{,xy} \delta w_{,xy} 
                + w_{,yy\} \delta w_{,yy} d \Omega 
                + \int_{\Omega} \nu (w_{,yy} \delta w_{,xx}  - 2 w_{,xy} \delta w_{,xy} + w_{,xx} \delta w_{,yy}) d \Omega \\
&= D (1+\nu) \int_{\Omega} w_{,xx} \delta w_{,xx} 
                + 2 w_{,xy} \delta w_{,xy} 
                + w_{,yy} \delta w_{,yy} d \Omega 
\end{align}
$$  

-->
