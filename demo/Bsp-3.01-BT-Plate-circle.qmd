```{julia}
include("../src/setup.jl")
```

## Plot der Plattenelemente
```{julia}
using MMJMesh.Gmsh

mCirc = Mesh(
        """
        SetFactory("OpenCASCADE");
        Point(1) = {0, 0, 0};
        Disk(1) = {0, 0, 0, $(p1.r), $(p1.r)};
        Point{1} In Surface{1};
        Recombine Surface {1};
        MeshSize{:} = 0.25;
        MeshSize{:} = 1.25;
        Mesh 2;
        """
)
fig = plotmesh(mCirc; title="runde Platte | d = 8m | 165 unregelmäßige Elemente")
# save("Beispiel-01-BTunr-mesh.png",fig)
```

# Vergleichswerte aus Altenbach et. al

```{julia}
K = p1.E*p1.h^3 / 12*(1-p1.ν^2)
w_altenbach = (p1.q * p1.r^4) / (64*K)
v_altenbach = (p1.q * p1.r) / 2
```


# Berechnung des Verschiebung

```{julia}
w = plate(mCirc, p1, "BTP")
# maximale Verschiebung in vertikaler Richtung
w_fe = maximum(w[1:3:end])
```

# prozentuale Abweichung Verschiebung
```{julia}
100 * abs(w_fe - w_altenbach) / w_altenbach
```

_Abweichung = 0.711 %_

## Plot Verformung

```{julia}
GLMakie.activate!()
wBTPunr = plotwBTP(mCirc, w;title="Verformung")
# save("Beispiel-01-BTunr-w.png",wBTPunr)
```

## Plot ungeglättete Querkräfte

```{julia}
set_theme!(theme_minimal())
update_theme!(
    colormap=(:redblue,1.0),
    color=3,
    faceplotzscale=1,
    faceplotnpoints=15,
    edgesvisible=false,
    featureedgelinewidth=2.5,
)   
```

Querkräfte

```{julia}
figBTqx= plotrBTP(mCirc, :qx, "Querkraft qx", (-25.5, 25.5),nodal = false, a3d=true)
figBTqy= plotrBTP(mCirc, :qy, "Querkraft qy", (-25.5, 25.5),nodal = false, a3d=true)
```

## Plot geglättete Querkräfte

Querkräfte

```{julia}
figBTqxGlatt= plotrBTP(mCirc, :qx, "Querkraft qx", (-25.5, 25.5),nodal = true, a3d=true)
figBTqyGlatt=plotrBTP(mCirc, :qy, "Querkraft qy", (-25.5, 25.5),nodal = true, a3d=true)
```


## Speichern der Plots
```{julia}
using CairoMakie
# save("Beispiel-01-BTcirc-qx.png",figBTqx)
# save("Beispiel-01-BTcirc-qy.png",figBTqy)

# save("Beispiel-01-BTcirc-qx-glatt.png",figBTqxGlatt)
# save("Beispiel-01-BTcirc-qy-glatt.png",figBTqyGlatt)
```